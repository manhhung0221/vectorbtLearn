<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/documentation/data/local/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation on handling local data in VectorBT PRO"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/documentation/data/local/ rel=canonical><link href=../index.html rel=prev><link href=../remote/index.html rel=next><link rel=icon href=../../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>Local - VectorBT® PRO</title><link rel=stylesheet href=../../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=Local><meta property=og:type content=website><meta content=https://vectorbt.pro/documentation/data/local/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Documentation on handling local data in VectorBT PRO"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#local class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-header__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBT® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Local </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-nav__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBT® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/fundamentals/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 7a2 2 0 0 0-2 2v8h2v-4h2v4h2V9a2 2 0 0 0-2-2zm0 2h2v2H3m12-.5V9a2 2 0 0 0-2-2H9v10h4a2 2 0 0 0 2-2v-1.5a1.54 1.54 0 0 0-1.5-1.5 1.54 1.54 0 0 0 1.5-1.5M13 15h-2v-2h2zm0-4h-2V9h2m6-2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-1h-2v1h-2V9h2v1h2V9a2 2 0 0 0-2-2Z"/></svg> <span class=md-ellipsis> Fundamentals </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/building-blocks/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 4.15 6.04 7.5 12 10.85l5.96-3.35zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-6.7l-6 3.37v6.71z"/></svg> <span class=md-ellipsis> Building blocks </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4 checked> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"/></svg> <span class=md-ellipsis> Data </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h7a2 2 0 0 1 2 2H4v10l2.14-8h17.07l-2.28 8.5c-.23.87-1.01 1.5-1.93 1.5"/></svg> <span class=md-ellipsis> Local </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/local/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h7a2 2 0 0 1 2 2H4v10l2.14-8h17.07l-2.28 8.5c-.23.87-1.01 1.5-1.93 1.5"/></svg> <span class=md-ellipsis> Local </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pickling class=md-nav__link> <span class=md-ellipsis> Pickling </span> </a> </li> <li class=md-nav__item> <a href=#saving class=md-nav__link> <span class=md-ellipsis> Saving </span> </a> <nav class=md-nav aria-label=Saving> <ul class=md-nav__list> <li class=md-nav__item> <a href=#csv class=md-nav__link> <span class=md-ellipsis> CSV </span> </a> </li> <li class=md-nav__item> <a href=#hdf class=md-nav__link> <span class=md-ellipsis> HDF </span> </a> </li> <li class=md-nav__item> <a href=#feather-parquet class=md-nav__link> <span class=md-ellipsis> Feather &amp; Parquet </span> </a> </li> <li class=md-nav__item> <a href=#sql class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=#duckdb class=md-nav__link> <span class=md-ellipsis> DuckDB </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#loading class=md-nav__link> <span class=md-ellipsis> Loading </span> </a> <nav class=md-nav aria-label=Loading> <ul class=md-nav__list> <li class=md-nav__item> <a href=#csv_1 class=md-nav__link> <span class=md-ellipsis> CSV </span> </a> <nav class=md-nav aria-label=CSV> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chunking class=md-nav__link> <span class=md-ellipsis> Chunking </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hdf_1 class=md-nav__link> <span class=md-ellipsis> HDF </span> </a> <nav class=md-nav aria-label=HDF> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chunking_1 class=md-nav__link> <span class=md-ellipsis> Chunking </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#feather-parquet_1 class=md-nav__link> <span class=md-ellipsis> Feather &amp; Parquet </span> </a> </li> <li class=md-nav__item> <a href=#sql_1 class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> <nav class=md-nav aria-label=SQL> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chunking_2 class=md-nav__link> <span class=md-ellipsis> Chunking </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#duckdb_1 class=md-nav__link> <span class=md-ellipsis> DuckDB </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#updating class=md-nav__link> <span class=md-ellipsis> Updating </span> </a> <nav class=md-nav aria-label=Updating> <ul class=md-nav__list> <li class=md-nav__item> <a href=#csv-hdf class=md-nav__link> <span class=md-ellipsis> CSV &amp; HDF </span> </a> </li> <li class=md-nav__item> <a href=#feather-parquet_2 class=md-nav__link> <span class=md-ellipsis> Feather &amp; Parquet </span> </a> </li> <li class=md-nav__item> <a href=#sql_2 class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=#duckdb_2 class=md-nav__link> <span class=md-ellipsis> DuckDB </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/remote/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg> <span class=md-ellipsis> Remote </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/synthetic/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 1-1.26 2.75L15 5l2.74 1.26L19 9l1.25-2.74L23 5l-2.75-1.25M9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5M19 15l-1.26 2.74L15 19l2.74 1.25L19 23l1.25-2.75L23 19l-2.75-1.26"/></svg> <span class=md-ellipsis> Synthetic </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/scheduling/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a7 7 0 0 1-7-7 7 7 0 0 1 7-7 7 7 0 0 1 7 7 7 7 0 0 1-7 7m7.03-12.61 1.42-1.42c-.45-.51-.9-.97-1.41-1.41L17.62 6c-1.55-1.26-3.5-2-5.62-2a9 9 0 0 0-9 9 9 9 0 0 0 9 9c5 0 9-4.03 9-9 0-2.12-.74-4.07-1.97-5.61M11 14h2V8h-2m4-7H9v2h6z"/></svg> <span class=md-ellipsis> Scheduling </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/ class=md-nav__link> <span class=md-ellipsis> Indicators </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/portfolio/ class=md-nav__link> <span class=md-ellipsis> Portfolio </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/to-be-continued/ class=md-nav__link> <span class=md-ellipsis> To be continued... </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-path__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/ class=md-path__link> <span class=md-ellipsis> Data </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=local><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h7a2 2 0 0 1 2 2H4v10l2.14-8h17.07l-2.28 8.5c-.23.87-1.01 1.5-1.93 1.5"/></svg></span> Local<a class=headerlink href=#local title="Permanent link">&para;</a></h1> <p>Making repeated requests to remote API endpoints can be costly, so caching data locally is important. Fortunately, VBT provides several methods for managing local data.</p> <h2 id=pickling>Pickling<a class=headerlink href=#pickling title="Permanent link">&para;</a></h2> <p>Like any class that subclasses <a href=https://vectorbt.pro/pvt_41531c19/api/utils/pickling/#vectorbtpro.utils.pickling.Pickleable>Pickleable</a>, you can save any <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data>Data</a> instance to disk using <a href=https://vectorbt.pro/pvt_41531c19/api/utils/pickling/#vectorbtpro.utils.pickling.Pickleable.save>Pickleable.save</a>, and load it again with <a href=https://vectorbt.pro/pvt_41531c19/api/utils/pickling/#vectorbtpro.utils.pickling.Pickleable.load>Pickleable.load</a>. This process pickles the entire Python object, including stored Pandas objects, symbol dictionaries, and settings:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>,</span> 
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-05&quot;</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span> <span class=o>=</span> <span class=n>yf_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-06&quot;</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=go>Date                                              </span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=go>2020-01-05 00:00:00+00:00  7411.317383  136.276779</span>
</span></code></pre></div> <ol> <li>The <code>.pickle</code> extension is added to the file name automatically.</li> <li>You can load the object back in a new runtime or even on another machine. Just make sure you are using a compatible VBT version.</li> </ol> <div class="admonition important"> <p class=admonition-title>Important</p> <p>The class definition is not saved. If a new version of VBT introduces a breaking change to the <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data>Data</a> constructor, the object might not load. In this case, you can manually create a new instance:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=p>(</span><span class=o>**</span><span class=n>vbt</span><span class=o>.</span><span class=n>Configured</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>config</span><span class=p>)</span>
</span></code></pre></div> </div> <h2 id=saving>Saving<a class=headerlink href=#saving title="Permanent link">&para;</a></h2> <p>While pickling is a fast and convenient way to store Python objects of any size, the pickled file is essentially a black box that requires a Python interpreter to access its contents. This means it cannot be imported by most other data-driven tools, which makes it unusable for many tasks. To overcome this limitation, the <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data>Data</a> class allows you to save only the stored Pandas objects into one or more tabular format files.</p> <h3 id=csv>CSV<a class=headerlink href=#csv title="Permanent link">&para;</a></h3> <p>The first supported file format is <a href=https://en.wikipedia.org/wiki/Comma-separated_values>CSV</a>, which is implemented by the instance method <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_csv>Data.to_csv</a>. This method takes the path to the directory where the data should be stored (<code>path_or_buf</code>) and saves each symbol in a separate file using <a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html>DataFrame.to_csv</a>.</p> <p>By default, it appends the <code>.csv</code> extension to each symbol and saves the files in the current directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>()</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Multiple symbols cannot be stored in a single CSV file.</p> </div> <p>You can list all CSV files in the current directory using <a href=https://vectorbt.pro/pvt_41531c19/api/utils/path_/#vectorbtpro.utils.path_.list_files>list_files</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=s2>&quot;*.csv&quot;</span><span class=p>)</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=go>[PosixPath(&#39;ETH-USD.csv&#39;), PosixPath(&#39;BTC-USD.csv&#39;)]</span>
</span></code></pre></div> <p>A cleaner approach is to save all the data in a separate directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_file</span><span class=p>(</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_file</span><span class=p>(</span><span class=s2>&quot;ETH-USD.csv&quot;</span><span class=p>)</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=n>mkdir_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mkdir</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>  <span class=c1># (2)!</span>
</span></code></pre></div> <ol> <li>Delete the previously created CSV files from the current directory.</li> <li>Save the files to the directory named <code>data</code>. If the directory does not exist, create a new one by passing the keyword argument <code>mkdir_kwargs</code> to <a href=https://vectorbt.pro/pvt_41531c19/api/utils/path_/#vectorbtpro.utils.path_.check_mkdir>check_mkdir</a>.</li> </ol> <p>To save the data as tab-separated values (TSV):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=n>ext</span><span class=o>=</span><span class=s2>&quot;tsv&quot;</span><span class=p>)</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=s2>&quot;data/*.tsv&quot;</span><span class=p>)</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=go>[PosixPath(&#39;data/BTC-USD.tsv&#39;), PosixPath(&#39;data/ETH-USD.tsv&#39;)]</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You do not need to pass <code>sep</code>: VBT will recognize the extension and use the correct delimiter. You can still override this argument if you want to split the data by a custom character.</p> </div> <p>Similar to <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.pull>Data.pull</a>, you can provide any argument as a feature/symbol dictionary of type <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.key_dict>key_dict</a> to define different rules for different symbols. For example, you can store the symbols from our example in separate directories:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;btc_data&quot;</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;eth_data&quot;</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=gp>... </span>    <span class=n>mkdir_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mkdir</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can also specify the path to each file by using <code>path_or_buf</code> (the first argument):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;data/btc_usd.csv&quot;</span><span class=p>,</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;data/eth_usd.csv&quot;</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=gp>... </span>    <span class=n>mkdir_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mkdir</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>To delete an entire directory, for example as part of a cleanup process:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_dir</span><span class=p>(</span><span class=s2>&quot;btc_data&quot;</span><span class=p>,</span> <span class=n>with_contents</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_dir</span><span class=p>(</span><span class=s2>&quot;eth_data&quot;</span><span class=p>,</span> <span class=n>with_contents</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_dir</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=n>with_contents</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div> <h3 id=hdf>HDF<a class=headerlink href=#hdf title="Permanent link">&para;</a></h3> <p>The second supported file format is <a href=https://en.wikipedia.org/wiki/Hierarchical_Data_Format>HDF</a>, which is implemented by the instance method <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_hdf>Data.to_hdf</a>. Unlike <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_csv>Data.to_csv</a>, this method can store multiple symbols in a single file, where symbols are distributed as HDF keys.</p> <p>By default, it creates a new file with the same name as the data class and the <code>.h5</code> extension, saving each symbol under a separate key using <a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_hdf.html>DataFrame.to_hdf</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>()</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=s2>&quot;*.h5&quot;</span><span class=p>)</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=go>[PosixPath(&#39;YFData.h5&#39;)]</span>
</span></code></pre></div> <p>To see the list of all groups and keys in an HDF file:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>pd</span><span class=o>.</span><span class=n>HDFStore</span><span class=p>(</span><span class=s2>&quot;YFData.h5&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>store</span><span class=p>:</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=gp>... </span>    <span class=nb>print</span><span class=p>(</span><span class=n>store</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=go>[&#39;/BTC-USD&#39;, &#39;/ETH-USD&#39;]</span>
</span></code></pre></div> <p>Use the <code>key</code> argument to manually specify the key for a particular symbol:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=gp>... </span>    <span class=n>key</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;btc_usd&quot;</span><span class=p>,</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;eth_usd&quot;</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If there is only one symbol, you do not need to use <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.key_dict>key_dict</a>. You can simply pass <code>key="btc_usd"</code>.</p> </div> <p>You can also specify the path to each file by using <code>path_or_buf</code> (the first argument):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;btc_usd.h5&quot;</span><span class=p>,</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;eth_usd.h5&quot;</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can combine the arguments <code>path_or_buf</code> and <code>key</code>.</p> <p>All other arguments behave the same as for <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_csv>Data.to_csv</a>.</p> <h3 id=feather-parquet>Feather &amp; Parquet<a class=headerlink href=#feather-parquet title="Permanent link">&para;</a></h3> <p>The third supported option is saving to a Feather or Parquet file, which are handled by the instance methods <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_feather>Data.to_feather</a> and <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_parquet>Data.to_parquet</a>. Feather is an unmodified raw columnar Arrow memory format designed for short-term storage. Parquet is often more expensive to write but offers more layers of encoding and compression, making Parquet files usually much smaller than Feather files. Another key difference is that you cannot partition data with Feather, nor can you natively store the index. The index must be stored as a separate column, which is handled automatically by VBT. Here we will show how to save to Parquet.</p> <p>By default, the <code>.parquet</code> extension is appended to each symbol, and files are saved in the current directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>()</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Multiple symbols cannot be stored in a single Parquet file.</p> </div> <p>Other saving options are very similar to the CSV saving options.</p> <p>In addition to saving each DataFrame to a separate Parquet file, you can partition the DataFrame either by columns or by rows. Partitioning by columns is controlled by the <code>partition_cols</code> argument, which takes a list of column names. The columns must be present in your data and are partitioned in the order you provide. Partitioning by rows is controlled by the <code>partition_by</code> argument, which accepts a grouping instruction such as a frequency, an index (including multi-index), a Pandas grouper or resampler, or a VBT <a href=https://vectorbt.pro/pvt_41531c19/api/base/grouping/base/#vectorbtpro.base.grouping.base.Grouper>Grouper</a> instance. Together with <code>groupby_kwargs</code>, this creates a new <code>Grouper</code> instance for partitioning. The groups are attached as columns to each DataFrame, and the names of these columns are provided as <code>partition_cols</code>. By default, if there is only one column, it will be named "group"; if there are multiple columns, they will be named "group_{index}". To use your own column names, enable <code>keep_groupby_names</code>.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>When <code>partition_cols</code> or <code>partition_by</code> is provided, each symbol will be stored in a separate directory.</p> </div> <p>Let's partition our data into two-day groups and save each DataFrame to its own Parquet directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=n>partition_by</span><span class=o>=</span><span class=s2>&quot;2 days&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>To visualize the directory tree for the <code>BTC-USD</code> symbol:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>print_dir_tree</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=go>BTC-USD</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=go>├── group=2020-01-01%2000%3A00%3A00.000000000</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=go>│   └── 190335d948d04504b42a8d35ffb08f47-0.parquet</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=go>└── group=2020-01-03%2000%3A00%3A00.000000000</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=go>    └── 190335d948d04504b42a8d35ffb08f47-0.parquet</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=go>2 directories, 2 files</span>
</span></code></pre></div> <h3 id=sql>SQL<a class=headerlink href=#sql title="Permanent link">&para;</a></h3> <p>The fourth supported option is saving to a SQL database, which is implemented by the instance method <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_sql>Data.to_sql</a>. This requires <a href=https://www.sqlalchemy.org/ >SQLAlchemy</a> to be installed. The method takes the engine (object, name, or URL) and saves each symbol as a separate table in the database managed by the engine using <a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_sql.html><code>pd.to_sql</code></a>. You can create the engine manually using SQLAlchemy's <code>create_engine</code> function, or pass a URL and it will be created for you; in this case, the engine will be disposed at the end of the call.</p> <p>Let's create a SQL database file in the working directory and store the data there:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>SQLITE_URL</span> <span class=o>=</span> <span class=s2>&quot;sqlite:///yf_data.db&quot;</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>SQLITE_URL</span><span class=p>)</span>
</span></code></pre></div> <p>If you want to continue working with the same engine and avoid creating another engine object, pass <code>return_engine=True</code> to return the engine object:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>engine</span> <span class=o>=</span> <span class=n>yf_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>SQLITE_URL</span><span class=p>,</span> <span class=n>if_exists</span><span class=o>=</span><span class=s2>&quot;replace&quot;</span><span class=p>,</span> <span class=n>return_engine</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div> <p>You can also specify the schema using the <code>schema</code> argument. Note that some databases, such as SQLite, do not support the concept of a schema. If the schema does not exist, it will be created automatically.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>POSTGRESQL_URL</span> <span class=o>=</span> <span class=s2>&quot;postgresql://postgres:postgres@localhost:5432&quot;</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>POSTGRESQL_URL</span><span class=p>,</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>Use the <code>table</code> argument to manually specify the table name for a particular symbol:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=gp>... </span>    <span class=n>POSTGRESQL_URL</span><span class=p>,</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=gp>... </span>    <span class=n>table</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;BTC_USD&quot;</span><span class=p>,</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;ETH_USD&quot;</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>If the index is datetime-like and/or there are datetime-like columns, the method will localize or convert them to UTC first. To adjust this behavior, set the <code>to_utc</code> argument to False to deactivate, to "index" to apply it to the index only, or to "columns" to apply it to columns only. Additionally, the UTC timezone will be removed if <code>remove_utc_tz</code> is True (default) since some databases do not support timezone-aware timestamps; other timezones are not affected.</p> </div> <h3 id=duckdb>DuckDB<a class=headerlink href=#duckdb title="Permanent link">&para;</a></h3> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>The previous method (using SQLAlchemy) can also be used to write to a DuckDB database. For this, you need to install the <a href=https://pypi.org/project/duckdb-engine/ >duckdb-engine</a> extension.</p> </div> <p>The fifth supported option is very similar to the previous one and allows you to save data to a DuckDB database or to CSV, Parquet, or JSON files. It is implemented by the instance method <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_duckdb>Data.to_duckdb</a>. This requires <a href=https://duckdb.org/ >DuckDB</a> to be installed. The method takes the connection (object or URL) and saves each symbol as a separate table in the database managed by the connection, or to file(s) using a SQL query. The connection can be created manually using DuckDB's <code>connect</code> function, or you can pass a URL and it will be created for you. If neither a connection nor connection-related keyword arguments are provided, the default in-memory connection is used.</p> <p>Let's create a DuckDB database file in the working directory and store the data there:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>DUCKDB_URL</span> <span class=o>=</span> <span class=s2>&quot;database.duckdb&quot;</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_duckdb</span><span class=p>(</span><span class=n>DUCKDB_URL</span><span class=p>)</span>
</span></code></pre></div> <p>You can also specify the catalog and schema using the <code>catalog</code> and <code>schema</code> arguments, respectively. If the schema does not exist, it will be created automatically.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_duckdb</span><span class=p>(</span><span class=n>DUCKDB_URL</span><span class=p>,</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>Use the <code>table</code> argument to manually specify the table name for a particular symbol:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_duckdb</span><span class=p>(</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=gp>... </span>    <span class=n>DUCKDB_URL</span><span class=p>,</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=gp>... </span>    <span class=n>table</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;BTC_USD&quot;</span><span class=p>,</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;ETH_USD&quot;</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>There is also an option to save each DataFrame to a CSV, Parquet, or JSON file rather than to the database itself. To do this, use <code>write_format</code>, <code>write_path</code>, and <code>write_options</code>. This operation is performed using <a href=https://duckdb.org/docs/sql/statements/copy.html><code>COPY TO</code></a>. If <code>write_path</code> is a directory (which is the working directory by default), each DataFrame will be saved to a file based on the specified format. The format is not needed if <code>write_path</code> points to a file with a recognizable extension. The options argument can be used to specify writing options; it can be either a string as in DuckDB's documentation, such as <code>HEADER 1, DELIMITER ','</code>, or a dictionary that will be translated into such a string by VBT, such as <code>dict(header=1, delimiter=',')</code>.</p> <p>Let's save all data to Parquet files:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_duckdb</span><span class=p>(</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=gp>... </span>    <span class=n>DUCKDB_URL</span><span class=p>,</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=gp>... </span>    <span class=n>write_path</span><span class=o>=</span><span class=s2>&quot;data&quot;</span><span class=p>,</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=gp>... </span>    <span class=n>write_format</span><span class=o>=</span><span class=s2>&quot;parquet&quot;</span><span class=p>,</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=gp>... </span>    <span class=n>mkdir_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mkdir</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>See the notes in the SQL section.</p> </div> <h2 id=loading>Loading<a class=headerlink href=#loading title="Permanent link">&para;</a></h2> <p>To import any previously stored data in a tabular format, you can use Pandas or VBT's preset data classes, which are specifically designed for this purpose.</p> <h3 id=csv_1>CSV<a class=headerlink href=#csv_1 title="Permanent link">&para;</a></h3> <p>You can import each CSV dataset manually using <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>pandas.read_csv</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>()</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>,</span> <span class=n>index_col</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>parse_dates</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=go>                                  Open         High          Low        Close  \</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=go>Date                                                                            </span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=go>2020-01-01 00:00:00+00:00  7194.892090  7254.330566  7174.944336  7200.174316   </span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=go>2020-01-02 00:00:00+00:00  7202.551270  7212.155273  6935.270020  6985.470215   </span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=go>2020-01-03 00:00:00+00:00  6984.428711  7413.715332  6914.996094  7344.884277   </span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=go>2020-01-04 00:00:00+00:00  7345.375488  7427.385742  7309.514160  7410.656738   </span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=go>                                Volume  Dividends  Stock Splits  </span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=go>Date                                                             </span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=go>2020-01-01 00:00:00+00:00  18565664997        0.0           0.0  </span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=go>2020-01-02 00:00:00+00:00  20802083465        0.0           0.0  </span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=go>2020-01-03 00:00:00+00:00  28111481032        0.0           0.0  </span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=go>2020-01-04 00:00:00+00:00  18444271275        0.0           0.0 </span>
</span></code></pre></div> <p>To combine the imported datasets and wrap them with <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data>Data</a>, you can use <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.from_data>Data.from_data</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_usd</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>,</span> <span class=n>index_col</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>parse_dates</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>eth_usd</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;ETH-USD.csv&quot;</span><span class=p>,</span> <span class=n>index_col</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>parse_dates</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Data</span><span class=o>.</span><span class=n>from_data</span><span class=p>({</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=n>btc_usd</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=n>eth_usd</span><span class=p>})</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=go>Date                                              </span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p>To make it easier for users and eliminate the need to manually search for, fetch, and merge CSV data, VBT provides the <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData>CSVData</a> class, which can recursively search directories for CSV files, resolve path expressions using <a href=https://docs.python.org/3/library/glob.html>glob</a>, translate matched paths into symbols, and import and join tabular data—all automatically with a single command. It is a subclass of <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData>FileData</a>, which enables all of these features.</p> <p>At the core of the path matching functionality is the class method <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.pull>FileData.pull</a>, which iterates over the specified paths. For each one, it finds the matching absolute paths using the class method <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.match_path>FileData.match_path</a>, then calls the abstract class method <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.fetch_key>FileData.fetch_key</a> to pull the data from the file at that path.</p> <p>To see how <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.match_path>FileData.match_path</a> works, create a directory named <code>data</code> and store several empty files in it:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_dir</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/file1.csv&quot;</span><span class=p>)</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/file2.tsv&quot;</span><span class=p>)</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/file3&quot;</span><span class=p>)</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_dir</span><span class=p>(</span><span class=s2>&quot;data/sub-data&quot;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/sub-data/file1.csv&quot;</span><span class=p>)</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/sub-data/file2.tsv&quot;</span><span class=p>)</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>make_file</span><span class=p>(</span><span class=s2>&quot;data/sub-data/file3&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>To view the directory structure you just created:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>print_dir_tree</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>)</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=go>data</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=go>├── file1.csv</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=go>├── file2.tsv</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=go>├── file3</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=go>└── sub-data</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=go>    ├── file1.csv</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=go>    ├── file2.tsv</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=go>    └── file3</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=go>1 directories, 6 files</span>
</span></code></pre></div> <p>Match all files in a directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>FileData</span><span class=o>.</span><span class=n>match_path</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>)</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=go>[PosixPath(&quot;data/file1.csv&quot;),</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=go> PosixPath(&quot;data/file2.tsv&quot;),</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=go> PosixPath(&quot;data/file3&quot;)]</span>
</span></code></pre></div> <p>Match all CSV files in a directory:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>FileData</span><span class=o>.</span><span class=n>match_path</span><span class=p>(</span><span class=s2>&quot;data/*.csv&quot;</span><span class=p>)</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=go>[PosixPath(&quot;data/file1.csv&quot;)]</span>
</span></code></pre></div> <p>Match all CSV files in a directory recursively:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>FileData</span><span class=o>.</span><span class=n>match_path</span><span class=p>(</span><span class=s2>&quot;data/**/*.csv&quot;</span><span class=p>)</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=go>[PosixPath(&quot;data/file1.csv&quot;), PosixPath(&quot;data/sub-data/file1.csv&quot;)]</span>
</span></code></pre></div> <p>For more details, see the <a href=https://docs.python.org/3/library/glob.html>glob</a> documentation.</p> <p>Returning to <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.pull>FileData.pull</a>: this method can match one or multiple path expressions as shown above, provided either as <code>symbols</code> (if <code>paths</code> is None) or as <code>paths</code>. When you pass paths as symbols, the method calls <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.path_to_symbol>FileData.path_to_symbol</a> on each matched path to extract the symbol name (by default, this is the stem of the path):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=go>[&quot;BTC-USD&quot;]</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD.csv&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=go>[&quot;BTC-USD&quot;, &quot;ETH-USD&quot;]</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;*.csv&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=go>[&quot;BTC-USD&quot;, &quot;ETH-USD&quot;]</span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC/USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH/USD&quot;</span><span class=p>],</span> <span class=n>paths</span><span class=o>=</span><span class=s2>&quot;*.csv&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (1)!</span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=go>[&quot;BTC/USD&quot;, &quot;ETH/USD&quot;]</span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>  <span class=c1># (2)!</span>
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC/USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH/USD&quot;</span><span class=p>],</span> 
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=gp>... </span>    <span class=n>paths</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD.csv&quot;</span><span class=p>]</span>
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a><span class=go>[&quot;BTC/USD&quot;, &quot;ETH/USD&quot;]</span>
</span></code></pre></div> <ol> <li>Explicitly specify the symbols.</li> <li>Explicitly specify both the symbols and the paths.</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Remember to filter by the <code>.csv</code>, <code>.tsv</code>, or any other extension in your path expression.</p> </div> <p>When you use a wildcard like <code>*.csv</code>, VBT will sort the matched paths (for each path expression). To disable sorting, set <code>sort_paths</code> to False. If you want to turn off the path matching mechanism entirely, you can set <code>match_paths</code> to False, which will send all arguments directly to <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData.fetch_key>CSVData.fetch_key</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC/USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH/USD&quot;</span><span class=p>],</span> 
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=gp>... </span>    <span class=n>paths</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC/USD&quot;</span><span class=p>:</span> <span class=s2>&quot;BTC-USD.csv&quot;</span><span class=p>,</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=gp>... </span>        <span class=s2>&quot;ETH/USD&quot;</span><span class=p>:</span> <span class=s2>&quot;ETH-USD.csv&quot;</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=gp>... </span>    <span class=n>match_paths</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=go>[&quot;BTC/USD&quot;, &quot;ETH/USD&quot;]</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Instead of paths, you can use any object type supported by the <code>filepath_or_buffer</code> argument in <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>pandas.read_csv</a>.</p> </div> <p>To summarize the techniques described above, let's create an empty directory called <code>data</code> again, write the <code>BTC-USD</code> symbol to a CSV file and the <code>ETH-USD</code> symbol to a TSV file, then load both datasets with a single <code>fetch</code> call:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_dir</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=n>with_contents</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=gp>... </span>    <span class=s2>&quot;data&quot;</span><span class=p>,</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=gp>... </span>    <span class=n>ext</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;csv&quot;</span><span class=p>,</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;tsv&quot;</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=gp>... </span>    <span class=p>}),</span> 
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=gp>... </span>    <span class=n>mkdir_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>mkdir</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>csv_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;data/*.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;data/*.tsv&quot;</span><span class=p>])</span>  <span class=c1># (1)!</span>
</span></code></pre></div> <ol> <li>The delimiter is automatically detected based on the file's extension.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>csv_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=go>Date                                              </span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Providing two paths with wildcards (<code>*</code>) does not guarantee you will get exactly two symbols: each wildcard may match more than one path. Think of the two expressions above as being OR'ed into a single expression <code>data/*.{csv,tsv}</code> (which, unfortunately, is not supported by <a href=https://docs.python.org/3/library/glob.html>glob</a>).</p> </div> <p>Last but not least is regex matching with <code>match_regex</code>. This tells VBT to iterate over all matched paths and further validate them using a regular expression:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=gp>... </span>    <span class=s2>&quot;data/**/*&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=gp>... </span>    <span class=n>match_regex</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;^.*\.(csv|tsv)$&quot;</span>  <span class=c1># (2)!</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=go>Date                                              </span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <ol> <li>Recursively collect the paths of all files in any subdirectory of <code>data</code>.</li> <li>Filter out any paths that do not end with <code>.csv</code> or <code>.tsv</code>.</li> </ol> <p>Any other argument is passed directly to <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData.fetch_key>CSVData.fetch_key</a> and then to <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>pandas.read_csv</a>.</p> <h4 id=chunking>Chunking<a class=headerlink href=#chunking title="Permanent link">&para;</a></h4> <p>Instead of reading everything into memory at once, Pandas allows you to read data in chunks. For CSV files, this means you can load only a subset of lines into memory at any given time. While this is a great feature for working with large datasets, chunking does not have many benefits when your goal is simply to load all the data into memory anyway.</p> <p>However, chunking becomes very useful for data filtering! The class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData>CSVData</a>, as well as the function <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>pandas.read_csv</a> that it uses, do not have arguments for skipping rows based on their content—only by row index. For example, to skip any data before <code>2020-01-03</code>, you would need to load all the data into memory first. But if the dataset is too large, this could exhaust your system's RAM. To work around this, you can split the data into chunks and check conditions on each chunk separately.</p> <p>You have two options:</p> <ol> <li>Use <code>chunksize</code> to divide data into chunks of fixed length.</li> <li>Use <code>iterator</code> to return an iterator so you can read chunks of variable length.</li> </ol> <p>Both options make <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>pandas.read_csv</a> to return an iterator of type <code>TextFileReader</code>. To take advantage of this, <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData.fetch_key>CSVData.fetch_key</a> accepts a user-defined function <code>chunk_func</code> that should 1) accept the iterator, 2) select, process, and concatenate chunks, and 3) return a Series or DataFrame.</p> <p>Let's fetch only the rows whose date ends with an even day:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>csv_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>CSVData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;data/*.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;data/*.tsv&quot;</span><span class=p>],</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=gp>... </span>    <span class=n>chunksize</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=gp>... </span>    <span class=n>chunk_func</span><span class=o>=</span><span class=k>lambda</span> <span class=n>iterator</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=gp>... </span>        <span class=n>df</span> 
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=gp>... </span>        <span class=k>for</span> <span class=n>df</span> <span class=ow>in</span> <span class=n>iterator</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=gp>... </span>        <span class=k>if</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>day</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=gp>... </span>    <span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <ol> <li>Each chunk will be a DataFrame with one row.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>csv_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=go>Date                                              </span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Chunking is most useful when memory usage is a greater concern than speed.</p> </div> <h3 id=hdf_1>HDF<a class=headerlink href=#hdf_1 title="Permanent link">&para;</a></h3> <p>Each HDF dataset can be imported manually using <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_hdf.html>pandas.read_hdf</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>()</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_hdf</span><span class=p>(</span><span class=s2>&quot;YFData.h5&quot;</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=go>                                  Open         High          Low        Close  \</span>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=go>Date                                                                            </span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=go>2020-01-01 00:00:00+00:00  7194.892090  7254.330566  7174.944336  7200.174316   </span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=go>2020-01-02 00:00:00+00:00  7202.551270  7212.155273  6935.270020  6985.470215   </span>
</span><span id=__span-39-8><a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a><span class=go>2020-01-03 00:00:00+00:00  6984.428711  7413.715332  6914.996094  7344.884277   </span>
</span><span id=__span-39-9><a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=go>2020-01-04 00:00:00+00:00  7345.375488  7427.385742  7309.514160  7410.656738   </span>
</span><span id=__span-39-10><a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a>
</span><span id=__span-39-11><a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a><span class=go>                                Volume  Dividends  Stock Splits  </span>
</span><span id=__span-39-12><a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a><span class=go>Date                                                             </span>
</span><span id=__span-39-13><a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a><span class=go>2020-01-01 00:00:00+00:00  18565664997        0.0           0.0  </span>
</span><span id=__span-39-14><a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a><span class=go>2020-01-02 00:00:00+00:00  20802083465        0.0           0.0  </span>
</span><span id=__span-39-15><a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a><span class=go>2020-01-03 00:00:00+00:00  28111481032        0.0           0.0  </span>
</span><span id=__span-39-16><a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a><span class=go>2020-01-04 00:00:00+00:00  18444271275        0.0           0.0  </span>
</span></code></pre></div> <p>Just like <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData>CSVData</a> for CSV data, VBT provides a preset class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData>HDFData</a> specifically for reading HDF files. It shares the same parent class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData>FileData</a> and uses its fetcher <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.pull>FileData.pull</a>. Unlike CSV datasets, where each file stores one dataset, HDF datasets are stored by key within a single HDF file. Since groups and keys in HDF files follow a <a href=https://en.wikipedia.org/wiki/POSIX>POSIX</a>-style hierarchy with <code>/</code> separators, you can query them just like you would query directories and files in a typical file system.</p> <p>Let's demonstrate this by using <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData.match_path>HDFData.match_path</a>, which extends <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.match_path>FileData.match_path</a> with proper discovery and handling of HDF groups and keys:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>match_path</span><span class=p>(</span><span class=s2>&quot;YFData.h5&quot;</span><span class=p>)</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=go>[PosixPath(&quot;YFData.h5/BTC-USD&quot;), PosixPath(&quot;YFData.h5/ETH-USD&quot;)]</span>
</span></code></pre></div> <p>As you can see, the HDF file is now treated as a directory, while groups and keys are treated as subdirectories and files, respectively. This makes importing HDF datasets just as easy as importing CSV datasets:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;YFData.h5/BTC-USD&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (1)!</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=go>[&quot;BTC-USD&quot;]</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a>
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;YFData.h5&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (2)!</span>
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=go>[&quot;BTC-USD&quot;, &quot;ETH-USD&quot;]</span>
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;YFData.h5/BTC*&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (3)!</span>
</span><span id=__span-41-8><a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=go>[&quot;BTC-USD&quot;]</span>
</span><span id=__span-41-9><a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>
</span><span id=__span-41-10><a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;*.h5/BTC-*&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (4)!</span>
</span><span id=__span-41-11><a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=go>[&quot;BTC-USD&quot;]</span>
</span></code></pre></div> <ol> <li>Matches the key <code>BTC-USD</code> in <code>YFData.h5</code>.</li> <li>Matches all keys in <code>YFData.h5</code>.</li> <li>Matches all keys starting with <code>BTC</code> in <code>YFData.h5</code>.</li> <li>Matches all keys starting with <code>BTC</code> in all HDF files.</li> </ol> <p>Any other argument works the same as for <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData>CSVData</a>, but now is passed directly to <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData.fetch_key>HDFData.fetch_key</a> and then to <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_hdf.html>pandas.read_hdf</a>.</p> <h4 id=chunking_1>Chunking<a class=headerlink href=#chunking_1 title="Permanent link">&para;</a></h4> <p>Chunking for HDF files works just like it does for CSV files, with two exceptions: the data must be saved as a <a href=https://www.pytables.org/ >PyTables</a> Table structure by using <code>format="table"</code>, and the iterator will be of type <code>TableIterator</code> instead of <code>TextFileReader</code>.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span><span class=nb>format</span><span class=o>=</span><span class=s2>&quot;table&quot;</span><span class=p>)</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=gp>... </span>    <span class=s2>&quot;YFData.h5&quot;</span><span class=p>,</span>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=gp>... </span>    <span class=n>chunksize</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=gp>... </span>    <span class=n>chunk_func</span><span class=o>=</span><span class=k>lambda</span> <span class=n>iterator</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=gp>... </span>        <span class=n>df</span> 
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=gp>... </span>        <span class=k>for</span> <span class=n>df</span> <span class=ow>in</span> <span class=n>iterator</span>
</span><span id=__span-42-9><a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a><span class=gp>... </span>        <span class=k>if</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>day</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span><span id=__span-42-10><a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a><span class=gp>... </span>    <span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-42-11><a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=go>Date                                              </span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <h3 id=feather-parquet_1>Feather &amp; Parquet<a class=headerlink href=#feather-parquet_1 title="Permanent link">&para;</a></h3> <p>Each Parquet dataset can be manually imported using <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_parquet.html>pandas.read_parquet</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>()</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>&quot;BTC-USD.parquet&quot;</span><span class=p>)</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=go>                                  Open         High          Low        Close  \</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=go>Date                                                                            </span>
</span><span id=__span-44-6><a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=go>2020-01-01 00:00:00+00:00  7194.892090  7254.330566  7174.944336  7200.174316   </span>
</span><span id=__span-44-7><a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a><span class=go>2020-01-02 00:00:00+00:00  7202.551270  7212.155273  6935.270020  6985.470215   </span>
</span><span id=__span-44-8><a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=go>2020-01-03 00:00:00+00:00  6984.428711  7413.715332  6914.996094  7344.884277   </span>
</span><span id=__span-44-9><a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a><span class=go>2020-01-04 00:00:00+00:00  7345.375488  7427.385742  7309.514160  7410.656738   </span>
</span><span id=__span-44-10><a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a>
</span><span id=__span-44-11><a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=go>                                Volume  Dividends  Stock Splits  </span>
</span><span id=__span-44-12><a id=__codelineno-44-12 name=__codelineno-44-12 href=#__codelineno-44-12></a><span class=go>Date                                                             </span>
</span><span id=__span-44-13><a id=__codelineno-44-13 name=__codelineno-44-13 href=#__codelineno-44-13></a><span class=go>2020-01-01 00:00:00+00:00  18565664997        0.0           0.0  </span>
</span><span id=__span-44-14><a id=__codelineno-44-14 name=__codelineno-44-14 href=#__codelineno-44-14></a><span class=go>2020-01-02 00:00:00+00:00  20802083465        0.0           0.0  </span>
</span><span id=__span-44-15><a id=__codelineno-44-15 name=__codelineno-44-15 href=#__codelineno-44-15></a><span class=go>2020-01-03 00:00:00+00:00  28111481032        0.0           0.0  </span>
</span><span id=__span-44-16><a id=__codelineno-44-16 name=__codelineno-44-16 href=#__codelineno-44-16></a><span class=go>2020-01-04 00:00:00+00:00  18444271275        0.0           0.0  </span>
</span></code></pre></div> <p>The same applies for partitioned datasets:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;XRP-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>,</span> 
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-05&quot;</span>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data2</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=n>partition_by</span><span class=o>=</span><span class=s2>&quot;2D&quot;</span><span class=p>)</span>
</span><span id=__span-45-7><a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a>
</span><span id=__span-45-8><a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-45-9><a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a><span class=go>                                Open       High        Low      Close  \</span>
</span><span id=__span-45-10><a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a><span class=go>Date                                                                    </span>
</span><span id=__span-45-11><a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a><span class=go>2020-01-01 00:00:00+00:00  13.730962  13.873946  13.654942  13.689083   </span>
</span><span id=__span-45-12><a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a><span class=go>2020-01-02 00:00:00+00:00  13.698126  13.715548  12.989974  13.027011   </span>
</span><span id=__span-45-13><a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a><span class=go>2020-01-03 00:00:00+00:00  13.035329  13.763709  13.012638  13.660452   </span>
</span><span id=__span-45-14><a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a><span class=go>2020-01-04 00:00:00+00:00  13.667442  13.921914  13.560008  13.891512   </span>
</span><span id=__span-45-15><a id=__codelineno-45-15 name=__codelineno-45-15 href=#__codelineno-45-15></a>
</span><span id=__span-45-16><a id=__codelineno-45-16 name=__codelineno-45-16 href=#__codelineno-45-16></a><span class=go>                              Volume  Dividends  Stock Splits  \</span>
</span><span id=__span-45-17><a id=__codelineno-45-17 name=__codelineno-45-17 href=#__codelineno-45-17></a><span class=go>Date                                                            </span>
</span><span id=__span-45-18><a id=__codelineno-45-18 name=__codelineno-45-18 href=#__codelineno-45-18></a><span class=go>2020-01-01 00:00:00+00:00  172980718        0.0           0.0   </span>
</span><span id=__span-45-19><a id=__codelineno-45-19 name=__codelineno-45-19 href=#__codelineno-45-19></a><span class=go>2020-01-02 00:00:00+00:00  156376427        0.0           0.0   </span>
</span><span id=__span-45-20><a id=__codelineno-45-20 name=__codelineno-45-20 href=#__codelineno-45-20></a><span class=go>2020-01-03 00:00:00+00:00  173683857        0.0           0.0   </span>
</span><span id=__span-45-21><a id=__codelineno-45-21 name=__codelineno-45-21 href=#__codelineno-45-21></a><span class=go>2020-01-04 00:00:00+00:00  182230374        0.0           0.0   </span>
</span><span id=__span-45-22><a id=__codelineno-45-22 name=__codelineno-45-22 href=#__codelineno-45-22></a>
</span><span id=__span-45-23><a id=__codelineno-45-23 name=__codelineno-45-23 href=#__codelineno-45-23></a><span class=go>                                                   group  </span>
</span><span id=__span-45-24><a id=__codelineno-45-24 name=__codelineno-45-24 href=#__codelineno-45-24></a><span class=go>Date                                                      </span>
</span><span id=__span-45-25><a id=__codelineno-45-25 name=__codelineno-45-25 href=#__codelineno-45-25></a><span class=go>2020-01-01 00:00:00+00:00  2020-01-01 00:00:00.000000000  </span>
</span><span id=__span-45-26><a id=__codelineno-45-26 name=__codelineno-45-26 href=#__codelineno-45-26></a><span class=go>2020-01-02 00:00:00+00:00  2020-01-01 00:00:00.000000000  </span>
</span><span id=__span-45-27><a id=__codelineno-45-27 name=__codelineno-45-27 href=#__codelineno-45-27></a><span class=go>2020-01-03 00:00:00+00:00  2020-01-03 00:00:00.000000000  </span>
</span><span id=__span-45-28><a id=__codelineno-45-28 name=__codelineno-45-28 href=#__codelineno-45-28></a><span class=go>2020-01-04 00:00:00+00:00  2020-01-03 00:00:00.000000000  </span>
</span></code></pre></div> <ol> <li>The path points to a directory.</li> </ol> <p>Just like with other classes for loading data from local files, VBT provides preset classes <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/feather/#vectorbtpro.data.custom.feather.FeatherData>FeatherData</a> and <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/parquet/#vectorbtpro.data.custom.parquet.ParquetData>ParquetData</a> for reading Feather and Parquet files, respectively. They share the same parent class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData>FileData</a> and use its fetcher <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/file/#vectorbtpro.data.custom.file.FileData.pull>FileData.pull</a>.</p> <p>First, let's discover any Parquet files or directories stored in the current working directory using <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/parquet/#vectorbtpro.data.custom.parquet.ParquetData.list_paths>ParquetData.list_paths</a>. This function searches for files with the ".parquet" extension as well as directories containing partitioned datasets that follow the <a href=https://arrow.apache.org/docs/python/generated/pyarrow.dataset.HivePartitioning.html>Hive partitioning scheme</a>.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>list_paths</span><span class=p>()</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=go>[PosixPath(&#39;BNB-USD&#39;),</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=go> PosixPath(&#39;BTC-USD.parquet&#39;),</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=go> PosixPath(&#39;ETH-USD.parquet&#39;),</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=go> PosixPath(&#39;XRP-USD&#39;)]</span>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>is_parquet_file</span><span class=p>(</span><span class=s2>&quot;BTC-USD.parquet&quot;</span><span class=p>)</span>
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=go>True</span>
</span><span id=__span-46-9><a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a>
</span><span id=__span-46-10><a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>is_parquet_dir</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>)</span>
</span><span id=__span-46-11><a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=go>True</span>
</span></code></pre></div> <p>This makes importing Parquet datasets just as easy as importing any other file-based dataset:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD.parquet&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (1)!</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=go>[&#39;BTC-USD&#39;]</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD.parquet&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD.parquet&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;*.parquet&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (2)!</span>
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a>
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (3)!</span>
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=go>[&#39;BNB-USD&#39;]</span>
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a>
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;XRP-USD&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a><span class=go>[&#39;BNB-USD&#39;, &#39;XRP-USD&#39;]</span>
</span><span id=__span-47-15><a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a>
</span><span id=__span-47-16><a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>()</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (4)!</span>
</span><span id=__span-47-17><a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=go>[&#39;BNB-USD&#39;, &#39;BTC-USD&#39;, &#39;ETH-USD&#39;, &#39;XRP-USD&#39;]</span>
</span></code></pre></div> <ol> <li>Pull a single-file dataset.</li> <li>Pull all single-file datasets.</li> <li>Pull a partitioned dataset.</li> <li>Pull all single-file and partitioned datasets.</li> </ol> <p>You might be wondering what happens to the "group" column in partitioned datasets. Whenever a partitioned dataset is pulled and VBT detects one or more partition groups named "group" or "group_{index}", these columns are automatically ignored because they were most likely generated by user-defined row partitioning with <code>partition_by</code>. Such groups are referred to as default groups.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>list_partition_cols</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>)</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=go>[&#39;group&#39;]</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>is_default_partition_col</span><span class=p>(</span><span class=s2>&quot;group&quot;</span><span class=p>)</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a><span class=go>True</span>
</span><span id=__span-48-6><a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a>
</span><span id=__span-48-7><a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>features</span>
</span><span id=__span-48-8><a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a><span class=go>[&#39;Open&#39;, &#39;High&#39;, &#39;Low&#39;, &#39;Close&#39;, &#39;Volume&#39;, &#39;Dividends&#39;, &#39;Stock Splits&#39;]</span>
</span></code></pre></div> <p>You can disable this behavior by setting <code>keep_partition_cols</code> to True:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BNB-USD&quot;</span><span class=p>,</span> <span class=n>keep_partition_cols</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>features</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=go>[&#39;Open&#39;,</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=go> &#39;High&#39;,</span>
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=go> &#39;Low&#39;,</span>
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a><span class=go> &#39;Close&#39;,</span>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a><span class=go> &#39;Volume&#39;,</span>
</span><span id=__span-49-7><a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=go> &#39;Dividends&#39;,</span>
</span><span id=__span-49-8><a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a><span class=go> &#39;Stock Splits&#39;,</span>
</span><span id=__span-49-9><a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a><span class=go> &#39;group&#39;]</span>
</span></code></pre></div> <h3 id=sql_1>SQL<a class=headerlink href=#sql_1 title="Permanent link">&para;</a></h3> <p>Each SQL table can be manually imported using <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_sql_table.html>pandas.read_sql_table</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_sql_table</span><span class=p>(</span>
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=gp>... </span>    <span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> 
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=gp>... </span>    <span class=n>POSTGRESQL_URL</span><span class=p>,</span> 
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=gp>... </span>    <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>,</span>
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a><span class=gp>... </span>    <span class=n>index_col</span><span class=o>=</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span> 
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a><span class=gp>... </span>    <span class=n>parse_dates</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;Date&quot;</span><span class=p>:</span> <span class=nb>dict</span><span class=p>(</span><span class=n>utc</span><span class=o>=</span><span class=kc>True</span><span class=p>)}</span>
</span><span id=__span-50-7><a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-50-8><a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a><span class=go>                                  Open         High          Low        Close  \</span>
</span><span id=__span-50-9><a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a><span class=go>Date                                                                            </span>
</span><span id=__span-50-10><a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a><span class=go>2020-01-01 00:00:00+00:00  7194.892090  7254.330566  7174.944336  7200.174316   </span>
</span><span id=__span-50-11><a id=__codelineno-50-11 name=__codelineno-50-11 href=#__codelineno-50-11></a><span class=go>2020-01-02 00:00:00+00:00  7202.551270  7212.155273  6935.270020  6985.470215   </span>
</span><span id=__span-50-12><a id=__codelineno-50-12 name=__codelineno-50-12 href=#__codelineno-50-12></a><span class=go>2020-01-03 00:00:00+00:00  6984.428711  7413.715332  6914.996094  7344.884277   </span>
</span><span id=__span-50-13><a id=__codelineno-50-13 name=__codelineno-50-13 href=#__codelineno-50-13></a><span class=go>2020-01-04 00:00:00+00:00  7345.375488  7427.385742  7309.514160  7410.656738   </span>
</span><span id=__span-50-14><a id=__codelineno-50-14 name=__codelineno-50-14 href=#__codelineno-50-14></a>
</span><span id=__span-50-15><a id=__codelineno-50-15 name=__codelineno-50-15 href=#__codelineno-50-15></a><span class=go>                                Volume  Dividends  Stock Splits  </span>
</span><span id=__span-50-16><a id=__codelineno-50-16 name=__codelineno-50-16 href=#__codelineno-50-16></a><span class=go>Date                                                             </span>
</span><span id=__span-50-17><a id=__codelineno-50-17 name=__codelineno-50-17 href=#__codelineno-50-17></a><span class=go>2020-01-01 00:00:00+00:00  18565664997        0.0           0.0  </span>
</span><span id=__span-50-18><a id=__codelineno-50-18 name=__codelineno-50-18 href=#__codelineno-50-18></a><span class=go>2020-01-02 00:00:00+00:00  20802083465        0.0           0.0  </span>
</span><span id=__span-50-19><a id=__codelineno-50-19 name=__codelineno-50-19 href=#__codelineno-50-19></a><span class=go>2020-01-03 00:00:00+00:00  28111481032        0.0           0.0  </span>
</span><span id=__span-50-20><a id=__codelineno-50-20 name=__codelineno-50-20 href=#__codelineno-50-20></a><span class=go>2020-01-04 00:00:00+00:00  18444271275        0.0           0.0 </span>
</span></code></pre></div> <p>You can also execute any query using <a href=https://pandas.pydata.org/docs/reference/api/pandas.read_sql_query.html>pandas.read_sql_query</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pd</span><span class=o>.</span><span class=n>read_sql_query</span><span class=p>(</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a><span class=gp>... </span>    <span class=s1>&#39;SELECT * FROM yf_data.&quot;BTC-USD&quot;&#39;</span><span class=p>,</span> 
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a><span class=gp>... </span>    <span class=n>POSTGRESQL_URL</span><span class=p>,</span> 
</span><span id=__span-51-4><a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a><span class=gp>... </span>    <span class=n>index_col</span><span class=o>=</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span> 
</span><span id=__span-51-5><a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a><span class=gp>... </span>    <span class=n>parse_dates</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;Date&quot;</span><span class=p>:</span> <span class=nb>dict</span><span class=p>(</span><span class=n>utc</span><span class=o>=</span><span class=kc>True</span><span class=p>)}</span>
</span><span id=__span-51-6><a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-51-7><a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a><span class=go>                                  Open         High          Low        Close  \</span>
</span><span id=__span-51-8><a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a><span class=go>Date                                                                            </span>
</span><span id=__span-51-9><a id=__codelineno-51-9 name=__codelineno-51-9 href=#__codelineno-51-9></a><span class=go>2020-01-01 00:00:00+00:00  7194.892090  7254.330566  7174.944336  7200.174316   </span>
</span><span id=__span-51-10><a id=__codelineno-51-10 name=__codelineno-51-10 href=#__codelineno-51-10></a><span class=go>2020-01-02 00:00:00+00:00  7202.551270  7212.155273  6935.270020  6985.470215   </span>
</span><span id=__span-51-11><a id=__codelineno-51-11 name=__codelineno-51-11 href=#__codelineno-51-11></a><span class=go>2020-01-03 00:00:00+00:00  6984.428711  7413.715332  6914.996094  7344.884277   </span>
</span><span id=__span-51-12><a id=__codelineno-51-12 name=__codelineno-51-12 href=#__codelineno-51-12></a><span class=go>2020-01-04 00:00:00+00:00  7345.375488  7427.385742  7309.514160  7410.656738   </span>
</span><span id=__span-51-13><a id=__codelineno-51-13 name=__codelineno-51-13 href=#__codelineno-51-13></a>
</span><span id=__span-51-14><a id=__codelineno-51-14 name=__codelineno-51-14 href=#__codelineno-51-14></a><span class=go>                                Volume  Dividends  Stock Splits  </span>
</span><span id=__span-51-15><a id=__codelineno-51-15 name=__codelineno-51-15 href=#__codelineno-51-15></a><span class=go>Date                                                             </span>
</span><span id=__span-51-16><a id=__codelineno-51-16 name=__codelineno-51-16 href=#__codelineno-51-16></a><span class=go>2020-01-01 00:00:00+00:00  18565664997        0.0           0.0  </span>
</span><span id=__span-51-17><a id=__codelineno-51-17 name=__codelineno-51-17 href=#__codelineno-51-17></a><span class=go>2020-01-02 00:00:00+00:00  20802083465        0.0           0.0  </span>
</span><span id=__span-51-18><a id=__codelineno-51-18 name=__codelineno-51-18 href=#__codelineno-51-18></a><span class=go>2020-01-03 00:00:00+00:00  28111481032        0.0           0.0  </span>
</span><span id=__span-51-19><a id=__codelineno-51-19 name=__codelineno-51-19 href=#__codelineno-51-19></a><span class=go>2020-01-04 00:00:00+00:00  18444271275        0.0           0.0 </span>
</span></code></pre></div> <p>But you might be asking: how do we know what schemas and tables are stored in our database? We can call <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.list_schemas>SQLData.list_schemas</a> and <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.list_tables>SQLData.list_tables</a>, respectively. Most methods in <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData>SQLData</a>, including these two, require that the engine be provided.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>list_schemas</span><span class=p>(</span><span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>)</span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a><span class=go>[&#39;information_schema&#39;, &#39;public&#39;, &#39;yf_data&#39;]</span>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>list_tables</span><span class=p>(</span><span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>)</span>
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a><span class=go>[&#39;information_schema:_pg_foreign_data_wrappers&#39;,</span>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a><span class=go> &#39;information_schema:_pg_foreign_servers&#39;,</span>
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a><span class=go> ...</span>
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a><span class=go> &#39;yf_data:BTC-USD&#39;,</span>
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a><span class=go> &#39;yf_data:ETH-USD&#39;]</span>
</span><span id=__span-52-10><a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a>
</span><span id=__span-52-11><a id=__codelineno-52-11 name=__codelineno-52-11 href=#__codelineno-52-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>list_tables</span><span class=p>(</span><span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>,</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>
</span><span id=__span-52-12><a id=__codelineno-52-12 name=__codelineno-52-12 href=#__codelineno-52-12></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <p>To fetch the actual data, you can use <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.fetch_key>SQLData.fetch_key</a>, which calls <code>pd.read_sql_query</code> and performs many pre-processing and post-processing steps under the hood. For example, it can inspect the database and map column indices to names, which is not natively supported by the Pandas method. This is useful when specifying information per column based on position, such as when providing <code>index_col</code> (which, by the way, defaults to 0 - the first column). It also properly handles datetime indexes and columns, and can automatically retrieve all tables under a schema or even from the entire database.</p> <p>Let's pull all the tables we stored previously, both implicitly and explicitly:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>engine</span><span class=o>=</span><span class=n>SQLITE_URL</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>   <span class=c1># (1)!</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a>
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>engine</span><span class=o>=</span><span class=n>SQLITE_URL</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (2)!</span>
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a>
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>,</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (3)!</span>
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-53-9><a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a>
</span><span id=__span-53-10><a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;yf_data:BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;yf_data:ETH-USD&quot;</span><span class=p>],</span> <span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>  <span class=c1># (4)!</span>
</span><span id=__span-53-11><a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a><span class=go>[&#39;yf_data:BTC-USD&#39;, &#39;yf_data:ETH-USD&#39;]</span>
</span></code></pre></div> <ol> <li>Pull all tables from the database.</li> <li>Pull specific tables from the database.</li> <li>Pull all tables under a schema from the database.</li> <li>Pull tables from the database, specifying the schema for each.</li> </ol> <p>You can also specify information per feature or symbol by providing it as an instance of <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.key_dict>key_dict</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTCUSD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETHUSD&quot;</span><span class=p>],</span> 
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=gp>... </span>    <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>,</span>
</span><span id=__span-54-4><a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a><span class=gp>... </span>    <span class=n>table</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-54-5><a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=gp>... </span>        <span class=s2>&quot;BTCUSD&quot;</span><span class=p>:</span> <span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span>
</span><span id=__span-54-6><a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a><span class=gp>... </span>        <span class=s2>&quot;ETHUSD&quot;</span><span class=p>:</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>,</span>
</span><span id=__span-54-7><a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-54-8><a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a><span class=gp>... </span>    <span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span>
</span><span id=__span-54-9><a id=__codelineno-54-9 name=__codelineno-54-9 href=#__codelineno-54-9></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-54-10><a id=__codelineno-54-10 name=__codelineno-54-10 href=#__codelineno-54-10></a><span class=go>[&#39;BTCUSD&#39;, &#39;ETHUSD&#39;]</span>
</span></code></pre></div> <p>This is especially useful for executing custom queries:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s1>&#39;SELECT * FROM yf_data.&quot;BTC-USD&quot;&#39;</span><span class=p>,</span>
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s1>&#39;SELECT * FROM yf_data.&quot;ETH-USD&quot;&#39;</span><span class=p>,</span>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a><span class=gp>... </span>    <span class=p>}),</span> 
</span><span id=__span-55-7><a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a><span class=gp>... </span>    <span class=n>index_col</span><span class=o>=</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span>
</span><span id=__span-55-8><a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a><span class=gp>... </span>    <span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span>
</span><span id=__span-55-9><a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-55-10><a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>When executing a custom query, most preprocessings are not available because the query cannot be easily introspected. For example, you must provide a column name under <code>index_col</code> (or False to avoid using any column as an index).</p> </div> <p>Because different engines have different configurations, and you may not want to repeatedly pass them when pulling, you can save the respective configuration to the global settings. First, create an engine name, and then save all the keyword arguments you would normally pass to <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.fetch_key>SQLData.fetch_key</a> under this engine name in <code>vbt.settings.data.engines</code>. This is easily accomplished using <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.set_engine_settings>SQLData.set_engine_settings</a>, which takes an engine name and the keyword arguments to save. If the engine name is new, make sure to set <code>populate_</code> to True.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>set_engine_settings</span><span class=p>(</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a><span class=gp>... </span>    <span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;sqlite&quot;</span><span class=p>,</span>
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a><span class=gp>... </span>    <span class=n>populate_</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a><span class=gp>... </span>    <span class=n>engine</span><span class=o>=</span><span class=n>SQLITE_URL</span>
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>set_engine_settings</span><span class=p>(</span>
</span><span id=__span-56-8><a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a><span class=gp>... </span>    <span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;postgresql&quot;</span><span class=p>,</span>
</span><span id=__span-56-9><a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a><span class=gp>... </span>    <span class=n>populate_</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-56-10><a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a><span class=gp>... </span>    <span class=n>engine</span><span class=o>=</span><span class=n>POSTGRESQL_URL</span><span class=p>,</span>
</span><span id=__span-56-11><a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a><span class=gp>... </span>    <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span>
</span><span id=__span-56-12><a id=__codelineno-56-12 name=__codelineno-56-12 href=#__codelineno-56-12></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If any argument is None during fetching, it will be taken from these settings first. You only need to provide an engine name as <code>engine</code> or <code>engine_name</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;sqlite&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a>
</span><span id=__span-57-4><a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;postgresql&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-57-5><a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <p>You can also save specific arguments you want to use under each engine name. For example, let's define the default engine name:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>set_custom_settings</span><span class=p>(</span><span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;postgresql&quot;</span><span class=p>)</span>
</span><span id=__span-58-2><a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
</span><span id=__span-58-3><a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>()</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-58-4><a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <p>To fetch specific columns, use the <code>columns</code> argument:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;High&quot;</span><span class=p>,</span> <span class=s2>&quot;Low&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>features</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a><span class=go>[&#39;High&#39;, &#39;Low&#39;]</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you want to pull a single column and keep it as a DataFrame, set <code>squeeze</code> to False.</p> </div> <p>Unlike the Pandas method, you can also filter by any start and end condition. When <code>align_dates</code> is True (default), and <code>start</code> and/or <code>end</code> is provided, <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData.fetch_key>SQLData.fetch_key</a> will fetch just one row of data first. It will check whether the index of this row is datetime-like, and if so, will treat the provided <code>start</code> and/or <code>end</code> as datetime-like objects. This means converting them to <code>datetime</code> objects and then localizing or converting them to the timezone of the index.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If you used <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_sql>Data.to_sql</a> to save the data, be sure to use the same <code>to_utc</code> option when pulling as you did when saving.</p> </div> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=go>Date                                              </span>
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p>Most databases either do not support timezones or store data in UTC, so the default behavior is to localize any timezone-naive datetime to UTC. The user is then responsible for providing the correct timezone. If a timezone is provided via <code>tz</code> and the provided datetime is timezone-naive, it will be localized to <code>tz</code> and then converted to the timezone of the index. If <code>to_utc</code> is True, it will also be converted to UTC. If the index has no timezone, the provided datetime will be converted either to <code>tz</code> or to UTC (if <code>to_utc</code> is True), and then the timezone will be removed.</p> <p>Let's demonstrate using a custom timezone by saving and then pulling the price of AAPL:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>fetch</span><span class=p>(</span><span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2023&quot;</span><span class=p>)</span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a><span class=go>Date</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=go>2022-01-03 00:00:00-05:00    180.190979</span>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-61-6><a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a><span class=go>2022-01-05 00:00:00-05:00    173.171844</span>
</span><span id=__span-61-7><a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a><span class=go>                                    ...</span>
</span><span id=__span-61-8><a id=__codelineno-61-8 name=__codelineno-61-8 href=#__codelineno-61-8></a><span class=go>2022-12-28 00:00:00-05:00    125.504539</span>
</span><span id=__span-61-9><a id=__codelineno-61-9 name=__codelineno-61-9 href=#__codelineno-61-9></a><span class=go>2022-12-29 00:00:00-05:00    129.059372</span>
</span><span id=__span-61-10><a id=__codelineno-61-10 name=__codelineno-61-10 href=#__codelineno-61-10></a><span class=go>2022-12-30 00:00:00-05:00    129.378006</span>
</span><span id=__span-61-11><a id=__codelineno-61-11 name=__codelineno-61-11 href=#__codelineno-61-11></a><span class=go>Name: Close, Length: 251, dtype: float64</span>
</span><span id=__span-61-12><a id=__codelineno-61-12 name=__codelineno-61-12 href=#__codelineno-61-12></a>
</span><span id=__span-61-13><a id=__codelineno-61-13 name=__codelineno-61-13 href=#__codelineno-61-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=s2>&quot;sqlite&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-61-14><a id=__codelineno-61-14 name=__codelineno-61-14 href=#__codelineno-61-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=s2>&quot;postgresql&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-61-15><a id=__codelineno-61-15 name=__codelineno-61-15 href=#__codelineno-61-15></a>
</span><span id=__span-61-16><a id=__codelineno-61-16 name=__codelineno-61-16 href=#__codelineno-61-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-61-17><a id=__codelineno-61-17 name=__codelineno-61-17 href=#__codelineno-61-17></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-61-18><a id=__codelineno-61-18 name=__codelineno-61-18 href=#__codelineno-61-18></a><span class=gp>... </span>    <span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;sqlite&quot;</span><span class=p>,</span> 
</span><span id=__span-61-19><a id=__codelineno-61-19 name=__codelineno-61-19 href=#__codelineno-61-19></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-12-23&quot;</span><span class=p>,</span>
</span><span id=__span-61-20><a id=__codelineno-61-20 name=__codelineno-61-20 href=#__codelineno-61-20></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-12-30&quot;</span><span class=p>,</span>
</span><span id=__span-61-21><a id=__codelineno-61-21 name=__codelineno-61-21 href=#__codelineno-61-21></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-61-22><a id=__codelineno-61-22 name=__codelineno-61-22 href=#__codelineno-61-22></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-61-23><a id=__codelineno-61-23 name=__codelineno-61-23 href=#__codelineno-61-23></a><span class=go>Date</span>
</span><span id=__span-61-24><a id=__codelineno-61-24 name=__codelineno-61-24 href=#__codelineno-61-24></a><span class=go>2022-12-23 00:00:00-05:00    131.299820</span>
</span><span id=__span-61-25><a id=__codelineno-61-25 name=__codelineno-61-25 href=#__codelineno-61-25></a><span class=go>2022-12-27 00:00:00-05:00    129.477585</span>
</span><span id=__span-61-26><a id=__codelineno-61-26 name=__codelineno-61-26 href=#__codelineno-61-26></a><span class=go>2022-12-28 00:00:00-05:00    125.504539</span>
</span><span id=__span-61-27><a id=__codelineno-61-27 name=__codelineno-61-27 href=#__codelineno-61-27></a><span class=go>2022-12-29 00:00:00-05:00    129.059372</span>
</span><span id=__span-61-28><a id=__codelineno-61-28 name=__codelineno-61-28 href=#__codelineno-61-28></a><span class=go>Name: Close, dtype: float64</span>
</span><span id=__span-61-29><a id=__codelineno-61-29 name=__codelineno-61-29 href=#__codelineno-61-29></a>
</span><span id=__span-61-30><a id=__codelineno-61-30 name=__codelineno-61-30 href=#__codelineno-61-30></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-61-31><a id=__codelineno-61-31 name=__codelineno-61-31 href=#__codelineno-61-31></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-61-32><a id=__codelineno-61-32 name=__codelineno-61-32 href=#__codelineno-61-32></a><span class=gp>... </span>    <span class=n>engine_name</span><span class=o>=</span><span class=s2>&quot;postgresql&quot;</span><span class=p>,</span> 
</span><span id=__span-61-33><a id=__codelineno-61-33 name=__codelineno-61-33 href=#__codelineno-61-33></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-12-23&quot;</span><span class=p>,</span>
</span><span id=__span-61-34><a id=__codelineno-61-34 name=__codelineno-61-34 href=#__codelineno-61-34></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-12-30&quot;</span><span class=p>,</span>
</span><span id=__span-61-35><a id=__codelineno-61-35 name=__codelineno-61-35 href=#__codelineno-61-35></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-61-36><a id=__codelineno-61-36 name=__codelineno-61-36 href=#__codelineno-61-36></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-61-37><a id=__codelineno-61-37 name=__codelineno-61-37 href=#__codelineno-61-37></a><span class=go>Date</span>
</span><span id=__span-61-38><a id=__codelineno-61-38 name=__codelineno-61-38 href=#__codelineno-61-38></a><span class=go>2022-12-23 00:00:00-05:00    131.299820</span>
</span><span id=__span-61-39><a id=__codelineno-61-39 name=__codelineno-61-39 href=#__codelineno-61-39></a><span class=go>2022-12-27 00:00:00-05:00    129.477585</span>
</span><span id=__span-61-40><a id=__codelineno-61-40 name=__codelineno-61-40 href=#__codelineno-61-40></a><span class=go>2022-12-28 00:00:00-05:00    125.504539</span>
</span><span id=__span-61-41><a id=__codelineno-61-41 name=__codelineno-61-41 href=#__codelineno-61-41></a><span class=go>2022-12-29 00:00:00-05:00    129.059372</span>
</span><span id=__span-61-42><a id=__codelineno-61-42 name=__codelineno-61-42 href=#__codelineno-61-42></a><span class=go>Name: Close, dtype: float64</span>
</span></code></pre></div> <ol> <li>The first argument can also be an engine name from the global settings.</li> <li>The schema defined in the global settings will be used by default.</li> </ol> <p>All datetime pre-processing can be disabled by turning off <code>align_dates</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-62-3><a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-12-23&quot;</span><span class=p>,</span>
</span><span id=__span-62-4><a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-12-30&quot;</span><span class=p>,</span>
</span><span id=__span-62-5><a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>,</span>
</span><span id=__span-62-6><a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a><span class=gp>... </span>    <span class=n>align_dates</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-62-7><a id=__codelineno-62-7 name=__codelineno-62-7 href=#__codelineno-62-7></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-62-8><a id=__codelineno-62-8 name=__codelineno-62-8 href=#__codelineno-62-8></a><span class=go>Date</span>
</span><span id=__span-62-9><a id=__codelineno-62-9 name=__codelineno-62-9 href=#__codelineno-62-9></a><span class=go>2022-12-23 00:00:00-05:00    131.299820</span>
</span><span id=__span-62-10><a id=__codelineno-62-10 name=__codelineno-62-10 href=#__codelineno-62-10></a><span class=go>2022-12-27 00:00:00-05:00    129.477585</span>
</span><span id=__span-62-11><a id=__codelineno-62-11 name=__codelineno-62-11 href=#__codelineno-62-11></a><span class=go>2022-12-28 00:00:00-05:00    125.504539</span>
</span><span id=__span-62-12><a id=__codelineno-62-12 name=__codelineno-62-12 href=#__codelineno-62-12></a><span class=go>2022-12-29 00:00:00-05:00    129.059372</span>
</span><span id=__span-62-13><a id=__codelineno-62-13 name=__codelineno-62-13 href=#__codelineno-62-13></a><span class=go>Name: Close, dtype: float64</span>
</span></code></pre></div> <p>When you need to execute a custom query, filtering must be performed inside the query itself:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-63-4><a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=gp>... </span><span class=s2>        SELECT *</span>
</span><span id=__span-63-5><a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a><span class=gp>... </span><span class=s2>        FROM yf_data.&quot;AAPL&quot; </span>
</span><span id=__span-63-6><a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a><span class=gp>... </span><span class=s2>        WHERE yf_data.&quot;AAPL&quot;.&quot;Date&quot; &gt;= :start AND yf_data.&quot;AAPL&quot;.&quot;Date&quot; &lt; :end</span>
</span><span id=__span-63-7><a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a><span class=gp>... </span><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-63-8><a id=__codelineno-63-8 name=__codelineno-63-8 href=#__codelineno-63-8></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>,</span>
</span><span id=__span-63-9><a id=__codelineno-63-9 name=__codelineno-63-9 href=#__codelineno-63-9></a><span class=gp>... </span>    <span class=n>index_col</span><span class=o>=</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span>
</span><span id=__span-63-10><a id=__codelineno-63-10 name=__codelineno-63-10 href=#__codelineno-63-10></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-63-11><a id=__codelineno-63-11 name=__codelineno-63-11 href=#__codelineno-63-11></a><span class=gp>... </span>        <span class=s2>&quot;start&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-12-23&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>),</span>
</span><span id=__span-63-12><a id=__codelineno-63-12 name=__codelineno-63-12 href=#__codelineno-63-12></a><span class=gp>... </span>        <span class=s2>&quot;end&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-12-30&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>)</span>
</span><span id=__span-63-13><a id=__codelineno-63-13 name=__codelineno-63-13 href=#__codelineno-63-13></a><span class=gp>... </span>    <span class=p>}</span>
</span><span id=__span-63-14><a id=__codelineno-63-14 name=__codelineno-63-14 href=#__codelineno-63-14></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-63-15><a id=__codelineno-63-15 name=__codelineno-63-15 href=#__codelineno-63-15></a><span class=go>Date</span>
</span><span id=__span-63-16><a id=__codelineno-63-16 name=__codelineno-63-16 href=#__codelineno-63-16></a><span class=go>2022-12-23 00:00:00-05:00    131.299820</span>
</span><span id=__span-63-17><a id=__codelineno-63-17 name=__codelineno-63-17 href=#__codelineno-63-17></a><span class=go>2022-12-27 00:00:00-05:00    129.477585</span>
</span><span id=__span-63-18><a id=__codelineno-63-18 name=__codelineno-63-18 href=#__codelineno-63-18></a><span class=go>2022-12-28 00:00:00-05:00    125.504539</span>
</span><span id=__span-63-19><a id=__codelineno-63-19 name=__codelineno-63-19 href=#__codelineno-63-19></a><span class=go>2022-12-29 00:00:00-05:00    129.059372</span>
</span><span id=__span-63-20><a id=__codelineno-63-20 name=__codelineno-63-20 href=#__codelineno-63-20></a><span class=go>Name: Close, dtype: float64</span>
</span></code></pre></div> <p>To filter by row number, a column with row numbers must be included first. This can be done automatically by using <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_sql>Data.to_sql</a> with <code>attach_row_number</code> set to True.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=s2>&quot;sqlite&quot;</span><span class=p>,</span> <span class=n>attach_row_number</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>if_exists</span><span class=o>=</span><span class=s2>&quot;replace&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>Then, when pulling, you can use <code>start_row</code> and <code>end_row</code> directly:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-65-2><a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-65-3><a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a><span class=gp>... </span>    <span class=n>start_row</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span><span id=__span-65-4><a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a><span class=gp>... </span>    <span class=n>end_row</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-65-5><a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-65-6><a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-65-7><a id=__codelineno-65-7 name=__codelineno-65-7 href=#__codelineno-65-7></a><span class=go>Date</span>
</span><span id=__span-65-8><a id=__codelineno-65-8 name=__codelineno-65-8 href=#__codelineno-65-8></a><span class=go>2022-01-10 00:00:00-05:00    170.469116</span>
</span><span id=__span-65-9><a id=__codelineno-65-9 name=__codelineno-65-9 href=#__codelineno-65-9></a><span class=go>2022-01-11 00:00:00-05:00    173.330231</span>
</span><span id=__span-65-10><a id=__codelineno-65-10 name=__codelineno-65-10 href=#__codelineno-65-10></a><span class=go>2022-01-12 00:00:00-05:00    173.775711</span>
</span><span id=__span-65-11><a id=__codelineno-65-11 name=__codelineno-65-11 href=#__codelineno-65-11></a><span class=go>2022-01-13 00:00:00-05:00    170.469116</span>
</span><span id=__span-65-12><a id=__codelineno-65-12 name=__codelineno-65-12 href=#__codelineno-65-12></a><span class=go>2022-01-14 00:00:00-05:00    171.340347</span>
</span><span id=__span-65-13><a id=__codelineno-65-13 name=__codelineno-65-13 href=#__codelineno-65-13></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span></code></pre></div> <h4 id=chunking_2>Chunking<a class=headerlink href=#chunking_2 title="Permanent link">&para;</a></h4> <p>Chunking for SQL databases works the same way as it does for CSV files:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-66-2><a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span>
</span><span id=__span-66-3><a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a><span class=gp>... </span>    <span class=n>chunksize</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-66-4><a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a><span class=gp>... </span>    <span class=n>chunk_func</span><span class=o>=</span><span class=k>lambda</span> <span class=n>iterator</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span>
</span><span id=__span-66-5><a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a><span class=gp>... </span>        <span class=n>df</span> 
</span><span id=__span-66-6><a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a><span class=gp>... </span>        <span class=k>for</span> <span class=n>df</span> <span class=ow>in</span> <span class=n>iterator</span>
</span><span id=__span-66-7><a id=__codelineno-66-7 name=__codelineno-66-7 href=#__codelineno-66-7></a><span class=gp>... </span>        <span class=k>if</span> <span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>is_month_start</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span><span id=__span-66-8><a id=__codelineno-66-8 name=__codelineno-66-8 href=#__codelineno-66-8></a><span class=gp>... </span>    <span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span>
</span><span id=__span-66-9><a id=__codelineno-66-9 name=__codelineno-66-9 href=#__codelineno-66-9></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-66-10><a id=__codelineno-66-10 name=__codelineno-66-10 href=#__codelineno-66-10></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-66-11><a id=__codelineno-66-11 name=__codelineno-66-11 href=#__codelineno-66-11></a><span class=go>Date</span>
</span><span id=__span-66-12><a id=__codelineno-66-12 name=__codelineno-66-12 href=#__codelineno-66-12></a><span class=go>2022-02-01 00:00:00-05:00    172.864914</span>
</span><span id=__span-66-13><a id=__codelineno-66-13 name=__codelineno-66-13 href=#__codelineno-66-13></a><span class=go>2022-03-01 00:00:00-05:00    161.774826</span>
</span><span id=__span-66-14><a id=__codelineno-66-14 name=__codelineno-66-14 href=#__codelineno-66-14></a><span class=go>2022-04-01 00:00:00-04:00    172.787796</span>
</span><span id=__span-66-15><a id=__codelineno-66-15 name=__codelineno-66-15 href=#__codelineno-66-15></a><span class=go>2022-06-01 00:00:00-04:00    147.627930</span>
</span><span id=__span-66-16><a id=__codelineno-66-16 name=__codelineno-66-16 href=#__codelineno-66-16></a><span class=go>2022-07-01 00:00:00-04:00    137.919113</span>
</span><span id=__span-66-17><a id=__codelineno-66-17 name=__codelineno-66-17 href=#__codelineno-66-17></a><span class=go>2022-08-01 00:00:00-04:00    160.334793</span>
</span><span id=__span-66-18><a id=__codelineno-66-18 name=__codelineno-66-18 href=#__codelineno-66-18></a><span class=go>2022-09-01 00:00:00-04:00    157.028458</span>
</span><span id=__span-66-19><a id=__codelineno-66-19 name=__codelineno-66-19 href=#__codelineno-66-19></a><span class=go>2022-11-01 00:00:00-04:00    149.761551</span>
</span><span id=__span-66-20><a id=__codelineno-66-20 name=__codelineno-66-20 href=#__codelineno-66-20></a><span class=go>2022-12-01 00:00:00-05:00    147.679932</span>
</span><span id=__span-66-21><a id=__codelineno-66-21 name=__codelineno-66-21 href=#__codelineno-66-21></a><span class=go>Name: Close, dtype: float64</span>
</span></code></pre></div> <h3 id=duckdb_1>DuckDB<a class=headerlink href=#duckdb_1 title="Permanent link">&para;</a></h3> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>The previous method (using SQLAlchemy) can also be used to read from a DuckDB database. To do this, you will need to install the <a href=https://pypi.org/project/duckdb-engine/ >duckdb-engine</a> extension.</p> </div> <p>To fetch data using DuckDB, you can use the convenient class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/duckdb/#vectorbtpro.data.custom.duckdb.DuckDBData>DuckDBData</a>. This class provides methods for discovering catalogs, schemas, and tables, as well as methods for fetching the data itself, such as <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/duckdb/#vectorbtpro.data.custom.duckdb.DuckDBData.fetch_key>DuckDBData.fetch_key</a>. Let's delete the existing DuckDB database, create a new one by setting its URL globally, add some data, and review the stored objects:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>remove_file</span><span class=p>(</span><span class=n>DUCKDB_URL</span><span class=p>)</span>
</span><span id=__span-67-2><a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a>
</span><span id=__span-67-3><a id=__codelineno-67-3 name=__codelineno-67-3 href=#__codelineno-67-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>set_custom_settings</span><span class=p>(</span>
</span><span id=__span-67-4><a id=__codelineno-67-4 name=__codelineno-67-4 href=#__codelineno-67-4></a><span class=gp>... </span>    <span class=n>connection</span><span class=o>=</span><span class=n>DUCKDB_URL</span>
</span><span id=__span-67-5><a id=__codelineno-67-5 name=__codelineno-67-5 href=#__codelineno-67-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-67-6><a id=__codelineno-67-6 name=__codelineno-67-6 href=#__codelineno-67-6></a>
</span><span id=__span-67-7><a id=__codelineno-67-7 name=__codelineno-67-7 href=#__codelineno-67-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data</span><span class=o>.</span><span class=n>to_duckdb</span><span class=p>(</span><span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span>
</span><span id=__span-67-8><a id=__codelineno-67-8 name=__codelineno-67-8 href=#__codelineno-67-8></a>
</span><span id=__span-67-9><a id=__codelineno-67-9 name=__codelineno-67-9 href=#__codelineno-67-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>list_catalogs</span><span class=p>()</span>
</span><span id=__span-67-10><a id=__codelineno-67-10 name=__codelineno-67-10 href=#__codelineno-67-10></a><span class=go>[&#39;database&#39;]</span>
</span><span id=__span-67-11><a id=__codelineno-67-11 name=__codelineno-67-11 href=#__codelineno-67-11></a>
</span><span id=__span-67-12><a id=__codelineno-67-12 name=__codelineno-67-12 href=#__codelineno-67-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>list_schemas</span><span class=p>()</span>
</span><span id=__span-67-13><a id=__codelineno-67-13 name=__codelineno-67-13 href=#__codelineno-67-13></a><span class=go>[&#39;main&#39;, &#39;yf_data&#39;]</span>
</span><span id=__span-67-14><a id=__codelineno-67-14 name=__codelineno-67-14 href=#__codelineno-67-14></a>
</span><span id=__span-67-15><a id=__codelineno-67-15 name=__codelineno-67-15 href=#__codelineno-67-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>list_tables</span><span class=p>()</span>
</span><span id=__span-67-16><a id=__codelineno-67-16 name=__codelineno-67-16 href=#__codelineno-67-16></a><span class=go>[&#39;yf_data:BTC-USD&#39;, &#39;yf_data:ETH-USD&#39;]</span>
</span></code></pre></div> <p>To fetch the data, use <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/duckdb/#vectorbtpro.data.custom.duckdb.DuckDBData.pull>DuckDBData.pull</a>. If you provide one or more keys, they will be used as table names. Without any arguments, the method will first determine which tables are stored in the database and then pull them:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;yf_data:BTC-USD&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-68-2><a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a><span class=go>[&#39;yf_data:BTC-USD&#39;]</span>
</span><span id=__span-68-3><a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a>
</span><span id=__span-68-4><a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-68-5><a id=__codelineno-68-5 name=__codelineno-68-5 href=#__codelineno-68-5></a><span class=go>[&#39;BTC-USD&#39;]</span>
</span><span id=__span-68-6><a id=__codelineno-68-6 name=__codelineno-68-6 href=#__codelineno-68-6></a>
</span><span id=__span-68-7><a id=__codelineno-68-7 name=__codelineno-68-7 href=#__codelineno-68-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-68-8><a id=__codelineno-68-8 name=__codelineno-68-8 href=#__codelineno-68-8></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-68-9><a id=__codelineno-68-9 name=__codelineno-68-9 href=#__codelineno-68-9></a>
</span><span id=__span-68-10><a id=__codelineno-68-10 name=__codelineno-68-10 href=#__codelineno-68-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>()</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-68-11><a id=__codelineno-68-11 name=__codelineno-68-11 href=#__codelineno-68-11></a><span class=go>[&#39;yf_data:BTC-USD&#39;, &#39;yf_data:ETH-USD&#39;]</span>
</span></code></pre></div> <p>If you want to keep symbol names and table names separate, you can provide each table explicitly using a dictionary with <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.key_dict>key_dict</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-69-2><a id=__codelineno-69-2 name=__codelineno-69-2 href=#__codelineno-69-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH&quot;</span><span class=p>],</span> 
</span><span id=__span-69-3><a id=__codelineno-69-3 name=__codelineno-69-3 href=#__codelineno-69-3></a><span class=gp>... </span>    <span class=n>table</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>(</span><span class=n>BTC</span><span class=o>=</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>ETH</span><span class=o>=</span><span class=s2>&quot;ETH-USD&quot;</span><span class=p>),</span>
</span><span id=__span-69-4><a id=__codelineno-69-4 name=__codelineno-69-4 href=#__codelineno-69-4></a><span class=gp>... </span>    <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span>
</span><span id=__span-69-5><a id=__codelineno-69-5 name=__codelineno-69-5 href=#__codelineno-69-5></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-69-6><a id=__codelineno-69-6 name=__codelineno-69-6 href=#__codelineno-69-6></a><span class=go>[&#39;BTC&#39;, &#39;ETH&#39;]</span>
</span></code></pre></div> <p>You can follow the same approach to execute custom queries:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-70-2><a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-70-3><a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-70-4><a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s1>&#39;SELECT * FROM yf_data.&quot;BTC-USD&quot;&#39;</span><span class=p>,</span> 
</span><span id=__span-70-5><a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s1>&#39;SELECT * FROM yf_data.&quot;ETH-USD&quot;&#39;</span>
</span><span id=__span-70-6><a id=__codelineno-70-6 name=__codelineno-70-6 href=#__codelineno-70-6></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-70-7><a id=__codelineno-70-7 name=__codelineno-70-7 href=#__codelineno-70-7></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-70-8><a id=__codelineno-70-8 name=__codelineno-70-8 href=#__codelineno-70-8></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <p>In addition to querying tables, you can also read CSV, Parquet, and JSON files. The reading behavior is similar to the writing process shown in <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.to_duckdb>Data.to_duckdb</a>, where there are three arguments: <code>read_format</code>, <code>read_path</code>, and <code>read_options</code>. The first argument specifies the format of the file(s), the second specifies the file path(s), and the third controls the options for reading the files. If <code>read_format</code> is not provided, it is parsed from the file extension and used to call the corresponding <code>read_{format}</code> function in the SQL query, for example, <a href=https://duckdb.org/docs/data/parquet/overview><code>read_parquet</code></a> for Parquet files.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>read_path</span><span class=o>=</span><span class=s2>&quot;data&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-71-2><a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-71-3><a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a>
</span><span id=__span-71-4><a id=__codelineno-71-4 name=__codelineno-71-4 href=#__codelineno-71-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-71-5><a id=__codelineno-71-5 name=__codelineno-71-5 href=#__codelineno-71-5></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span>
</span><span id=__span-71-6><a id=__codelineno-71-6 name=__codelineno-71-6 href=#__codelineno-71-6></a><span class=gp>... </span>    <span class=n>read_path</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-71-7><a id=__codelineno-71-7 name=__codelineno-71-7 href=#__codelineno-71-7></a><span class=gp>... </span>         <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;data/BTC-USD.parquet&quot;</span><span class=p>,</span>
</span><span id=__span-71-8><a id=__codelineno-71-8 name=__codelineno-71-8 href=#__codelineno-71-8></a><span class=gp>... </span>         <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;data/ETH-USD.parquet&quot;</span>
</span><span id=__span-71-9><a id=__codelineno-71-9 name=__codelineno-71-9 href=#__codelineno-71-9></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-71-10><a id=__codelineno-71-10 name=__codelineno-71-10 href=#__codelineno-71-10></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-71-11><a id=__codelineno-71-11 name=__codelineno-71-11 href=#__codelineno-71-11></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span><span id=__span-71-12><a id=__codelineno-71-12 name=__codelineno-71-12 href=#__codelineno-71-12></a>
</span><span id=__span-71-13><a id=__codelineno-71-13 name=__codelineno-71-13 href=#__codelineno-71-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-71-14><a id=__codelineno-71-14 name=__codelineno-71-14 href=#__codelineno-71-14></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span>
</span><span id=__span-71-15><a id=__codelineno-71-15 name=__codelineno-71-15 href=#__codelineno-71-15></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-71-16><a id=__codelineno-71-16 name=__codelineno-71-16 href=#__codelineno-71-16></a><span class=gp>... </span>         <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;SELECT * FROM read_parquet(&#39;data/BTC-USD.parquet&#39;)&quot;</span><span class=p>,</span>
</span><span id=__span-71-17><a id=__codelineno-71-17 name=__codelineno-71-17 href=#__codelineno-71-17></a><span class=gp>... </span>         <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;SELECT * FROM read_parquet(&#39;data/ETH-USD.parquet&#39;)&quot;</span>
</span><span id=__span-71-18><a id=__codelineno-71-18 name=__codelineno-71-18 href=#__codelineno-71-18></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-71-19><a id=__codelineno-71-19 name=__codelineno-71-19 href=#__codelineno-71-19></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>symbols</span>
</span><span id=__span-71-20><a id=__codelineno-71-20 name=__codelineno-71-20 href=#__codelineno-71-20></a><span class=go>[&#39;BTC-USD&#39;, &#39;ETH-USD&#39;]</span>
</span></code></pre></div> <h2 id=updating>Updating<a class=headerlink href=#updating title="Permanent link">&para;</a></h2> <p>Updating local data works similarly to updating remote data, but it only affects the contents of the local file or database. When updating, the system will download new data, append it to the local dataset, and, if necessary, remove any duplicates. As a result, the file or database will always reflect the most up-to-date data available according to the update logic. </p> <p>You can trigger an update manually, or you can configure automatic updates by setting schedules or making calls from your code. The specifics depend on how you have configured your data pipeline and storage. </p> <p>Be sure to use the appropriate tools and methods provided by your data source and storage format to ensure reliable and consistent updates.</p> <h3 id=csv-hdf>CSV &amp; HDF<a class=headerlink href=#csv-hdf title="Permanent link">&para;</a></h3> <p>Tabular data, such as CSV and HDF files, can be read line by line, allowing you to monitor data updates. The classes <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/csv/#vectorbtpro.data.custom.csv.CSVData>CSVData</a> and <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData>HDFData</a> can be updated like any other preset data class by tracking the last row index in <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.returned_kwargs>Data.returned_kwargs</a>. Whenever an update is triggered, this index is used as the starting row for reading the dataset. After the update, the end row becomes the new last row index.</p> <p>Let's separately download data for <code>BTC-USD</code> and <code>ETH-USD</code>, save them to a single HDF file, and read the entire file using <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData>HDFData</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-72-1><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_btc</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-72-2><a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a><span class=gp>... </span>    <span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> 
</span><span id=__span-72-3><a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>,</span> 
</span><span id=__span-72-4><a id=__codelineno-72-4 name=__codelineno-72-4 href=#__codelineno-72-4></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-03&quot;</span>
</span><span id=__span-72-5><a id=__codelineno-72-5 name=__codelineno-72-5 href=#__codelineno-72-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-72-6><a id=__codelineno-72-6 name=__codelineno-72-6 href=#__codelineno-72-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_eth</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-72-7><a id=__codelineno-72-7 name=__codelineno-72-7 href=#__codelineno-72-7></a><span class=gp>... </span>    <span class=s2>&quot;ETH-USD&quot;</span><span class=p>,</span> 
</span><span id=__span-72-8><a id=__codelineno-72-8 name=__codelineno-72-8 href=#__codelineno-72-8></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>,</span> 
</span><span id=__span-72-9><a id=__codelineno-72-9 name=__codelineno-72-9 href=#__codelineno-72-9></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-05&quot;</span>
</span><span id=__span-72-10><a id=__codelineno-72-10 name=__codelineno-72-10 href=#__codelineno-72-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-72-11><a id=__codelineno-72-11 name=__codelineno-72-11 href=#__codelineno-72-11></a>
</span><span id=__span-72-12><a id=__codelineno-72-12 name=__codelineno-72-12 href=#__codelineno-72-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_btc</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span><span class=s2>&quot;data.h5&quot;</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=s2>&quot;yf_data_btc&quot;</span><span class=p>)</span>
</span><span id=__span-72-13><a id=__codelineno-72-13 name=__codelineno-72-13 href=#__codelineno-72-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_eth</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span><span class=s2>&quot;data.h5&quot;</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=s2>&quot;yf_data_eth&quot;</span><span class=p>)</span>
</span><span id=__span-72-14><a id=__codelineno-72-14 name=__codelineno-72-14 href=#__codelineno-72-14></a>
</span><span id=__span-72-15><a id=__codelineno-72-15 name=__codelineno-72-15 href=#__codelineno-72-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>HDFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>paths</span><span class=o>=</span><span class=s2>&quot;data.h5&quot;</span><span class=p>)</span>
</span></code></pre></div> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-73-1><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-73-2><a id=__codelineno-73-2 name=__codelineno-73-2 href=#__codelineno-73-2></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-73-3><a id=__codelineno-73-3 name=__codelineno-73-3 href=#__codelineno-73-3></a><span class=go>Date                                              </span>
</span><span id=__span-73-4><a id=__codelineno-73-4 name=__codelineno-73-4 href=#__codelineno-73-4></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316         NaN</span>
</span><span id=__span-73-5><a id=__codelineno-73-5 name=__codelineno-73-5 href=#__codelineno-73-5></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215         NaN</span>
</span><span id=__span-73-6><a id=__codelineno-73-6 name=__codelineno-73-6 href=#__codelineno-73-6></a><span class=go>2020-01-03 00:00:00+00:00          NaN  134.171707</span>
</span><span id=__span-73-7><a id=__codelineno-73-7 name=__codelineno-73-7 href=#__codelineno-73-7></a><span class=go>2020-01-04 00:00:00+00:00          NaN  135.069366</span>
</span></code></pre></div> <p>Now, let's look at the last row index in each dataset:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-74-1><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span><span class=o>.</span><span class=n>returned_kwargs</span>
</span><span id=__span-74-2><a id=__codelineno-74-2 name=__codelineno-74-2 href=#__codelineno-74-2></a><span class=go>key_dict({&#39;BTC-USD&#39;: {&#39;last_row&#39;: 1}, &#39;ETH-USD&#39;: {&#39;last_row&#39;: 1}})</span>
</span></code></pre></div> <p>We see that the third row in each dataset is the new start row (1 row for the header and 1 row for the data). Let's append new data to the <code>BTC-USD</code> dataset and then update our <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/hdf/#vectorbtpro.data.custom.hdf.HDFData>HDFData</a> instance:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-75-1><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_btc</span> <span class=o>=</span> <span class=n>yf_data_btc</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-06&quot;</span><span class=p>)</span>
</span><span id=__span-75-2><a id=__codelineno-75-2 name=__codelineno-75-2 href=#__codelineno-75-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yf_data_btc</span><span class=o>.</span><span class=n>to_hdf</span><span class=p>(</span><span class=s2>&quot;data.h5&quot;</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=s2>&quot;yf_data_btc&quot;</span><span class=p>)</span>
</span><span id=__span-75-3><a id=__codelineno-75-3 name=__codelineno-75-3 href=#__codelineno-75-3></a>
</span><span id=__span-75-4><a id=__codelineno-75-4 name=__codelineno-75-4 href=#__codelineno-75-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span> <span class=o>=</span> <span class=n>hdf_data</span><span class=o>.</span><span class=n>update</span><span class=p>()</span>
</span><span id=__span-75-5><a id=__codelineno-75-5 name=__codelineno-75-5 href=#__codelineno-75-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-75-6><a id=__codelineno-75-6 name=__codelineno-75-6 href=#__codelineno-75-6></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-75-7><a id=__codelineno-75-7 name=__codelineno-75-7 href=#__codelineno-75-7></a><span class=go>Date                                              </span>
</span><span id=__span-75-8><a id=__codelineno-75-8 name=__codelineno-75-8 href=#__codelineno-75-8></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316         NaN</span>
</span><span id=__span-75-9><a id=__codelineno-75-9 name=__codelineno-75-9 href=#__codelineno-75-9></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215         NaN</span>
</span><span id=__span-75-10><a id=__codelineno-75-10 name=__codelineno-75-10 href=#__codelineno-75-10></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-75-11><a id=__codelineno-75-11 name=__codelineno-75-11 href=#__codelineno-75-11></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span><span id=__span-75-12><a id=__codelineno-75-12 name=__codelineno-75-12 href=#__codelineno-75-12></a><span class=go>2020-01-05 00:00:00+00:00  7411.317383         NaN</span>
</span></code></pre></div> <p>The <code>BTC-USD</code> dataset has been updated with 3 new data points, while the <code>ETH-USD</code> dataset remains unchanged. This is reflected in the last row index:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-76-1><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hdf_data</span><span class=o>.</span><span class=n>returned_kwargs</span>
</span><span id=__span-76-2><a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a><span class=go>key_dict({</span>
</span><span id=__span-76-3><a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a><span class=go>    &#39;BTC-USD&#39;: {&#39;last_row&#39;: 4, &#39;tz_convert&#39;: datetime.timezone.utc}, </span>
</span><span id=__span-76-4><a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a><span class=go>    &#39;ETH-USD&#39;: {&#39;last_row&#39;: 1, &#39;tz_convert&#39;: datetime.timezone.utc}</span>
</span><span id=__span-76-5><a id=__codelineno-76-5 name=__codelineno-76-5 href=#__codelineno-76-5></a><span class=go>})</span>
</span></code></pre></div> <p>You can repeat this workflow as often as needed.</p> <h3 id=feather-parquet_2>Feather &amp; Parquet<a class=headerlink href=#feather-parquet_2 title="Permanent link">&para;</a></h3> <p>Feather and Parquet classes do not have any <code>start</code> or <code>end</code> arguments to select a date range to pull, but you can still load all the data and append any differences to what you already have. This operation is efficient because reading these formats is highly optimized. In newer versions of Pandas, you can also filter partitions using the <code>filters</code> argument (supported only for Parquet):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-77-1><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-77-2><a id=__codelineno-77-2 name=__codelineno-77-2 href=#__codelineno-77-2></a><span class=gp>... </span>    <span class=s2>&quot;BNB-USD&quot;</span><span class=p>,</span> 
</span><span id=__span-77-3><a id=__codelineno-77-3 name=__codelineno-77-3 href=#__codelineno-77-3></a><span class=gp>... </span>    <span class=n>filters</span><span class=o>=</span><span class=p>[(</span><span class=s2>&quot;group&quot;</span><span class=p>,</span> <span class=s2>&quot;&lt;&quot;</span><span class=p>,</span> <span class=s2>&quot;2020-01-03&quot;</span><span class=p>)]</span>
</span><span id=__span-77-4><a id=__codelineno-77-4 name=__codelineno-77-4 href=#__codelineno-77-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-77-5><a id=__codelineno-77-5 name=__codelineno-77-5 href=#__codelineno-77-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-77-6><a id=__codelineno-77-6 name=__codelineno-77-6 href=#__codelineno-77-6></a><span class=go>Date</span>
</span><span id=__span-77-7><a id=__codelineno-77-7 name=__codelineno-77-7 href=#__codelineno-77-7></a><span class=go>2020-01-01 00:00:00+00:00    13.689083</span>
</span><span id=__span-77-8><a id=__codelineno-77-8 name=__codelineno-77-8 href=#__codelineno-77-8></a><span class=go>2020-01-02 00:00:00+00:00    13.027011</span>
</span><span id=__span-77-9><a id=__codelineno-77-9 name=__codelineno-77-9 href=#__codelineno-77-9></a><span class=go>Name: Close, dtype: float64</span>
</span><span id=__span-77-10><a id=__codelineno-77-10 name=__codelineno-77-10 href=#__codelineno-77-10></a>
</span><span id=__span-77-11><a id=__codelineno-77-11 name=__codelineno-77-11 href=#__codelineno-77-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span> <span class=o>=</span> <span class=n>parquet_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-77-12><a id=__codelineno-77-12 name=__codelineno-77-12 href=#__codelineno-77-12></a><span class=gp>... </span>    <span class=n>filters</span><span class=o>=</span><span class=p>[(</span><span class=s2>&quot;group&quot;</span><span class=p>,</span> <span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span> <span class=s2>&quot;2020-01-03&quot;</span><span class=p>)]</span>
</span><span id=__span-77-13><a id=__codelineno-77-13 name=__codelineno-77-13 href=#__codelineno-77-13></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-77-14><a id=__codelineno-77-14 name=__codelineno-77-14 href=#__codelineno-77-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-77-15><a id=__codelineno-77-15 name=__codelineno-77-15 href=#__codelineno-77-15></a><span class=go>Date</span>
</span><span id=__span-77-16><a id=__codelineno-77-16 name=__codelineno-77-16 href=#__codelineno-77-16></a><span class=go>2020-01-01 00:00:00+00:00    13.689083</span>
</span><span id=__span-77-17><a id=__codelineno-77-17 name=__codelineno-77-17 href=#__codelineno-77-17></a><span class=go>2020-01-02 00:00:00+00:00    13.027011</span>
</span><span id=__span-77-18><a id=__codelineno-77-18 name=__codelineno-77-18 href=#__codelineno-77-18></a><span class=go>2020-01-03 00:00:00+00:00    13.660452</span>
</span><span id=__span-77-19><a id=__codelineno-77-19 name=__codelineno-77-19 href=#__codelineno-77-19></a><span class=go>2020-01-04 00:00:00+00:00    13.891512</span>
</span><span id=__span-77-20><a id=__codelineno-77-20 name=__codelineno-77-20 href=#__codelineno-77-20></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span></code></pre></div> <p>In newer versions of PyArrow, you can use the same argument to select rows:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-78-1><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ParquetData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-78-2><a id=__codelineno-78-2 name=__codelineno-78-2 href=#__codelineno-78-2></a><span class=gp>... </span>    <span class=s2>&quot;BNB-USD&quot;</span><span class=p>,</span> 
</span><span id=__span-78-3><a id=__codelineno-78-3 name=__codelineno-78-3 href=#__codelineno-78-3></a><span class=gp>... </span>    <span class=n>filters</span><span class=o>=</span><span class=p>[(</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span> <span class=s2>&quot;&lt;&quot;</span><span class=p>,</span> <span class=n>vbt</span><span class=o>.</span><span class=n>timestamp</span><span class=p>(</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;UTC&quot;</span><span class=p>))]</span>
</span><span id=__span-78-4><a id=__codelineno-78-4 name=__codelineno-78-4 href=#__codelineno-78-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-78-5><a id=__codelineno-78-5 name=__codelineno-78-5 href=#__codelineno-78-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-78-6><a id=__codelineno-78-6 name=__codelineno-78-6 href=#__codelineno-78-6></a><span class=go>Date</span>
</span><span id=__span-78-7><a id=__codelineno-78-7 name=__codelineno-78-7 href=#__codelineno-78-7></a><span class=go>2020-01-01 00:00:00+00:00    13.689083</span>
</span><span id=__span-78-8><a id=__codelineno-78-8 name=__codelineno-78-8 href=#__codelineno-78-8></a><span class=go>2020-01-02 00:00:00+00:00    13.027011</span>
</span><span id=__span-78-9><a id=__codelineno-78-9 name=__codelineno-78-9 href=#__codelineno-78-9></a><span class=go>Name: Close, dtype: float64</span>
</span><span id=__span-78-10><a id=__codelineno-78-10 name=__codelineno-78-10 href=#__codelineno-78-10></a>
</span><span id=__span-78-11><a id=__codelineno-78-11 name=__codelineno-78-11 href=#__codelineno-78-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span> <span class=o>=</span> <span class=n>parquet_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-78-12><a id=__codelineno-78-12 name=__codelineno-78-12 href=#__codelineno-78-12></a><span class=gp>... </span>    <span class=n>filters</span><span class=o>=</span><span class=p>[(</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span> <span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span> <span class=n>vbt</span><span class=o>.</span><span class=n>timestamp</span><span class=p>(</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;UTC&quot;</span><span class=p>))]</span>
</span><span id=__span-78-13><a id=__codelineno-78-13 name=__codelineno-78-13 href=#__codelineno-78-13></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-78-14><a id=__codelineno-78-14 name=__codelineno-78-14 href=#__codelineno-78-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parquet_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-78-15><a id=__codelineno-78-15 name=__codelineno-78-15 href=#__codelineno-78-15></a><span class=go>Date</span>
</span><span id=__span-78-16><a id=__codelineno-78-16 name=__codelineno-78-16 href=#__codelineno-78-16></a><span class=go>2020-01-01 00:00:00+00:00    13.689083</span>
</span><span id=__span-78-17><a id=__codelineno-78-17 name=__codelineno-78-17 href=#__codelineno-78-17></a><span class=go>2020-01-02 00:00:00+00:00    13.027011</span>
</span><span id=__span-78-18><a id=__codelineno-78-18 name=__codelineno-78-18 href=#__codelineno-78-18></a><span class=go>2020-01-03 00:00:00+00:00    13.660452</span>
</span><span id=__span-78-19><a id=__codelineno-78-19 name=__codelineno-78-19 href=#__codelineno-78-19></a><span class=go>2020-01-04 00:00:00+00:00    13.891512</span>
</span><span id=__span-78-20><a id=__codelineno-78-20 name=__codelineno-78-20 href=#__codelineno-78-20></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span></code></pre></div> <div class="admonition important"> <p class=admonition-title>Important</p> <p>There is an issue with PyArrow starting from version 12.0.0 that makes it impossible to filter by timezone-aware timestamps: <a href=https://github.com/apache/arrow/issues/37355>https://github.com/apache/arrow/issues/37355</a>. This issue is said to be resolved in version 14.0.0.</p> </div> <h3 id=sql_2>SQL<a class=headerlink href=#sql_2 title="Permanent link">&para;</a></h3> <p>The class <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/sql/#vectorbtpro.data.custom.sql.SQLData>SQLData</a> can be updated in two ways: by using the last row number or the last index. The first method works only if you have attached a column with row numbers, the name of this column is known and stored in <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.returned_kwargs>Data.returned_kwargs</a> (this happens automatically), and index-based filtering (<code>start</code> and/or <code>end</code>) is not used. If these conditions are met, this method will be used by default; it will retrieve the last row number from the DataFrame and pass it as <code>start_row</code>.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-79-1><a id=__codelineno-79-1 name=__codelineno-79-1 href=#__codelineno-79-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=s2>&quot;postgresql&quot;</span><span class=p>,</span> <span class=n>attach_row_number</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>if_exists</span><span class=o>=</span><span class=s2>&quot;replace&quot;</span><span class=p>)</span>
</span><span id=__span-79-2><a id=__codelineno-79-2 name=__codelineno-79-2 href=#__codelineno-79-2></a>
</span><span id=__span-79-3><a id=__codelineno-79-3 name=__codelineno-79-3 href=#__codelineno-79-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-79-4><a id=__codelineno-79-4 name=__codelineno-79-4 href=#__codelineno-79-4></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-79-5><a id=__codelineno-79-5 name=__codelineno-79-5 href=#__codelineno-79-5></a><span class=gp>... </span>    <span class=n>end_row</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span><span id=__span-79-6><a id=__codelineno-79-6 name=__codelineno-79-6 href=#__codelineno-79-6></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-79-7><a id=__codelineno-79-7 name=__codelineno-79-7 href=#__codelineno-79-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-79-8><a id=__codelineno-79-8 name=__codelineno-79-8 href=#__codelineno-79-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-79-9><a id=__codelineno-79-9 name=__codelineno-79-9 href=#__codelineno-79-9></a><span class=go>Date</span>
</span><span id=__span-79-10><a id=__codelineno-79-10 name=__codelineno-79-10 href=#__codelineno-79-10></a><span class=go>2022-01-03 00:00:00-05:00    180.190964</span>
</span><span id=__span-79-11><a id=__codelineno-79-11 name=__codelineno-79-11 href=#__codelineno-79-11></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-79-12><a id=__codelineno-79-12 name=__codelineno-79-12 href=#__codelineno-79-12></a><span class=go>2022-01-05 00:00:00-05:00    173.171814</span>
</span><span id=__span-79-13><a id=__codelineno-79-13 name=__codelineno-79-13 href=#__codelineno-79-13></a><span class=go>2022-01-06 00:00:00-05:00    170.281021</span>
</span><span id=__span-79-14><a id=__codelineno-79-14 name=__codelineno-79-14 href=#__codelineno-79-14></a><span class=go>2022-01-07 00:00:00-05:00    170.449341</span>
</span><span id=__span-79-15><a id=__codelineno-79-15 name=__codelineno-79-15 href=#__codelineno-79-15></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span><span id=__span-79-16><a id=__codelineno-79-16 name=__codelineno-79-16 href=#__codelineno-79-16></a>
</span><span id=__span-79-17><a id=__codelineno-79-17 name=__codelineno-79-17 href=#__codelineno-79-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>sql_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>end_row</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-79-18><a id=__codelineno-79-18 name=__codelineno-79-18 href=#__codelineno-79-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-79-19><a id=__codelineno-79-19 name=__codelineno-79-19 href=#__codelineno-79-19></a><span class=go>Date</span>
</span><span id=__span-79-20><a id=__codelineno-79-20 name=__codelineno-79-20 href=#__codelineno-79-20></a><span class=go>2022-01-03 00:00:00-05:00    180.190964</span>
</span><span id=__span-79-21><a id=__codelineno-79-21 name=__codelineno-79-21 href=#__codelineno-79-21></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-79-22><a id=__codelineno-79-22 name=__codelineno-79-22 href=#__codelineno-79-22></a><span class=go>2022-01-05 00:00:00-05:00    173.171814</span>
</span><span id=__span-79-23><a id=__codelineno-79-23 name=__codelineno-79-23 href=#__codelineno-79-23></a><span class=go>2022-01-06 00:00:00-05:00    170.281021</span>
</span><span id=__span-79-24><a id=__codelineno-79-24 name=__codelineno-79-24 href=#__codelineno-79-24></a><span class=go>2022-01-07 00:00:00-05:00    170.449341</span>
</span><span id=__span-79-25><a id=__codelineno-79-25 name=__codelineno-79-25 href=#__codelineno-79-25></a><span class=go>2022-01-10 00:00:00-05:00    170.469131</span>
</span><span id=__span-79-26><a id=__codelineno-79-26 name=__codelineno-79-26 href=#__codelineno-79-26></a><span class=go>2022-01-11 00:00:00-05:00    173.330261</span>
</span><span id=__span-79-27><a id=__codelineno-79-27 name=__codelineno-79-27 href=#__codelineno-79-27></a><span class=go>2022-01-12 00:00:00-05:00    173.775726</span>
</span><span id=__span-79-28><a id=__codelineno-79-28 name=__codelineno-79-28 href=#__codelineno-79-28></a><span class=go>2022-01-13 00:00:00-05:00    170.469131</span>
</span><span id=__span-79-29><a id=__codelineno-79-29 name=__codelineno-79-29 href=#__codelineno-79-29></a><span class=go>2022-01-14 00:00:00-05:00    171.340317</span>
</span><span id=__span-79-30><a id=__codelineno-79-30 name=__codelineno-79-30 href=#__codelineno-79-30></a><span class=go>Freq: B, Name: Close, dtype: float64</span>
</span></code></pre></div> <p>The second approach is enabled if the first approach is disabled and row-based filtering (<code>start_row</code> and/or <code>end_row</code>) is not used. It will extract the last index from <a href=https://vectorbt.pro/pvt_41531c19/api/data/base/#vectorbtpro.data.base.Data.last_index>Data.last_index</a> and pass it as <code>start</code>, regardless of the index data type.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-80-1><a id=__codelineno-80-1 name=__codelineno-80-1 href=#__codelineno-80-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>aapl_data</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=s2>&quot;postgresql&quot;</span><span class=p>,</span> <span class=n>attach_row_number</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>if_exists</span><span class=o>=</span><span class=s2>&quot;replace&quot;</span><span class=p>)</span>
</span><span id=__span-80-2><a id=__codelineno-80-2 name=__codelineno-80-2 href=#__codelineno-80-2></a>
</span><span id=__span-80-3><a id=__codelineno-80-3 name=__codelineno-80-3 href=#__codelineno-80-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-80-4><a id=__codelineno-80-4 name=__codelineno-80-4 href=#__codelineno-80-4></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-80-5><a id=__codelineno-80-5 name=__codelineno-80-5 href=#__codelineno-80-5></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-01-08&quot;</span><span class=p>,</span>
</span><span id=__span-80-6><a id=__codelineno-80-6 name=__codelineno-80-6 href=#__codelineno-80-6></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span>
</span><span id=__span-80-7><a id=__codelineno-80-7 name=__codelineno-80-7 href=#__codelineno-80-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-80-8><a id=__codelineno-80-8 name=__codelineno-80-8 href=#__codelineno-80-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-80-9><a id=__codelineno-80-9 name=__codelineno-80-9 href=#__codelineno-80-9></a><span class=go>Date</span>
</span><span id=__span-80-10><a id=__codelineno-80-10 name=__codelineno-80-10 href=#__codelineno-80-10></a><span class=go>2022-01-03 00:00:00-05:00    180.190964</span>
</span><span id=__span-80-11><a id=__codelineno-80-11 name=__codelineno-80-11 href=#__codelineno-80-11></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-80-12><a id=__codelineno-80-12 name=__codelineno-80-12 href=#__codelineno-80-12></a><span class=go>2022-01-05 00:00:00-05:00    173.171814</span>
</span><span id=__span-80-13><a id=__codelineno-80-13 name=__codelineno-80-13 href=#__codelineno-80-13></a><span class=go>2022-01-06 00:00:00-05:00    170.281021</span>
</span><span id=__span-80-14><a id=__codelineno-80-14 name=__codelineno-80-14 href=#__codelineno-80-14></a><span class=go>2022-01-07 00:00:00-05:00    170.449341</span>
</span><span id=__span-80-15><a id=__codelineno-80-15 name=__codelineno-80-15 href=#__codelineno-80-15></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span><span id=__span-80-16><a id=__codelineno-80-16 name=__codelineno-80-16 href=#__codelineno-80-16></a>
</span><span id=__span-80-17><a id=__codelineno-80-17 name=__codelineno-80-17 href=#__codelineno-80-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>sql_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-01-15&quot;</span><span class=p>)</span>
</span><span id=__span-80-18><a id=__codelineno-80-18 name=__codelineno-80-18 href=#__codelineno-80-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-80-19><a id=__codelineno-80-19 name=__codelineno-80-19 href=#__codelineno-80-19></a><span class=go>Date</span>
</span><span id=__span-80-20><a id=__codelineno-80-20 name=__codelineno-80-20 href=#__codelineno-80-20></a><span class=go>2022-01-03 00:00:00-05:00    180.190964</span>
</span><span id=__span-80-21><a id=__codelineno-80-21 name=__codelineno-80-21 href=#__codelineno-80-21></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-80-22><a id=__codelineno-80-22 name=__codelineno-80-22 href=#__codelineno-80-22></a><span class=go>2022-01-05 00:00:00-05:00    173.171814</span>
</span><span id=__span-80-23><a id=__codelineno-80-23 name=__codelineno-80-23 href=#__codelineno-80-23></a><span class=go>2022-01-06 00:00:00-05:00    170.281021</span>
</span><span id=__span-80-24><a id=__codelineno-80-24 name=__codelineno-80-24 href=#__codelineno-80-24></a><span class=go>2022-01-07 00:00:00-05:00    170.449341</span>
</span><span id=__span-80-25><a id=__codelineno-80-25 name=__codelineno-80-25 href=#__codelineno-80-25></a><span class=go>2022-01-10 00:00:00-05:00    170.469131</span>
</span><span id=__span-80-26><a id=__codelineno-80-26 name=__codelineno-80-26 href=#__codelineno-80-26></a><span class=go>2022-01-11 00:00:00-05:00    173.330261</span>
</span><span id=__span-80-27><a id=__codelineno-80-27 name=__codelineno-80-27 href=#__codelineno-80-27></a><span class=go>2022-01-12 00:00:00-05:00    173.775726</span>
</span><span id=__span-80-28><a id=__codelineno-80-28 name=__codelineno-80-28 href=#__codelineno-80-28></a><span class=go>2022-01-13 00:00:00-05:00    170.469131</span>
</span><span id=__span-80-29><a id=__codelineno-80-29 name=__codelineno-80-29 href=#__codelineno-80-29></a><span class=go>2022-01-14 00:00:00-05:00    171.340317</span>
</span><span id=__span-80-30><a id=__codelineno-80-30 name=__codelineno-80-30 href=#__codelineno-80-30></a><span class=go>Freq: B, Name: Close, dtype: float64</span>
</span></code></pre></div> <p>If the data was originally pulled using a custom query, both approaches will be disabled, and you will need to implement either method manually.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-81-1><a id=__codelineno-81-1 name=__codelineno-81-1 href=#__codelineno-81-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>SQLData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-81-2><a id=__codelineno-81-2 name=__codelineno-81-2 href=#__codelineno-81-2></a><span class=gp>... </span>    <span class=s2>&quot;AAPL&quot;</span><span class=p>,</span> 
</span><span id=__span-81-3><a id=__codelineno-81-3 name=__codelineno-81-3 href=#__codelineno-81-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-81-4><a id=__codelineno-81-4 name=__codelineno-81-4 href=#__codelineno-81-4></a><span class=gp>... </span><span class=s2>        SELECT *</span>
</span><span id=__span-81-5><a id=__codelineno-81-5 name=__codelineno-81-5 href=#__codelineno-81-5></a><span class=gp>... </span><span class=s2>        FROM yf_data.&quot;AAPL&quot; </span>
</span><span id=__span-81-6><a id=__codelineno-81-6 name=__codelineno-81-6 href=#__codelineno-81-6></a><span class=gp>... </span><span class=s2>        WHERE yf_data.&quot;AAPL&quot;.&quot;Date&quot; &gt;= :start AND yf_data.&quot;AAPL&quot;.&quot;Date&quot; &lt; :end</span>
</span><span id=__span-81-7><a id=__codelineno-81-7 name=__codelineno-81-7 href=#__codelineno-81-7></a><span class=gp>... </span><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-81-8><a id=__codelineno-81-8 name=__codelineno-81-8 href=#__codelineno-81-8></a><span class=gp>... </span>    <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>,</span>
</span><span id=__span-81-9><a id=__codelineno-81-9 name=__codelineno-81-9 href=#__codelineno-81-9></a><span class=gp>... </span>    <span class=n>index_col</span><span class=o>=</span><span class=s2>&quot;Date&quot;</span><span class=p>,</span>
</span><span id=__span-81-10><a id=__codelineno-81-10 name=__codelineno-81-10 href=#__codelineno-81-10></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-81-11><a id=__codelineno-81-11 name=__codelineno-81-11 href=#__codelineno-81-11></a><span class=gp>... </span>        <span class=s2>&quot;start&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-01-01&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>),</span>
</span><span id=__span-81-12><a id=__codelineno-81-12 name=__codelineno-81-12 href=#__codelineno-81-12></a><span class=gp>... </span>        <span class=s2>&quot;end&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-01-08&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>)</span>
</span><span id=__span-81-13><a id=__codelineno-81-13 name=__codelineno-81-13 href=#__codelineno-81-13></a><span class=gp>... </span>    <span class=p>}</span>
</span><span id=__span-81-14><a id=__codelineno-81-14 name=__codelineno-81-14 href=#__codelineno-81-14></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-81-15><a id=__codelineno-81-15 name=__codelineno-81-15 href=#__codelineno-81-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-81-16><a id=__codelineno-81-16 name=__codelineno-81-16 href=#__codelineno-81-16></a><span class=go>Date</span>
</span><span id=__span-81-17><a id=__codelineno-81-17 name=__codelineno-81-17 href=#__codelineno-81-17></a><span class=go>2022-01-03 00:00:00-05:00    180.190964</span>
</span><span id=__span-81-18><a id=__codelineno-81-18 name=__codelineno-81-18 href=#__codelineno-81-18></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-81-19><a id=__codelineno-81-19 name=__codelineno-81-19 href=#__codelineno-81-19></a><span class=go>2022-01-05 00:00:00-05:00    173.171814</span>
</span><span id=__span-81-20><a id=__codelineno-81-20 name=__codelineno-81-20 href=#__codelineno-81-20></a><span class=go>2022-01-06 00:00:00-05:00    170.281021</span>
</span><span id=__span-81-21><a id=__codelineno-81-21 name=__codelineno-81-21 href=#__codelineno-81-21></a><span class=go>2022-01-07 00:00:00-05:00    170.449341</span>
</span><span id=__span-81-22><a id=__codelineno-81-22 name=__codelineno-81-22 href=#__codelineno-81-22></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span><span id=__span-81-23><a id=__codelineno-81-23 name=__codelineno-81-23 href=#__codelineno-81-23></a>
</span><span id=__span-81-24><a id=__codelineno-81-24 name=__codelineno-81-24 href=#__codelineno-81-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span> <span class=o>=</span> <span class=n>sql_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-81-25><a id=__codelineno-81-25 name=__codelineno-81-25 href=#__codelineno-81-25></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-81-26><a id=__codelineno-81-26 name=__codelineno-81-26 href=#__codelineno-81-26></a><span class=gp>... </span>        <span class=s2>&quot;start&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-01-08&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>),</span>
</span><span id=__span-81-27><a id=__codelineno-81-27 name=__codelineno-81-27 href=#__codelineno-81-27></a><span class=gp>... </span>        <span class=s2>&quot;end&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2022-01-18&quot;</span><span class=p>,</span> <span class=n>tz</span><span class=o>=</span><span class=s2>&quot;America/New_York&quot;</span><span class=p>)</span>
</span><span id=__span-81-28><a id=__codelineno-81-28 name=__codelineno-81-28 href=#__codelineno-81-28></a><span class=gp>... </span>    <span class=p>}</span>
</span><span id=__span-81-29><a id=__codelineno-81-29 name=__codelineno-81-29 href=#__codelineno-81-29></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-81-30><a id=__codelineno-81-30 name=__codelineno-81-30 href=#__codelineno-81-30></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sql_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-81-31><a id=__codelineno-81-31 name=__codelineno-81-31 href=#__codelineno-81-31></a><span class=go>Date</span>
</span><span id=__span-81-32><a id=__codelineno-81-32 name=__codelineno-81-32 href=#__codelineno-81-32></a><span class=go>2022-01-03 00:00:00-05:00    180.190948</span>
</span><span id=__span-81-33><a id=__codelineno-81-33 name=__codelineno-81-33 href=#__codelineno-81-33></a><span class=go>2022-01-04 00:00:00-05:00    177.904068</span>
</span><span id=__span-81-34><a id=__codelineno-81-34 name=__codelineno-81-34 href=#__codelineno-81-34></a><span class=go>2022-01-05 00:00:00-05:00    173.171844</span>
</span><span id=__span-81-35><a id=__codelineno-81-35 name=__codelineno-81-35 href=#__codelineno-81-35></a><span class=go>2022-01-06 00:00:00-05:00    170.281006</span>
</span><span id=__span-81-36><a id=__codelineno-81-36 name=__codelineno-81-36 href=#__codelineno-81-36></a><span class=go>2022-01-07 00:00:00-05:00    170.449326</span>
</span><span id=__span-81-37><a id=__codelineno-81-37 name=__codelineno-81-37 href=#__codelineno-81-37></a><span class=go>2022-01-10 00:00:00-05:00    170.469116</span>
</span><span id=__span-81-38><a id=__codelineno-81-38 name=__codelineno-81-38 href=#__codelineno-81-38></a><span class=go>2022-01-11 00:00:00-05:00    173.330231</span>
</span><span id=__span-81-39><a id=__codelineno-81-39 name=__codelineno-81-39 href=#__codelineno-81-39></a><span class=go>2022-01-12 00:00:00-05:00    173.775742</span>
</span><span id=__span-81-40><a id=__codelineno-81-40 name=__codelineno-81-40 href=#__codelineno-81-40></a><span class=go>2022-01-13 00:00:00-05:00    170.469116</span>
</span><span id=__span-81-41><a id=__codelineno-81-41 name=__codelineno-81-41 href=#__codelineno-81-41></a><span class=go>2022-01-14 00:00:00-05:00    171.340332</span>
</span><span id=__span-81-42><a id=__codelineno-81-42 name=__codelineno-81-42 href=#__codelineno-81-42></a><span class=go>Freq: B, Name: Close, dtype: float64</span>
</span></code></pre></div> <h3 id=duckdb_2>DuckDB<a class=headerlink href=#duckdb_2 title="Permanent link">&para;</a></h3> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>The previous method (using SQLAlchemy) can also be used to update from a DuckDB database. To do this, you must install the <a href=https://pypi.org/project/duckdb-engine/ >duckdb-engine</a> extension.</p> </div> <p>To update an existing <a href=https://vectorbt.pro/pvt_41531c19/api/data/custom/duckdb/#vectorbtpro.data.custom.duckdb.DuckDBData>DuckDBData</a> with new data, you can use the <code>start</code> and <code>end</code> arguments, or construct a SQL query that returns the desired data range.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-82-1><a id=__codelineno-82-1 name=__codelineno-82-1 href=#__codelineno-82-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-82-2><a id=__codelineno-82-2 name=__codelineno-82-2 href=#__codelineno-82-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-82-3><a id=__codelineno-82-3 name=__codelineno-82-3 href=#__codelineno-82-3></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>,</span>
</span><span id=__span-82-4><a id=__codelineno-82-4 name=__codelineno-82-4 href=#__codelineno-82-4></a><span class=gp>... </span>    <span class=n>schema</span><span class=o>=</span><span class=s2>&quot;yf_data&quot;</span>
</span><span id=__span-82-5><a id=__codelineno-82-5 name=__codelineno-82-5 href=#__codelineno-82-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-82-6><a id=__codelineno-82-6 name=__codelineno-82-6 href=#__codelineno-82-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-82-7><a id=__codelineno-82-7 name=__codelineno-82-7 href=#__codelineno-82-7></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-82-8><a id=__codelineno-82-8 name=__codelineno-82-8 href=#__codelineno-82-8></a><span class=go>Date                                              </span>
</span><span id=__span-82-9><a id=__codelineno-82-9 name=__codelineno-82-9 href=#__codelineno-82-9></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-82-10><a id=__codelineno-82-10 name=__codelineno-82-10 href=#__codelineno-82-10></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-82-11><a id=__codelineno-82-11 name=__codelineno-82-11 href=#__codelineno-82-11></a>
</span><span id=__span-82-12><a id=__codelineno-82-12 name=__codelineno-82-12 href=#__codelineno-82-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>duckdb_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-82-13><a id=__codelineno-82-13 name=__codelineno-82-13 href=#__codelineno-82-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-82-14><a id=__codelineno-82-14 name=__codelineno-82-14 href=#__codelineno-82-14></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-82-15><a id=__codelineno-82-15 name=__codelineno-82-15 href=#__codelineno-82-15></a><span class=go>Date                                              </span>
</span><span id=__span-82-16><a id=__codelineno-82-16 name=__codelineno-82-16 href=#__codelineno-82-16></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-82-17><a id=__codelineno-82-17 name=__codelineno-82-17 href=#__codelineno-82-17></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-82-18><a id=__codelineno-82-18 name=__codelineno-82-18 href=#__codelineno-82-18></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-82-19><a id=__codelineno-82-19 name=__codelineno-82-19 href=#__codelineno-82-19></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p>Alternatively, you can do this manually using a custom SQL query:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-83-1><a id=__codelineno-83-1 name=__codelineno-83-1 href=#__codelineno-83-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-83-2><a id=__codelineno-83-2 name=__codelineno-83-2 href=#__codelineno-83-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-83-3><a id=__codelineno-83-3 name=__codelineno-83-3 href=#__codelineno-83-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-83-4><a id=__codelineno-83-4 name=__codelineno-83-4 href=#__codelineno-83-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-83-5><a id=__codelineno-83-5 name=__codelineno-83-5 href=#__codelineno-83-5></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;BTC-USD&quot; </span>
</span><span id=__span-83-6><a id=__codelineno-83-6 name=__codelineno-83-6 href=#__codelineno-83-6></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &lt; TIMESTAMP &#39;2020-01-03 00:00:00.000000&#39;</span>
</span><span id=__span-83-7><a id=__codelineno-83-7 name=__codelineno-83-7 href=#__codelineno-83-7></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span><span class=p>,</span> 
</span><span id=__span-83-8><a id=__codelineno-83-8 name=__codelineno-83-8 href=#__codelineno-83-8></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-83-9><a id=__codelineno-83-9 name=__codelineno-83-9 href=#__codelineno-83-9></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;ETH-USD&quot; </span>
</span><span id=__span-83-10><a id=__codelineno-83-10 name=__codelineno-83-10 href=#__codelineno-83-10></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &lt; TIMESTAMP &#39;2020-01-03 00:00:00.000000&#39;</span>
</span><span id=__span-83-11><a id=__codelineno-83-11 name=__codelineno-83-11 href=#__codelineno-83-11></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-83-12><a id=__codelineno-83-12 name=__codelineno-83-12 href=#__codelineno-83-12></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-83-13><a id=__codelineno-83-13 name=__codelineno-83-13 href=#__codelineno-83-13></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-83-14><a id=__codelineno-83-14 name=__codelineno-83-14 href=#__codelineno-83-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-83-15><a id=__codelineno-83-15 name=__codelineno-83-15 href=#__codelineno-83-15></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-83-16><a id=__codelineno-83-16 name=__codelineno-83-16 href=#__codelineno-83-16></a><span class=go>Date                                              </span>
</span><span id=__span-83-17><a id=__codelineno-83-17 name=__codelineno-83-17 href=#__codelineno-83-17></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-83-18><a id=__codelineno-83-18 name=__codelineno-83-18 href=#__codelineno-83-18></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-83-19><a id=__codelineno-83-19 name=__codelineno-83-19 href=#__codelineno-83-19></a>
</span><span id=__span-83-20><a id=__codelineno-83-20 name=__codelineno-83-20 href=#__codelineno-83-20></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>duckdb_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-83-21><a id=__codelineno-83-21 name=__codelineno-83-21 href=#__codelineno-83-21></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-83-22><a id=__codelineno-83-22 name=__codelineno-83-22 href=#__codelineno-83-22></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-83-23><a id=__codelineno-83-23 name=__codelineno-83-23 href=#__codelineno-83-23></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;BTC-USD&quot; </span>
</span><span id=__span-83-24><a id=__codelineno-83-24 name=__codelineno-83-24 href=#__codelineno-83-24></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &gt;= TIMESTAMP &#39;2020-01-03 00:00:00.000000&#39;</span>
</span><span id=__span-83-25><a id=__codelineno-83-25 name=__codelineno-83-25 href=#__codelineno-83-25></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span><span class=p>,</span> 
</span><span id=__span-83-26><a id=__codelineno-83-26 name=__codelineno-83-26 href=#__codelineno-83-26></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-83-27><a id=__codelineno-83-27 name=__codelineno-83-27 href=#__codelineno-83-27></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;ETH-USD&quot; </span>
</span><span id=__span-83-28><a id=__codelineno-83-28 name=__codelineno-83-28 href=#__codelineno-83-28></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &gt;= TIMESTAMP &#39;2020-01-03 00:00:00.000000&#39;</span>
</span><span id=__span-83-29><a id=__codelineno-83-29 name=__codelineno-83-29 href=#__codelineno-83-29></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-83-30><a id=__codelineno-83-30 name=__codelineno-83-30 href=#__codelineno-83-30></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-83-31><a id=__codelineno-83-31 name=__codelineno-83-31 href=#__codelineno-83-31></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-83-32><a id=__codelineno-83-32 name=__codelineno-83-32 href=#__codelineno-83-32></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-83-33><a id=__codelineno-83-33 name=__codelineno-83-33 href=#__codelineno-83-33></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-83-34><a id=__codelineno-83-34 name=__codelineno-83-34 href=#__codelineno-83-34></a><span class=go>Date                                              </span>
</span><span id=__span-83-35><a id=__codelineno-83-35 name=__codelineno-83-35 href=#__codelineno-83-35></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-83-36><a id=__codelineno-83-36 name=__codelineno-83-36 href=#__codelineno-83-36></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-83-37><a id=__codelineno-83-37 name=__codelineno-83-37 href=#__codelineno-83-37></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-83-38><a id=__codelineno-83-38 name=__codelineno-83-38 href=#__codelineno-83-38></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p>You can also use prepared statements as shown below:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-84-1><a id=__codelineno-84-1 name=__codelineno-84-1 href=#__codelineno-84-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-84-2><a id=__codelineno-84-2 name=__codelineno-84-2 href=#__codelineno-84-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-84-3><a id=__codelineno-84-3 name=__codelineno-84-3 href=#__codelineno-84-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-84-4><a id=__codelineno-84-4 name=__codelineno-84-4 href=#__codelineno-84-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-84-5><a id=__codelineno-84-5 name=__codelineno-84-5 href=#__codelineno-84-5></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;BTC-USD&quot; </span>
</span><span id=__span-84-6><a id=__codelineno-84-6 name=__codelineno-84-6 href=#__codelineno-84-6></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &gt;= $start AND &quot;Date&quot; &lt; $end</span>
</span><span id=__span-84-7><a id=__codelineno-84-7 name=__codelineno-84-7 href=#__codelineno-84-7></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span><span class=p>,</span> 
</span><span id=__span-84-8><a id=__codelineno-84-8 name=__codelineno-84-8 href=#__codelineno-84-8></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-84-9><a id=__codelineno-84-9 name=__codelineno-84-9 href=#__codelineno-84-9></a><span class=gp>... </span><span class=s2>            SELECT * FROM yf_data.&quot;ETH-USD&quot; </span>
</span><span id=__span-84-10><a id=__codelineno-84-10 name=__codelineno-84-10 href=#__codelineno-84-10></a><span class=gp>... </span><span class=s2>            WHERE &quot;Date&quot; &gt;= $start AND &quot;Date&quot; &lt; $end</span>
</span><span id=__span-84-11><a id=__codelineno-84-11 name=__codelineno-84-11 href=#__codelineno-84-11></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-84-12><a id=__codelineno-84-12 name=__codelineno-84-12 href=#__codelineno-84-12></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-84-13><a id=__codelineno-84-13 name=__codelineno-84-13 href=#__codelineno-84-13></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-84-14><a id=__codelineno-84-14 name=__codelineno-84-14 href=#__codelineno-84-14></a><span class=gp>... </span>        <span class=n>start</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>),</span>
</span><span id=__span-84-15><a id=__codelineno-84-15 name=__codelineno-84-15 href=#__codelineno-84-15></a><span class=gp>... </span>        <span class=n>end</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>)</span>
</span><span id=__span-84-16><a id=__codelineno-84-16 name=__codelineno-84-16 href=#__codelineno-84-16></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-84-17><a id=__codelineno-84-17 name=__codelineno-84-17 href=#__codelineno-84-17></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-84-18><a id=__codelineno-84-18 name=__codelineno-84-18 href=#__codelineno-84-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-84-19><a id=__codelineno-84-19 name=__codelineno-84-19 href=#__codelineno-84-19></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-84-20><a id=__codelineno-84-20 name=__codelineno-84-20 href=#__codelineno-84-20></a><span class=go>Date                                              </span>
</span><span id=__span-84-21><a id=__codelineno-84-21 name=__codelineno-84-21 href=#__codelineno-84-21></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-84-22><a id=__codelineno-84-22 name=__codelineno-84-22 href=#__codelineno-84-22></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-84-23><a id=__codelineno-84-23 name=__codelineno-84-23 href=#__codelineno-84-23></a>
</span><span id=__span-84-24><a id=__codelineno-84-24 name=__codelineno-84-24 href=#__codelineno-84-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>duckdb_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span>
</span><span id=__span-84-25><a id=__codelineno-84-25 name=__codelineno-84-25 href=#__codelineno-84-25></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-84-26><a id=__codelineno-84-26 name=__codelineno-84-26 href=#__codelineno-84-26></a><span class=gp>... </span>        <span class=n>start</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2020-01-03&quot;</span><span class=p>),</span>
</span><span id=__span-84-27><a id=__codelineno-84-27 name=__codelineno-84-27 href=#__codelineno-84-27></a><span class=gp>... </span>        <span class=n>end</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=s2>&quot;2020-01-05&quot;</span><span class=p>)</span>
</span><span id=__span-84-28><a id=__codelineno-84-28 name=__codelineno-84-28 href=#__codelineno-84-28></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-84-29><a id=__codelineno-84-29 name=__codelineno-84-29 href=#__codelineno-84-29></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-84-30><a id=__codelineno-84-30 name=__codelineno-84-30 href=#__codelineno-84-30></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-84-31><a id=__codelineno-84-31 name=__codelineno-84-31 href=#__codelineno-84-31></a><span class=go>Date                                              </span>
</span><span id=__span-84-32><a id=__codelineno-84-32 name=__codelineno-84-32 href=#__codelineno-84-32></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-84-33><a id=__codelineno-84-33 name=__codelineno-84-33 href=#__codelineno-84-33></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-84-34><a id=__codelineno-84-34 name=__codelineno-84-34 href=#__codelineno-84-34></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-84-35><a id=__codelineno-84-35 name=__codelineno-84-35 href=#__codelineno-84-35></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p>Similarly, you can filter based on the dynamically generated row number:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-85-1><a id=__codelineno-85-1 name=__codelineno-85-1 href=#__codelineno-85-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>DuckDBData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-85-2><a id=__codelineno-85-2 name=__codelineno-85-2 href=#__codelineno-85-2></a><span class=gp>... </span>    <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> 
</span><span id=__span-85-3><a id=__codelineno-85-3 name=__codelineno-85-3 href=#__codelineno-85-3></a><span class=gp>... </span>    <span class=n>query</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>key_dict</span><span class=p>({</span>
</span><span id=__span-85-4><a id=__codelineno-85-4 name=__codelineno-85-4 href=#__codelineno-85-4></a><span class=gp>... </span>        <span class=s2>&quot;BTC-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-85-5><a id=__codelineno-85-5 name=__codelineno-85-5 href=#__codelineno-85-5></a><span class=gp>... </span><span class=s2>            SELECT * EXCLUDE (Row) FROM (</span>
</span><span id=__span-85-6><a id=__codelineno-85-6 name=__codelineno-85-6 href=#__codelineno-85-6></a><span class=gp>... </span><span class=s2>                SELECT row_number() OVER () AS &quot;Row&quot;, * FROM yf_data.&quot;BTC-USD&quot;</span>
</span><span id=__span-85-7><a id=__codelineno-85-7 name=__codelineno-85-7 href=#__codelineno-85-7></a><span class=gp>... </span><span class=s2>            )</span>
</span><span id=__span-85-8><a id=__codelineno-85-8 name=__codelineno-85-8 href=#__codelineno-85-8></a><span class=gp>... </span><span class=s2>            WHERE Row &gt;= $start_row AND Row &lt; $end_row</span>
</span><span id=__span-85-9><a id=__codelineno-85-9 name=__codelineno-85-9 href=#__codelineno-85-9></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span><span class=p>,</span> 
</span><span id=__span-85-10><a id=__codelineno-85-10 name=__codelineno-85-10 href=#__codelineno-85-10></a><span class=gp>... </span>        <span class=s2>&quot;ETH-USD&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-85-11><a id=__codelineno-85-11 name=__codelineno-85-11 href=#__codelineno-85-11></a><span class=gp>... </span><span class=s2>            SELECT * EXCLUDE (Row) FROM (</span>
</span><span id=__span-85-12><a id=__codelineno-85-12 name=__codelineno-85-12 href=#__codelineno-85-12></a><span class=gp>... </span><span class=s2>                SELECT row_number() OVER () AS &quot;Row&quot;, * FROM yf_data.&quot;ETH-USD&quot;</span>
</span><span id=__span-85-13><a id=__codelineno-85-13 name=__codelineno-85-13 href=#__codelineno-85-13></a><span class=gp>... </span><span class=s2>            )</span>
</span><span id=__span-85-14><a id=__codelineno-85-14 name=__codelineno-85-14 href=#__codelineno-85-14></a><span class=gp>... </span><span class=s2>            WHERE Row &gt;= $start_row AND Row &lt; $end_row</span>
</span><span id=__span-85-15><a id=__codelineno-85-15 name=__codelineno-85-15 href=#__codelineno-85-15></a><span class=gp>... </span><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-85-16><a id=__codelineno-85-16 name=__codelineno-85-16 href=#__codelineno-85-16></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-85-17><a id=__codelineno-85-17 name=__codelineno-85-17 href=#__codelineno-85-17></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>start_row</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>end_row</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-85-18><a id=__codelineno-85-18 name=__codelineno-85-18 href=#__codelineno-85-18></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-85-19><a id=__codelineno-85-19 name=__codelineno-85-19 href=#__codelineno-85-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-85-20><a id=__codelineno-85-20 name=__codelineno-85-20 href=#__codelineno-85-20></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-85-21><a id=__codelineno-85-21 name=__codelineno-85-21 href=#__codelineno-85-21></a><span class=go>Date                                              </span>
</span><span id=__span-85-22><a id=__codelineno-85-22 name=__codelineno-85-22 href=#__codelineno-85-22></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-85-23><a id=__codelineno-85-23 name=__codelineno-85-23 href=#__codelineno-85-23></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-85-24><a id=__codelineno-85-24 name=__codelineno-85-24 href=#__codelineno-85-24></a>
</span><span id=__span-85-25><a id=__codelineno-85-25 name=__codelineno-85-25 href=#__codelineno-85-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>duckdb_data</span> <span class=o>=</span> <span class=n>duckdb_data</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>params</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>start_row</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>end_row</span><span class=o>=</span><span class=mi>5</span><span class=p>))</span>
</span><span id=__span-85-26><a id=__codelineno-85-26 name=__codelineno-85-26 href=#__codelineno-85-26></a><span class=go>symbol                         BTC-USD     ETH-USD</span>
</span><span id=__span-85-27><a id=__codelineno-85-27 name=__codelineno-85-27 href=#__codelineno-85-27></a><span class=go>Date                                              </span>
</span><span id=__span-85-28><a id=__codelineno-85-28 name=__codelineno-85-28 href=#__codelineno-85-28></a><span class=go>2020-01-01 00:00:00+00:00  7200.174316  130.802002</span>
</span><span id=__span-85-29><a id=__codelineno-85-29 name=__codelineno-85-29 href=#__codelineno-85-29></a><span class=go>2020-01-02 00:00:00+00:00  6985.470215  127.410179</span>
</span><span id=__span-85-30><a id=__codelineno-85-30 name=__codelineno-85-30 href=#__codelineno-85-30></a><span class=go>2020-01-03 00:00:00+00:00  7344.884277  134.171707</span>
</span><span id=__span-85-31><a id=__codelineno-85-31 name=__codelineno-85-31 href=#__codelineno-85-31></a><span class=go>2020-01-04 00:00:00+00:00  7410.656738  135.069366</span>
</span></code></pre></div> <p><a class=md-button href=https://vectorbt.pro/pvt_41531c19/assets/jupytext/documentation/data/local.py.txt target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"/></svg></span> Python code</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Data"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Data </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/remote/ class="md-footer__link md-footer__link--next" aria-label="Next: Remote"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Remote </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/documentation/data/local/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:47 GMT -->
</html>