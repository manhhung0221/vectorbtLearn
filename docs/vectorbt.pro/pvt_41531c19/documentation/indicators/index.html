<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/documentation/indicators/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation on handling indicators in VectorBT PRO"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/documentation/indicators/ rel=canonical><link href=../data/scheduling/index.html rel=prev><link href=development/index.html rel=next><link rel=icon href=../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>Indicators - VectorBTÂ® PRO</title><link rel=stylesheet href=../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/stylesheets/extra.css><link rel=stylesheet href=../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=Indicators><meta property=og:type content=website><meta content=https://vectorbt.pro/documentation/indicators/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Documentation on handling indicators in VectorBT PRO"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#indicators class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBTÂ® PRO" class="md-header__button md-logo" aria-label="VectorBTÂ® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBTÂ® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Indicators </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBTÂ® PRO" class="md-nav__button md-logo" aria-label="VectorBTÂ® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBTÂ® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/fundamentals/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 7a2 2 0 0 0-2 2v8h2v-4h2v4h2V9a2 2 0 0 0-2-2zm0 2h2v2H3m12-.5V9a2 2 0 0 0-2-2H9v10h4a2 2 0 0 0 2-2v-1.5a1.54 1.54 0 0 0-1.5-1.5 1.54 1.54 0 0 0 1.5-1.5M13 15h-2v-2h2zm0-4h-2V9h2m6-2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-1h-2v1h-2V9h2v1h2V9a2 2 0 0 0-2-2Z"/></svg> <span class=md-ellipsis> Fundamentals </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/building-blocks/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 4.15 6.04 7.5 12 10.85l5.96-3.35zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-6.7l-6 3.37v6.71z"/></svg> <span class=md-ellipsis> Building blocks </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/ class=md-nav__link> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5 checked> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> Indicators </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=true> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Indicators </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3 14 .5.07L8.07 9.5a1.95 1.95 0 0 1 .52-1.91c.78-.79 2.04-.79 2.82 0 .53.52.7 1.26.52 1.91l2.57 2.57.5-.07c.18 0 .35 0 .5.07l3.57-3.57C19 8.35 19 8.18 19 8a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2c-.18 0-.35 0-.5-.07l-3.57 3.57c.07.15.07.32.07.5a2 2 0 0 1-2 2 2 2 0 0 1-2-2l.07-.5-2.57-2.57c-.32.07-.68.07-1 0L4.93 15.5 5 16a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2"/></svg> <span class=md-ellipsis> Indicators </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3 14 .5.07L8.07 9.5a1.95 1.95 0 0 1 .52-1.91c.78-.79 2.04-.79 2.82 0 .53.52.7 1.26.52 1.91l2.57 2.57.5-.07c.18 0 .35 0 .5.07l3.57-3.57C19 8.35 19 8.18 19 8a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2c-.18 0-.35 0-.5-.07l-3.57 3.57c.07.15.07.32.07.5a2 2 0 0 1-2 2 2 2 0 0 1-2-2l.07-.5-2.57-2.57c-.32.07-.68.07-1 0L4.93 15.5 5 16a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2"/></svg> <span class=md-ellipsis> Indicators </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pipeline class=md-nav__link> <span class=md-ellipsis> Pipeline </span> </a> </li> <li class=md-nav__item> <a href=#factory class=md-nav__link> <span class=md-ellipsis> Factory </span> </a> <nav class=md-nav aria-label=Factory> <ul class=md-nav__list> <li class=md-nav__item> <a href=#workflow class=md-nav__link> <span class=md-ellipsis> Workflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#factory-methods class=md-nav__link> <span class=md-ellipsis> Factory methods </span> </a> <nav class=md-nav aria-label="Factory methods"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#from-custom-function class=md-nav__link> <span class=md-ellipsis> From custom function </span> </a> </li> <li class=md-nav__item> <a href=#from-apply-function class=md-nav__link> <span class=md-ellipsis> From apply function </span> </a> <nav class=md-nav aria-label="From apply function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-iteration class=md-nav__link> <span class=md-ellipsis> Custom iteration </span> </a> </li> <li class=md-nav__item> <a href=#execution class=md-nav__link> <span class=md-ellipsis> Execution </span> </a> </li> <li class=md-nav__item> <a href=#numba class=md-nav__link> <span class=md-ellipsis> Numba </span> </a> </li> <li class=md-nav__item> <a href=#debugging class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#from-parsing class=md-nav__link> <span class=md-ellipsis> From parsing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#run-methods class=md-nav__link> <span class=md-ellipsis> Run methods </span> </a> </li> <li class=md-nav__item> <a href=#preset-indicators class=md-nav__link> <span class=md-ellipsis> Preset indicators </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/development/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 3c-1.11 0-2 .89-2 2v4c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2m.2 1.5 1.06 1.05L5.27 9.5 2.74 6.95 3.81 5.9l1.47 1.49M4 13c-1.11 0-2 .89-2 2v4c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-4c0-1.11-.89-2-2-2m-4 2h4v4H4m8-14h10v2H12m0 12v-2h10v2m-10-8h10v2H12Z"/></svg> <span class=md-ellipsis> Development </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/analysis/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2 0 1.1.9 2 2 2 1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9 0-1.1-.9-2-2-2m-6 1 .9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11 4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"/></svg> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/parsers/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg> <span class=md-ellipsis> Parsers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/portfolio/ class=md-nav__link> <span class=md-ellipsis> Portfolio </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/to-be-continued/ class=md-nav__link> <span class=md-ellipsis> To be continued... </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-path__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/ class=md-path__link> <span class=md-ellipsis> Indicators </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=indicators><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3 14 .5.07L8.07 9.5a1.95 1.95 0 0 1 .52-1.91c.78-.79 2.04-.79 2.82 0 .53.52.7 1.26.52 1.91l2.57 2.57.5-.07c.18 0 .35 0 .5.07l3.57-3.57C19 8.35 19 8.18 19 8a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2c-.18 0-.35 0-.5-.07l-3.57 3.57c.07.15.07.32.07.5a2 2 0 0 1-2 2 2 2 0 0 1-2-2l.07-.5-2.57-2.57c-.32.07-.68.07-1 0L4.93 15.5 5 16a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2"/></svg></span> Indicators<a class=headerlink href=#indicators title="Permanent link">&para;</a></h1> <p>The <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a> class is one of the most powerful components in the VBT ecosystem. It can wrap any indicator function, making it both parameterizable and analyzable.</p> <h2 id=pipeline>Pipeline<a class=headerlink href=#pipeline title="Permanent link">&para;</a></h2> <p>An indicator is a pipeline that performs the following steps:</p> <ul> <li>Accepts input arrays (for example, opening and closing prices).</li> <li>Accepts parameters either as scalars or arrays (for example, window size).</li> <li>Accepts other relevant arguments and keyword arguments.</li> <li>Broadcasts input arrays against each other or to a specific shape.</li> <li>Broadcasts parameters against each other to create a fixed set of parameter combinations.</li> <li>Calculates output arrays for each parameter combination using the input arrays, producing the same shape (for example, a rolling average).</li> <li>Concatenates the output arrays of all parameter combinations along the columns.</li> <li>Converts the results back to the Pandas format.</li> </ul> <p>Let's manually create an indicator that takes two time series, computes their normalized moving averages, and returns the difference between the two. We will test different shapes as well as parameter combinations to see how broadcasting can be leveraged:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>mov_avg_crossover</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>):</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>broadcast</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>...</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>broadcast</span><span class=p>(</span>  <span class=c1># (2)!</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>to_1d_array</span><span class=p>(</span><span class=n>w1</span><span class=p>),</span> 
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>to_1d_array</span><span class=p>(</span><span class=n>w2</span><span class=p>))</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>...</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>    <span class=n>ts1_mas</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>w1</span><span class=p>:</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>        <span class=n>ts1_mas</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ts1</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>rolling_mean</span><span class=p>(</span><span class=n>w</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts1</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span>    <span class=n>ts2_mas</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>w2</span><span class=p>:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=gp>... </span>        <span class=n>ts2_mas</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ts2</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>rolling_mean</span><span class=p>(</span><span class=n>w</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts2</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=gp>...</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=gp>... </span>    <span class=n>ts1_ma</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>ts1_mas</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># (4)!</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=gp>... </span>    <span class=n>ts2_ma</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>ts2_mas</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=gp>...</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=gp>... </span>    <span class=n>ts1_ma</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>combine_indexes</span><span class=p>((</span>  <span class=c1># (5)!</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=gp>... </span>        <span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>(</span><span class=n>w1</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;ts1_window&quot;</span><span class=p>),</span> 
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=gp>... </span>        <span class=n>ts1</span><span class=o>.</span><span class=n>columns</span><span class=p>))</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=gp>... </span>    <span class=n>ts2_ma</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>combine_indexes</span><span class=p>((</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=gp>... </span>        <span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>(</span><span class=n>w2</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;ts2_window&quot;</span><span class=p>),</span> 
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=gp>... </span>        <span class=n>ts2</span><span class=o>.</span><span class=n>columns</span><span class=p>))</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=gp>...</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>ts1_ma</span><span class=o>.</span><span class=n>vbt</span> <span class=o>-</span> <span class=n>ts2_ma</span>  <span class=c1># (6)!</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>generate_index</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>  <span class=c1># (7)!</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=n>n</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ts1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=n>generate_index</span><span class=p>(</span><span class=mi>7</span><span class=p>))</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ts2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=gp>... </span>    <span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=gp>... </span>    <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=gp>... </span><span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=n>generate_index</span><span class=p>(</span><span class=mi>7</span><span class=p>))</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w1</span> <span class=o>=</span> <span class=mi>2</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w2</span> <span class=o>=</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mov_avg_crossover</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=go>ts1_window                                       2</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=go>ts2_window                   3                   4</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=go>                   a         b         a         b</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=go>2020-01-01       NaN       NaN       NaN       NaN</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=go>2020-01-02       NaN       NaN       NaN       NaN</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=go>2020-01-03 -0.500000  0.083333       NaN       NaN</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=go>2020-01-04 -0.625000  0.075000 -0.875000  0.175000</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=go>2020-01-05  0.011111 -0.183333 -0.100000 -0.100000</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=go>2020-01-06  0.166667 -0.416667  0.166667 -0.416667</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=go>2020-01-07  0.128571 -0.571429  0.228571 -0.821429</span>
</span></code></pre></div> <ol> <li>Both time series are converted to Pandas objects with the same shape: <code>(7, 2)</code>.</li> <li>Window <code>w1</code> becomes <code>[2, 2]</code> and window <code>w2</code> becomes <code>[3, 4]</code>. This results in two parameter combinations: <code>(2, 3)</code> and <code>(2, 4)</code>.</li> <li>Calculate the normalized moving average for each window.</li> <li>Concatenate the DataFrames along the column axis.</li> <li>Create a new column hierarchy using the window values as the top level.</li> <li>Calculate the difference between the two concatenated DataFrames.</li> <li>Helper function to generate a datetime-like index.</li> </ol> <p>Pretty neat! We just built a flexible pipeline that can handle arbitrary input and parameter combinations. The resulting DataFrame shows each column as a specific window combination applied to each column in both <code>ts1</code> and <code>ts2</code>. But is this pipeline user-friendly? <img alt=ðŸ¤” class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f914.svg title=:thinking:><br> Dealing with broadcasting, output concatenation, and column hierarchies makes this process very similar to working with regular Pandas code.</p> <p>The pipeline above can be easily standardized using <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a>. This method conveniently prepares inputs, parameters, and columns. However, you still need to perform the calculation and output concatenation yourself by providing a <code>custom_func</code>.<br> Let's update the example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>custom_func</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>):</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=gp>... </span>    <span class=n>ts1_mas</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>w1</span><span class=p>:</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=gp>... </span>        <span class=n>ts1_mas</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_mean_nb</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts1</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=gp>... </span>    <span class=n>ts2_mas</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>w2</span><span class=p>:</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=gp>... </span>        <span class=n>ts2_mas</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_mean_nb</span><span class=p>(</span><span class=n>ts2</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts2</span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=gp>...</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=gp>... </span>    <span class=n>ts1_ma</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span><span class=n>ts1_mas</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=gp>... </span>    <span class=n>ts2_ma</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span><span class=n>ts2_mas</span><span class=p>)</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=gp>...</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>ts1_ma</span> <span class=o>-</span> <span class=n>ts2_ma</span>  <span class=c1># (3)!</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>outputs</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IndicatorBase</span><span class=o>.</span><span class=n>run_pipeline</span><span class=p>(</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=gp>... </span>    <span class=n>num_ret_outputs</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=gp>... </span>    <span class=n>custom_func</span><span class=o>=</span><span class=n>custom_func</span><span class=p>,</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=gp>... </span>    <span class=n>inputs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>ts1</span><span class=o>=</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=o>=</span><span class=n>ts2</span><span class=p>),</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=gp>... </span>    <span class=n>params</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>w1</span><span class=o>=</span><span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=o>=</span><span class=n>w2</span><span class=p>)</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=gp>&gt;&gt;&gt; </span><span class=n>outputs</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=go>(&lt;vectorbtpro.base.wrapping.ArrayWrapper at 0x7fb188993160&gt;,</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=go> [array([[1, 1],</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=go>         [2, 2],</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=go>         [3, 3],</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=go>         [4, 4],</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=go>         [5, 5],</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=go>         [6, 6],</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=go>         [7, 7]]),</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=go>  array([[5, 2],</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=go>         [4, 3],</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=go>         [3, 4],</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=go>         [2, 5],</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=go>         [3, 4],</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=go>         [4, 3],</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=go>         [5, 2]])],</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=go> array([0, 1, 0, 1]),</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=go> [],</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=go> [array([[        nan,         nan,         nan,         nan],</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=go>         [        nan,         nan,         nan,         nan],</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=go>         [-0.5       ,  0.08333333,         nan,         nan],</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=go>         [-0.625     ,  0.075     , -0.875     ,  0.175     ],</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=go>         [ 0.01111111, -0.18333333, -0.1       , -0.1       ],</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=go>         [ 0.16666667, -0.41666667,  0.16666667, -0.41666667],</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=go>         [ 0.12857143, -0.57142857,  0.22857143, -0.82142857]])],</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=go> [[2, 2], [3, 4]],</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=go> [Int64Index([2, 2, 2, 2], dtype=&#39;int64&#39;),</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=go>  Int64Index([3, 3, 4, 4], dtype=&#39;int64&#39;)],</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=go> [])</span>
</span></code></pre></div> <ol> <li>Use <a href=https://vectorbt.pro/pvt_41531c19/api/generic/nb/rolling/#vectorbtpro.generic.nb.rolling.rolling_mean_nb>rolling_mean_nb</a>.</li> <li>Concatenate the NumPy arrays along the column axis.</li> <li>Calculate the difference between the two concatenated NumPy arrays.</li> </ol> <p>With much less code, we performed the entire calculation using only NumPy and Numbaâ€”a big win! But what is this complex output?</p> <p>This raw output is designed for internal use by VBT and is not intended for direct use. It contains metadata necessary for working with the indicator. Additionally, if you review the source of this function, you will see that it accepts many different arguments. This complexity provides great flexibility, as each argument corresponds to a specific step in the pipeline. But do not worry: we will not use this function directly.</p> <h2 id=factory>Factory<a class=headerlink href=#factory title="Permanent link">&para;</a></h2> <p>Instead, we will use <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a>, which simplifies <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a> by providing a unified interface and various automations. Let's use the factory to wrap our <code>custom_func</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;MADiff&#39;</span><span class=p>,</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w1&#39;</span><span class=p>,</span> <span class=s1>&#39;w2&#39;</span><span class=p>],</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;diff&#39;</span><span class=p>],</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_custom_func</span><span class=p>(</span><span class=n>custom_func</span><span class=p>)</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span> <span class=o>=</span> <span class=n>MADiff</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>)</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span><span class=o>.</span><span class=n>diff</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>madiff_w1                                        2</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>madiff_w2                    3                   4</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>                   a         b         a         b</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>2020-01-01       NaN       NaN       NaN       NaN</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>2020-01-02       NaN       NaN       NaN       NaN</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=go>2020-01-03 -0.500000  0.083333       NaN       NaN</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=go>2020-01-04 -0.625000  0.075000 -0.875000  0.175000</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=go>2020-01-05  0.011111 -0.183333 -0.100000 -0.100000</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=go>2020-01-06  0.166667 -0.416667  0.166667 -0.416667</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=go>2020-01-07  0.128571 -0.571429  0.228571 -0.821429</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p><code>vbt.IF</code> is a shortcut for <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a>.</p> </div> <p>As you can see, <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a> takes the specification for our indicator and creates a Python class that knows how to communicate with <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a> and manage and format its results. Specifically, it attaches the class method <code>MADiff.run</code>, which works just like <code>custom_func</code> but prepares and forwards all arguments to <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a> under the hood. Whenever we call the <code>run</code> method, it initializes and returns an instance of <code>MADiff</code> containing all the input and output data.</p> <p>You may wonder: <em>"Why does the factory create a class instead of a function? Wouldn't an indicator function be more intuitive?"</em> If you have read <a href=https://vectorbt.pro/pvt_41531c19/documentation/building-blocks>Building blocks</a>, you may already be familiar with the class <a href=https://vectorbt.pro/pvt_41531c19/api/generic/analyzable/#vectorbtpro.generic.analyzable.Analyzable>Analyzable</a>, the main class for analyzing data. The indicator class created by the factory is a subclass of <a href=https://vectorbt.pro/pvt_41531c19/api/generic/analyzable/#vectorbtpro.generic.analyzable.Analyzable>Analyzable</a>, so you not only get access to the output, but also to many methods for analyzing this output. For example, the factory automatically provides <code>crossed_above</code>, <code>cross_below</code>, <code>stats</code>, and many other methods for each input and output in the indicator:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span><span class=o>.</span><span class=n>diff_stats</span><span class=p>(</span><span class=n>column</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>))</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=go>Start        2020-01-01 00:00:00</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=go>End          2020-01-07 00:00:00</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=go>Period           7 days 00:00:00</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=go>Count                          5</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=go>Mean                    -0.16373</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=go>Std                     0.371153</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=go>Min                       -0.625</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=go>Median                  0.011111</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=go>Max                     0.166667</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=go>Min Index    2020-01-04 00:00:00</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=go>Max Index    2020-01-06 00:00:00</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=go>Name: (2, 3, a), dtype: object</span>
</span></code></pre></div> <h3 id=workflow>Workflow<a class=headerlink href=#workflow title="Permanent link">&para;</a></h3> <p>The main goal of <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a> is to create a stand-alone indicator class that includes a <code>run</code> method for executing the indicator. To accomplish this, it needs to know what inputs, parameters, and outputs to expect. You can provide this information using <code>input_names</code>, <code>param_names</code>, and other arguments in the constructor:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff_factory</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;MADiff&#39;</span><span class=p>,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w1&#39;</span><span class=p>,</span> <span class=s1>&#39;w2&#39;</span><span class=p>],</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;diff&#39;</span><span class=p>],</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff_factory</span><span class=o>.</span><span class=n>Indicator</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>vectorbtpro.indicators.factory.MADiff</span>
</span></code></pre></div> <p>When initialized, it builds the skeleton of our indicator class, which is a type of <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase>IndicatorBase</a>. This is accessible via <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.Indicator>IndicatorFactory.Indicator</a>. Even though the factory creates the constructor for this class and attaches various properties and methods, we cannot run the indicator yet:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff_factory</span><span class=o>.</span><span class=n>Indicator</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=go>NotImplementedError: </span>
</span></code></pre></div> <p>This is because we still need to provide the calculation function. There are several methods starting with the prefix <code>with_</code>. The fundamental method, used by all others, is <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_custom_func>IndicatorFactory.with_custom_func</a> (which we used earlier). It overrides the abstract <code>run</code> method to execute the indicator using <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a> and returns a fully functional indicator class:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff</span> <span class=o>=</span> <span class=n>MADiff_factory</span><span class=o>.</span><span class=n>with_custom_func</span><span class=p>(</span><span class=n>custom_func</span><span class=p>)</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=go>vectorbtpro.indicators.factory.MADiff</span>
</span></code></pre></div> <p>The calculation function has now been successfully attached, so we can run this indicator!</p> <h2 id=factory-methods>Factory methods<a class=headerlink href=#factory-methods title="Permanent link">&para;</a></h2> <p>Factory methods come in two forms: instance and class methods. Instance methods, with the prefix <code>with_</code>, such as <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_custom_func>IndicatorFactory.with_custom_func</a>, require instantiating the indicator factory. This means you need to call <code>vbt.IF(...)</code> and manually provide the required information as we did with <code>MADiff</code>.<br> Class methods, with the prefix <code>from_</code>, such as <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.from_expr>IndicatorFactory.from_expr</a>, can (semi-)automatically parse the required information.</p> <h3 id=from-custom-function>From custom function<a class=headerlink href=#from-custom-function title="Permanent link">&para;</a></h3> <p>The method <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_custom_func>IndicatorFactory.with_custom_func</a> accepts a "custom function", which is the most flexible way to define an indicator. However, with this flexibility comes added responsibility: as the user, you must handle iterating through parameters, manage caching, and concatenate columns for each parameter combination (usually using <a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a>). You must also ensure that each output array has the correct number of columns, equal to the number of columns in the input arrays multiplied by the number of parameter combinations. In addition, your custom function receives commands passed by the pipeline, so it is up to you to properly process those commands.</p> <p>For example, if your custom function needs the index and columns alongside the NumPy arrays, you can instruct the pipeline to pass the wrapper by setting <code>pass_wrapper=True</code> in <code>with_custom_func</code>. This and all other arguments are forwarded directly to <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a>, which handles communication with your custom function.</p> <h3 id=from-apply-function>From apply function<a class=headerlink href=#from-apply-function title="Permanent link">&para;</a></h3> <p>The method <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_apply_func>IndicatorFactory.with_apply_func</a> greatly simplifies indicator development. It creates a <code>custom_func</code> that handles caching, iteration over parameters with <a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a>, output concatenation with <a href=https://vectorbt.pro/pvt_41531c19/api/base/reshaping/#vectorbtpro.base.reshaping.column_stack>column_stack</a>, and then passes this function to <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_custom_func>IndicatorFactory.with_custom_func</a>. Your only task is to write an "apply function," which accepts a single parameter combination and performs the calculation. The resulting outputs are automatically concatenated along the column axis.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>An apply function has mostly the same signature as a custom function, but the parameters are individual values instead of multiple values.</p> </div> <p>Let's create our indicator using an apply function:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>apply_func</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>):</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=gp>... </span>    <span class=n>ts1_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_mean_nb</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>w1</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts1</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=gp>... </span>    <span class=n>ts2_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_mean_nb</span><span class=p>(</span><span class=n>ts2</span><span class=p>,</span> <span class=n>w2</span><span class=p>)</span> <span class=o>/</span> <span class=n>ts2</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>ts1_ma</span> <span class=o>-</span> <span class=n>ts2_ma</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;MADiff&#39;</span><span class=p>,</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w1&#39;</span><span class=p>,</span> <span class=s1>&#39;w2&#39;</span><span class=p>],</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;diff&#39;</span><span class=p>],</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_apply_func</span><span class=p>(</span><span class=n>apply_func</span><span class=p>)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span> <span class=o>=</span> <span class=n>MADiff</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>)</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span><span class=o>.</span><span class=n>diff</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>madiff_w1                                        2</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=go>madiff_w2                    3                   4</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=go>                   a         b         a         b</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=go>2020-01-01       NaN       NaN       NaN       NaN</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=go>2020-01-02       NaN       NaN       NaN       NaN</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=go>2020-01-03 -0.500000  0.083333       NaN       NaN</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=go>2020-01-04 -0.625000  0.075000 -0.875000  0.175000</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=go>2020-01-05  0.011111 -0.183333 -0.100000 -0.100000</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=go>2020-01-06  0.166667 -0.416667  0.166667 -0.416667</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=go>2020-01-07  0.128571 -0.571429  0.228571 -0.821429</span>
</span></code></pre></div> <p>That's all you need! Under the hood, the code creates a custom function that iterates over all parameter combinations and calls <code>apply_func</code> on each one. If you print <code>ts1</code>, <code>ts2</code>, <code>w1</code>, and <code>w2</code>, you would see that <code>ts1</code> and <code>ts2</code> remain the same, while <code>w1</code> and <code>w2</code> are now individual values. This design allows you to simplify your code, working with one set of parameters at a time without worrying about multiple parameter combinations.</p> <p>Another advantage of this method is that apply functions are a natural fit in VBT <img alt=ðŸ’ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f412.svg title=:monkey:>, so you can use most regular and Numba-compiled functions that take two-dimensional NumPy arrays directly as apply functions. For example, let's build an indicator for rolling covariance:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;RollCov&#39;</span><span class=p>,</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w&#39;</span><span class=p>],</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;rollcov&#39;</span><span class=p>],</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_apply_func</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_cov_nb</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rollcov</span> <span class=o>=</span> <span class=n>RollCov</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rollcov</span><span class=o>.</span><span class=n>rollcov</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=go>rollcov_w            2                   3</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=go>               a     b         a         b</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=go>2020-01-01   NaN   NaN       NaN       NaN</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=go>2020-01-02 -0.25  0.25       NaN       NaN</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=go>2020-01-03 -0.25  0.25 -0.666667  0.666667</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=go>2020-01-04 -0.25  0.25 -0.666667  0.666667</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=go>2020-01-05  0.25 -0.25  0.000000  0.000000</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=go>2020-01-06  0.25 -0.25  0.666667 -0.666667</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=go>2020-01-07  0.25 -0.25  0.666667 -0.666667</span>
</span></code></pre></div> <p>In this example, both input arrays and the window parameter are passed directly to <a href=https://vectorbt.pro/pvt_41531c19/api/generic/nb/rolling/#vectorbtpro.generic.nb.rolling.rolling_cov_nb>rolling_cov_nb</a>.</p> <h4 id=custom-iteration>Custom iteration<a class=headerlink href=#custom-iteration title="Permanent link">&para;</a></h4> <p>We can easily emulate <code>apply_func</code> using <code>custom_func</code> and <a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a>. For example, if we need the index of the current iteration or want access to all parameter combinations:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro.base.combining</span><span class=w> </span><span class=kn>import</span> <span class=n>apply_and_concat</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>apply_func</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>  <span class=c1># (1)!</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_cov_nb</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>custom_func</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w</span><span class=p>):</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>apply_and_concat</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>w</span><span class=p>),</span> <span class=n>apply_func</span><span class=p>,</span> <span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;RollCov&#39;</span><span class=p>,</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w&#39;</span><span class=p>],</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;rollcov&#39;</span><span class=p>],</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_custom_func</span><span class=p>(</span><span class=n>custom_func</span><span class=p>)</span>
</span></code></pre></div> <ol> <li>Unlike our previous <code>apply_func</code>, an apply function used in <a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a> must take the index of the iteration and select the parameters manually using this index.</li> <li><a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a> requires the number of iterations, which is simply the length of any parameter array.</li> </ol> <p>The same result can be achieved using <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.with_apply_func>IndicatorFactory.with_apply_func</a> and <code>select_params=False</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;RollCov&#39;</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w&#39;</span><span class=p>],</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;rollcov&#39;</span><span class=p>],</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_apply_func</span><span class=p>(</span><span class=n>apply_func</span><span class=p>,</span> <span class=n>select_params</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></code></pre></div> <h4 id=execution>Execution<a class=headerlink href=#execution title="Permanent link">&para;</a></h4> <p>Since the same apply function is called multiple timesâ€”once per parameter combinationâ€”we can use one of VBT's preset execution engines to distribute these calls sequentially (default), across multiple threads, or across multiple processes. In fact, the function <a href=https://vectorbt.pro/pvt_41531c19/api/base/combining/#vectorbtpro.base.combining.apply_and_concat>apply_and_concat</a>, which is used to iterate over all parameter combinations, handles this automatically by forwarding all calls to the executor function <a href=https://vectorbt.pro/pvt_41531c19/api/utils/execution/#vectorbtpro.utils.execution.execute>execute</a>. By passing keyword arguments in <code>execute_kwargs</code>, we can define how to distribute these calls. For example, to disable the progress bar:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;RollCov&#39;</span><span class=p>,</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w&#39;</span><span class=p>],</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;rollcov&#39;</span><span class=p>],</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_apply_func</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>rolling_cov_nb</span><span class=p>)</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=gp>... </span>    <span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=gp>... </span>    <span class=n>execute_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>show_progress</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Iteration 100/100</p> </div> </div> </p> <h4 id=numba>Numba<a class=headerlink href=#numba title="Permanent link">&para;</a></h4> <p>When the apply function is Numba-compiled, the indicator factory also makes the parameter selection function Numba-compiled (with the GIL released), allowing for multithreading. This behavior can be disabled by setting <code>jit_select_params</code> to False. The keyword arguments used to configure the Numba-compiled function can be supplied via the <code>jit_kwargs</code> argument.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Setting <code>jit_select_params</code> will remove all keyword arguments since variable keyword arguments are not supported by Numba (yet). To pass keyword arguments to the apply function anyway, set <code>remove_kwargs</code> to False or use the <code>kwargs_as_args</code> argument, which specifies which keyword arguments should be supplied as (variable) positional arguments.</p> </div> <p>Additionally, you can explicitly set <code>jitted_loop</code> to True to loop over each parameter combination in a Numba loop. This can speed up iteration for shallow inputs with a large number of columns, but may slow it down otherwise.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>In this case, the execution will be performed by Numba, so you cannot use <code>execute_kwargs</code> anymore.</p> </div> <h4 id=debugging>Debugging<a class=headerlink href=#debugging title="Permanent link">&para;</a></h4> <p>Sometimes it is not clear which arguments are being passed to <code>apply_func</code>. Debugging in this case is usually simple: just replace your apply function with a generic function that accepts variable arguments and prints them.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>apply_func</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>arg</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>args</span><span class=p>):</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=gp>... </span>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;arg </span><span class=si>{}</span><span class=s2>: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>arg</span><span class=p>)))</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=gp>... </span>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;kwarg </span><span class=si>{}</span><span class=s2>: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=nb>type</span><span class=p>(</span><span class=n>v</span><span class=p>)))</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=gp>... </span>    <span class=k>raise</span> <span class=ne>NotImplementedError</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>RollCov</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=p>(</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=gp>... </span>    <span class=n>class_name</span><span class=o>=</span><span class=s1>&#39;RollCov&#39;</span><span class=p>,</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=gp>... </span>    <span class=n>input_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;ts1&#39;</span><span class=p>,</span> <span class=s1>&#39;ts2&#39;</span><span class=p>],</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=gp>... </span>    <span class=n>param_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;w&#39;</span><span class=p>],</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=gp>... </span>    <span class=n>output_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;rollcov&#39;</span><span class=p>],</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>with_apply_func</span><span class=p>(</span><span class=n>apply_func</span><span class=p>,</span> <span class=n>select_params</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=gp>&gt;&gt;&gt; </span><span class=k>try</span><span class=p>:</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=gp>... </span>    <span class=n>RollCov</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=n>some_arg</span><span class=o>=</span><span class=s2>&quot;some_value&quot;</span><span class=p>)</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=gp>... </span><span class=k>except</span><span class=p>:</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=gp>... </span>    <span class=k>pass</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=go>arg 0: &lt;class &#39;int&#39;&gt;</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=go>arg 1: &lt;class &#39;numpy.ndarray&#39;&gt;</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=go>arg 2: &lt;class &#39;numpy.ndarray&#39;&gt;</span>
</span><span id=__span-12-22><a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=go>arg 3: &lt;class &#39;list&#39;&gt;</span>
</span><span id=__span-12-23><a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a><span class=go>kwarg some_arg: &lt;class &#39;str&#39;&gt;</span>
</span></code></pre></div> <h3 id=from-parsing>From parsing<a class=headerlink href=#from-parsing title="Permanent link">&para;</a></h3> <p>Parsers offer the most convenient way to build indicator classes. For example, there are dedicated parser methods for third-party technical analysis packages that can automatically or semi-automatically derive the specification of each indicator. Additionally, a powerful expression parser can help you avoid writing complex Python functions for simple indicators. Let's <em>express</em> our indicator as an expression:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>MADiff</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>IF</span><span class=o>.</span><span class=n>from_expr</span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=gp>... </span>    <span class=s2>&quot;rolling_mean(@in_ts1, @p_w1) / @in_ts1 - rolling_mean(@in_ts2, @p_w2) / @in_ts2&quot;</span><span class=p>,</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=gp>... </span>    <span class=n>factory_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>class_name</span><span class=o>=</span><span class=s2>&quot;MADiff&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span> <span class=o>=</span> <span class=n>MADiff</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts1</span><span class=p>,</span> <span class=n>ts2</span><span class=p>,</span> <span class=n>w1</span><span class=p>,</span> <span class=n>w2</span><span class=p>)</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>madiff</span><span class=o>.</span><span class=n>out</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=go>madiff_w1                                        2</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=go>madiff_w2                    3                   4</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=go>                   a         b         a         b</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=go>2020-01-01       NaN       NaN       NaN       NaN</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=go>2020-01-02       NaN       NaN       NaN       NaN</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=go>2020-01-03 -0.500000  0.083333       NaN       NaN</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=go>2020-01-04 -0.625000  0.075000 -0.875000  0.175000</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=go>2020-01-05  0.011111 -0.183333 -0.100000 -0.100000</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=go>2020-01-06  0.166667 -0.416667  0.166667 -0.416667</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=go>2020-01-07  0.128571 -0.571429  0.228571 -0.821429</span>
</span></code></pre></div> <ol> <li>We can still override any information passed to the factory class.</li> </ol> <p>Notice that we did not need to call <code>vbt.IF(...)</code>? <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory.from_expr>IndicatorFactory.from_expr</a> is a class method that parses <code>input_names</code> and other information directly from the expression and creates a factory instance using only this information. It is amazing how we reduced our first implementation with <code>mov_avg_crossover</code> to just this while still enjoying all the features, right?</p> <h2 id=run-methods>Run methods<a class=headerlink href=#run-methods title="Permanent link">&para;</a></h2> <p>Once you have built your indicator class, it is time to run it. The primary method for executing an indicator is the class method <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run>IndicatorBase.run</a>. This method accepts positional and keyword arguments based on the specifications provided to the <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorFactory>IndicatorFactory</a>. These arguments include input arrays, in-place output arrays, and parameters. Any additional arguments are forwarded down to <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_pipeline>IndicatorBase.run_pipeline</a>, which may use them to set up the pipeline or forward them further down to the custom function and, if provided, the apply function.</p> <p>To see which arguments the <code>run</code> method accepts, use <a href=https://vectorbt.pro/pvt_41531c19/api/utils/formatting/#vectorbtpro.utils.formatting.phelp>phelp</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>phelp</span><span class=p>(</span><span class=n>MADiff</span><span class=o>.</span><span class=n>run</span><span class=p>)</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=go>MADiff.run(</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=go>    ts1,</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=go>    ts2,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=go>    w1,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=go>    w2,</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=go>    short_name=&#39;madiff&#39;,</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=go>    hide_params=None,</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=go>    hide_default=True,</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=go>    **kwargs</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=go>):</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=go>    Run `MADiff` indicator.</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=go>    * Inputs: `ts1`, `ts2`</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=go>    * Parameters: `w1`, `w2`</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=go>    * Outputs: `out`</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=go>    Pass a list of parameter names as `hide_params` to hide their column levels.</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=go>    Set `hide_default` to False to show the column levels of the parameters with a default value.</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=go>    Other keyword arguments are passed to `MADiff.run_pipeline`.</span>
</span></code></pre></div> <p>We can see that <code>MADiff.run</code> takes two input time series, <code>ts1</code> and <code>ts2</code>, two parameters, <code>w1</code> and <code>w2</code>, and produces a single output time series, <code>diff</code>. When you call the class method, it runs the indicator and returns a new instance of <code>MADiff</code> with all data ready for analysis. Specifically, you can access the output as a regular instance attribute, <code>MADiff.diff</code>.</p> <p>The second method for running indicators is <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/factory/#vectorbtpro.indicators.factory.IndicatorBase.run_combs>IndicatorBase.run_combs</a>. This method accepts the same inputs as the method above, but computes all combinations of the given parameters using a combinatorial function and returns <strong>multiple</strong> indicator instances that can be combined with each other. This is useful for comparing multiple indicators of the <strong>same type</strong> but with different parameters, such as when testing a moving average crossover, which involves two <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/custom/ma/#vectorbtpro.indicators.custom.ma.MA>MA</a> instances applied to the same time series:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ts</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_ma</span><span class=p>,</span> <span class=n>slow_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run_combs</span><span class=p>(</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=gp>... </span>    <span class=n>ts</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> 
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=gp>... </span>    <span class=n>short_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;fast_ma&#39;</span><span class=p>,</span> <span class=s1>&#39;slow_ma&#39;</span><span class=p>])</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_above</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=go>fast_ma_window             2      3</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=go>slow_ma_window      3      4      4</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=go>0               False  False  False</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=go>1               False  False  False</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=go>2               False  False  False</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=go>3               False  False  False</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=go>4                True   True  False</span>
</span></code></pre></div> <p>In the example above, <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/custom/ma/#vectorbtpro.indicators.custom.MA.ma.run_combs>MA.run_combs</a> generated the combinations of <code>window</code> using <a href=https://docs.python.org/3/library/itertools.html#itertools.combinations>itertools.combinations</a> with <code>r=2</code>. The first set of window combinations was passed to the first instance, and the second set to the second instance. The same example can be replicated using only the <code>run</code> method:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>windows</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_windows</span><span class=p>,</span> <span class=n>slow_windows</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=n>combinations</span><span class=p>(</span><span class=n>windows</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts</span><span class=p>,</span> <span class=n>fast_windows</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s1>&#39;fast_ma&#39;</span><span class=p>)</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>slow_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>ts</span><span class=p>,</span> <span class=n>slow_windows</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s1>&#39;slow_ma&#39;</span><span class=p>)</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_above</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=go>fast_ma_window             2      3</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=go>slow_ma_window      3      4      4</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=go>0               False  False  False</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=go>1               False  False  False</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=go>2               False  False  False</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=go>3               False  False  False</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=go>4                True   True  False</span>
</span></code></pre></div> <p>The main advantage of a single <code>run_combs</code> call over multiple <code>run</code> calls is that it does not need to re-compute each combination, thanks to smart caching.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>run_combs</code> should only be used for combining multiple indicators. To test multiple parameter combinations, use <code>run</code> and provide parameters as lists.</p> </div> <h2 id=preset-indicators>Preset indicators<a class=headerlink href=#preset-indicators title="Permanent link">&para;</a></h2> <p>VBT provides a collection of preset, fully Numba-compiled indicators (such as <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/custom/atr/#vectorbtpro.indicators.custom.atr.ATR>ATR</a>) that benefit from manual caching, extension, and plotting. You can use them as inspiration for how to create indicators in a classic yet efficient way.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>VBT uses SMA and EMA, while other technical analysis libraries and TradingView use Wilder's method. There is no right or wrong method. See <a href=https://www.macroption.com/atr-calculation/ >different smoothing methods</a>.</p> </div> <p><a class=md-button href=https://vectorbt.pro/pvt_41531c19/assets/jupytext/documentation/indicators/index.py.txt target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"/></svg></span> Python code</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/documentation/data/scheduling/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Scheduling"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Scheduling </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/documentation/indicators/development/ class="md-footer__link md-footer__link--next" aria-label="Next: Development"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Development </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/documentation/indicators/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:57 GMT -->
</html>