<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/integrations/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Learn about integrations with third-party portfolio optimization libraries in VectorBT PRO"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/tutorials/portfolio-optimization/integrations/ rel=canonical><link href=../index.html rel=prev><link href=../dynamic/index.html rel=next><link rel=icon href=../../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>Integrations - VectorBT® PRO</title><link rel=stylesheet href=../../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=Integrations><meta property=og:type content=website><meta content=https://vectorbt.pro/tutorials/portfolio-optimization/integrations/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Learn about integrations with third-party portfolio optimization libraries in VectorBT PRO"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#integrations class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-header__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBT® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Integrations </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-nav__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBT® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/basic-rsi/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3.5 18.5 6-6 4 4L22 6.92 20.59 5.5l-7.09 8-4-4L2 17z"/></svg> <span class=md-ellipsis> Basic RSI strategy </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/superfast-supertrend/ class=md-nav__link> <span class=md-ellipsis> SuperFast SuperTrend </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/signal-development/generation/ class=md-nav__link> <span class=md-ellipsis> Signal development </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/stop-signals/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 23h-2V1h2zm-4-4H5V5h4V3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h4zM19 7v2h2V7zm0-2h2a2 2 0 0 0-2-2zm2 10h-2v2h2zm-2-4v2h2v-2zm-2-8h-2v2h2zm2 18c1.11 0 2-.89 2-2h-2zm-2-2h-2v2h2z"/></svg> <span class=md-ellipsis> Stop signals </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/mtf-analysis/ class=md-nav__link> <span class=md-ellipsis> MTF analysis </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7 checked> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> Portfolio optimization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=true> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Portfolio optimization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 21H2V3h2v16h2v-2h4v2h2v-3h4v3h2v-2h4zm-4-7h4v2h-4zm-6-8h4v3h-4zm4 9h-4v-5h4zM6 10h4v2H6zm4 6H6v-3h4z"/></svg> <span class=md-ellipsis> Portfolio optimization </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 21H2V3h2v16h2v-2h4v2h2v-3h4v3h2v-2h4zm-4-7h4v2h-4zm-6-8h4v3h-4zm4 9h-4v-5h4zM6 10h4v2H6zm4 6H6v-3h4z"/></svg> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/integrations/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 21H2V3h2v16h2v-2h4v2h2v-3h4v3h2v-2h4zm-4-7h4v2h-4zm-6-8h4v3h-4zm4 9h-4v-5h4zM6 10h4v2H6zm4 6H6v-3h4z"/></svg> <span class=md-ellipsis> Integrations </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pyportfolioopt class=md-nav__link> <span class=md-ellipsis> PyPortfolioOpt </span> </a> <nav class=md-nav aria-label=PyPortfolioOpt> <ul class=md-nav__list> <li class=md-nav__item> <a href=#parsing class=md-nav__link> <span class=md-ellipsis> Parsing </span> </a> </li> <li class=md-nav__item> <a href=#auto-optimization class=md-nav__link> <span class=md-ellipsis> Auto-optimization </span> </a> </li> <li class=md-nav__item> <a href=#argument-groups class=md-nav__link> <span class=md-ellipsis> Argument groups </span> </a> </li> <li class=md-nav__item> <a href=#periodically class=md-nav__link> <span class=md-ellipsis> Periodically </span> </a> <nav class=md-nav aria-label=Periodically> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manually class=md-nav__link> <span class=md-ellipsis> Manually </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#riskfolio-lib class=md-nav__link> <span class=md-ellipsis> Riskfolio-Lib </span> </a> <nav class=md-nav aria-label=Riskfolio-Lib> <ul class=md-nav__list> <li class=md-nav__item> <a href=#parsing_1 class=md-nav__link> <span class=md-ellipsis> Parsing </span> </a> </li> <li class=md-nav__item> <a href=#auto-optimization_1 class=md-nav__link> <span class=md-ellipsis> Auto-optimization </span> </a> </li> <li class=md-nav__item> <a href=#periodically_1 class=md-nav__link> <span class=md-ellipsis> Periodically </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#universal-portfolios class=md-nav__link> <span class=md-ellipsis> Universal portfolios </span> </a> <nav class=md-nav aria-label="Universal portfolios"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-algorithm class=md-nav__link> <span class=md-ellipsis> Custom algorithm </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/dynamic/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 21H2V3h2v16h2v-2h4v2h2v-3h4v3h2v-2h4zm-4-7h4v2h-4zm-6-8h4v3h-4zm4 9h-4v-5h4zM6 10h4v2H6zm4 6H6v-3h4z"/></svg> <span class=md-ellipsis> Dynamic </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/pairs-trading/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 6.92 20.59 5.5l-2.85 3.22C15.68 6.4 12.83 5 9.61 5 6.72 5 4.07 6.16 2 8l1.42 1.42C5.12 7.93 7.27 7 9.61 7c2.74 0 5.09 1.26 6.77 3.24L13.5 13.5l-4-4L2 17l1.5 1.5 6-6 4 4 4.05-4.57c.75 1.35 1.25 2.9 1.45 4.57h2c-.22-2.32-.95-4.41-2.04-6.16z"/></svg> <span class=md-ellipsis> Pairs trading </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/patterns/ class=md-nav__link> <span class=md-ellipsis> Patterns and projections </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/cross-validation/ class=md-nav__link> <span class=md-ellipsis> Cross-validation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/more-tutorials/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10.6 13.4a1 1 0 0 1-1.4 1.4 4.8 4.8 0 0 1 0-7l3.5-3.6a5.1 5.1 0 0 1 7.1 0 5.1 5.1 0 0 1 0 7.1l-1.5 1.5a6.4 6.4 0 0 0-.4-2.4l.5-.5a3.2 3.2 0 0 0 0-4.3 3.2 3.2 0 0 0-4.3 0l-3.5 3.6a2.9 2.9 0 0 0 0 4.2M23 18v2h-3v3h-2v-3h-3v-2h3v-3h2v3m-3.8-4.3a4.8 4.8 0 0 0-1.4-4.5 1 1 0 0 0-1.4 1.4 2.9 2.9 0 0 1 0 4.2l-3.5 3.6a3.2 3.2 0 0 1-4.3 0 3.2 3.2 0 0 1 0-4.3l.5-.4a7.3 7.3 0 0 1-.4-2.5l-1.5 1.5a5.1 5.1 0 0 0 0 7.1 5.1 5.1 0 0 0 7.1 0l1.8-1.8a6 6 0 0 1 3.1-4.3"/></svg> <span class=md-ellipsis> More tutorials </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/to-be-continued/ class=md-nav__link> <span class=md-ellipsis> To be continued... </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-path__link> <span class=md-ellipsis> Tutorials </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/ class=md-path__link> <span class=md-ellipsis> Portfolio optimization </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=integrations><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 21H2V3h2v16h2v-2h4v2h2v-3h4v3h2v-2h4zm-4-7h4v2h-4zm-6-8h4v3h-4zm4 9h-4v-5h4zM6 10h4v2H6zm4 6H6v-3h4z"/></svg></span> Integrations<a class=headerlink href=#integrations title="Permanent link">&para;</a></h1> <p><a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer>PortfolioOptimizer</a> integrates smoothly with a variety of third-party libraries.</p> <h2 id=pyportfolioopt>PyPortfolioOpt<a class=headerlink href=#pyportfolioopt title="Permanent link">&para;</a></h2> <blockquote> <p><a href=https://pyportfolioopt.readthedocs.io/en/latest/ >PyPortfolioOpt</a> is a library that implements portfolio optimization methods, including classical efficient frontier techniques and Black-Litterman allocation, as well as more recent developments such as shrinkage and Hierarchical Risk Parity. It also includes some experimental features, like exponentially-weighted covariance matrices.</p> </blockquote> <p>PyPortfolioOpt offers a variety of optimization methods that are very straightforward to use. The optimization process consists of several distinct steps, though some steps may be skipped depending on the optimizer:</p> <ul> <li>Calculate the expected returns (mostly found in <code>pfopt.expected_returns</code>).</li> <li>Calculate the covariance matrix (mostly found in <code>pfopt.risk_models</code>).</li> <li>Initialize and configure an optimizer (mainly located in <code>pypfopt.efficient_frontier</code>, with the base class in <code>pypfopt.base_optimizer</code>), including objectives, constraints, and the target.</li> <li>Run the optimizer to obtain the weights.</li> <li>Optionally, convert the weights into a discrete allocation.</li> </ul> <p>For example, here is how to use mean-variance optimization (MVO) to maximize the Sharpe ratio:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.expected_returns</span><span class=w> </span><span class=kn>import</span> <span class=n>mean_historical_return</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.risk_models</span><span class=w> </span><span class=kn>import</span> <span class=n>CovarianceShrinkage</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.efficient_frontier</span><span class=w> </span><span class=kn>import</span> <span class=n>EfficientFrontier</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>expected_returns</span> <span class=o>=</span> <span class=n>mean_historical_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>cov_matrix</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>optimizer</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>expected_returns</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=p>)</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>optimizer</span><span class=o>.</span><span class=n>max_sharpe</span><span class=p>()</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.1166001117223088),</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=go>             (&#39;BNBUSDT&#39;, 0.0),</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=go>             (&#39;BTCUSDT&#39;, 0.0),</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=go>             (&#39;ETHUSDT&#39;, 0.8833998882776911),</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=go>             (&#39;XRPUSDT&#39;, 0.0)])</span>
</span></code></pre></div> <h3 id=parsing>Parsing<a class=headerlink href=#parsing title="Permanent link">&para;</a></h3> <p>Thanks to the excellent work of <a class="magiclink magiclink-github magiclink-mention" href=https://github.com/robertmartin8 title="GitHub User: robertmartin8">@robertmartin8</a>, almost the entire PyPortfolioOpt codebase (with a few exceptions) uses consistent argument and function names. This consistency allows us to create a semantic graph of functions that serve as inputs to other functions. Why is this important? Because the user only needs to provide the target function (for example, <code>EfficientFrontier.max_sharpe</code>), and we can automatically determine the entire call stack using just the pricing data! If the user provides any additional keyword arguments, we can identify which functions in the stack accept those arguments and pass them automatically.</p> <p>For the example above, the graph looks like this:</p> <pre class=mermaid><code>flowchart TD;
    id1["User"]
    id2["mean_historical_return"]
    id3["CovarianceShrinkage.ledoit_wolf"]
    id4["EfficientFrontier"]

    id1 --&gt;|"prices"| id2;
    id1 --&gt;|"prices"| id3;
    id2 --&gt;|"expected_returns"| id4;
    id3 --&gt;|"cov_matrix"| id4;</code></pre> <p>(Reload the page if the diagram does not appear.)</p> <p>This is where VBT comes into play. It implements the function <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_pypfopt_func_kwargs>resolve_pypfopt_func_kwargs</a>, which accepts any PyPortfolioOpt function and resolves its arguments. When a user-provided argument matches an argument in the function's signature, it marks that argument to be passed to the function. Let's try this out with expected returns:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro.portfolio.pfopt.base</span><span class=w> </span><span class=kn>import</span> <span class=n>resolve_pypfopt_func_kwargs</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>phelp</span><span class=p>(</span><span class=n>mean_historical_return</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=go>mean_historical_return(</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=go>    prices,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=go>    returns_data=False,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=go>    compounding=True,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=go>    frequency=252,</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=go>    log_returns=False</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=go>):</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=go>    Calculate annualised mean (daily) historical return from input (daily) asset prices.</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=go>    Use ``compounding`` to toggle between the default geometric mean (CAGR) and the</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=go>    arithmetic mean.</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>prettify</span><span class=p>(</span><span class=n>resolve_pypfopt_func_kwargs</span><span class=p>(</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=gp>... </span>    <span class=n>mean_historical_return</span><span class=p>,</span> 
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>  <span class=c1># (2)!</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=gp>... </span>    <span class=n>freq</span><span class=o>=</span><span class=s2>&quot;1h&quot;</span><span class=p>,</span>  <span class=c1># (3)!</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=gp>... </span>    <span class=n>year_freq</span><span class=o>=</span><span class=s2>&quot;365d&quot;</span><span class=p>,</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=gp>... </span>    <span class=n>other_arg</span><span class=o>=</span><span class=mi>100</span>  <span class=c1># (4)!</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=gp>... </span><span class=p>)))</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=go>{</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=go>    &#39;prices&#39;: &lt;pandas.core.frame.DataFrame object at 0x7f9428052c50 of shape (8767, 5)&gt;,</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=go>    &#39;returns_data&#39;: False,</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=go>    &#39;compounding&#39;: True,</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=go>    &#39;frequency&#39;: 8760.0,</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=go>    &#39;log_returns&#39;: False</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=go>}</span>
</span></code></pre></div> <ol> <li>Shows which arguments the function accepts.</li> <li>Present in the signature, so it will be passed.</li> <li>Translates <code>freq</code> and <code>year_freq</code> into <code>frequency</code> (number of time periods in a year), so it will be passed.</li> <li>Not present in the signature, so it will be ignored.</li> </ol> <p>Now, let's try this with <code>EfficientFrontier</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>prettify</span><span class=p>(</span><span class=n>resolve_pypfopt_func_kwargs</span><span class=p>(</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=gp>... </span>    <span class=n>EfficientFrontier</span><span class=p>,</span> 
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=gp>... </span><span class=p>)))</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>{</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=go>    &#39;expected_returns&#39;: &lt;pandas.core.series.Series object at 0x7f9479927128 of shape (5,)&gt;,</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>    &#39;cov_matrix&#39;: &lt;pandas.core.frame.DataFrame object at 0x7f94280528d0 of shape (5, 5)&gt;,</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>    &#39;weight_bounds&#39;: (</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>        0,</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>        1</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>    ),</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>    &#39;solver&#39;: None,</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>    &#39;verbose&#39;: False,</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>    &#39;solver_options&#39;: None</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=go>}</span>
</span></code></pre></div> <p>Here, VBT automatically resolved the <code>expected_returns</code> and <code>cov_matrix</code> arguments using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_pypfopt_expected_returns>resolve_pypfopt_expected_returns</a> and <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_pypfopt_cov_matrix>resolve_pypfopt_cov_matrix</a>, respectively. If you provide these arguments manually, VBT will use them directly. You can also specify these arguments as strings to select the function used to generate them:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>prettify</span><span class=p>(</span><span class=n>resolve_pypfopt_func_kwargs</span><span class=p>(</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=gp>... </span>    <span class=n>EfficientFrontier</span><span class=p>,</span> 
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;ema_historical_return&quot;</span><span class=p>,</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=gp>... </span>    <span class=n>cov_matrix</span><span class=o>=</span><span class=s2>&quot;sample_cov&quot;</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=gp>... </span><span class=p>)))</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=go>{</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=go>    &#39;expected_returns&#39;: &lt;pandas.core.series.Series object at 0x7f9428044cf8 of shape (5,)&gt;,</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=go>    &#39;cov_matrix&#39;: &lt;pandas.core.frame.DataFrame object at 0x7f942805bf60 of shape (5, 5)&gt;,</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=go>    &#39;weight_bounds&#39;: (</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=go>        0,</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=go>        1</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=go>    ),</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=go>    &#39;solver&#39;: None,</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=go>    &#39;verbose&#39;: False,</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=go>    &#39;solver_options&#39;: None</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=go>}</span>
</span></code></pre></div> <h3 id=auto-optimization>Auto-optimization<a class=headerlink href=#auto-optimization title="Permanent link">&para;</a></h3> <p>With the ability to parse and resolve function arguments, VBT provides the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pypfopt_optimize>pypfopt_optimize</a> function, which takes user requirements and translates them into function calls. Using this function is very straightforward!</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span><span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=go>{&#39;ADAUSDT&#39;: 0.1166,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go> &#39;BNBUSDT&#39;: 0.0,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go> &#39;BTCUSDT&#39;: 0.0,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go> &#39;ETHUSDT&#39;: 0.8834,</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go> &#39;XRPUSDT&#39;: 0.0}</span>
</span></code></pre></div> <p>In summary, <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pypfopt_optimize>pypfopt_optimize</a> first resolves the optimizer by calling <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_pypfopt_optimizer>resolve_pypfopt_optimizer</a>. This triggers a cascade of argument resolutions by <a href=#parsing>parsing arguments</a>, including computing expected returns and the risk model for asset risk. It then adds objectives and constraints to the optimizer instance. Finally, it calls the target metric method (such as <code>max_sharpe</code>) or a custom convex or non-convex objective using the same parsing procedure as shown above. If desired, it can also convert continuous weights into discrete ones using <code>DiscreteAllocation</code>.</p> <p>Since multiple PyPortfolioOpt functions may require the same argument that needs to be pre-computed, <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pypfopt_optimize>pypfopt_optimize</a> uses a built-in caching mechanism. If any provided arguments are not used, it issues a warning (which you can hide by setting <code>silence_warnings</code> to True) stating that the argument was not required by any function in the call stack.</p> <p>Below, we will demonstrate different optimizations using both PyPortfolioOpt and VBT. For example, optimizing a long/short portfolio to minimize total variance:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>PyPortfolioOpt</label><label for=__tabbed_1_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>S</span><span class=p>,</span> <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>min_volatility</span><span class=p>()</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, -0.01118),</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=go>             (&#39;BNBUSDT&#39;, 0.09695),</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=go>             (&#39;BTCUSDT&#39;, 0.9624),</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=go>             (&#39;ETHUSDT&#39;, -0.10516),</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=go>             (&#39;XRPUSDT&#39;, 0.05699)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=gp>... </span>    <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;min_volatility&quot;</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=go>{&#39;ADAUSDT&#39;: -0.01118,</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=go> &#39;BNBUSDT&#39;: 0.09695,</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=go> &#39;BTCUSDT&#39;: 0.9624,</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=go> &#39;ETHUSDT&#39;: -0.10516,</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=go> &#39;XRPUSDT&#39;: 0.05699}</span>
</span></code></pre></div> <ol> <li><code>CovarianceShrinkage.ledoit_wolf</code> and <code>EfficientFrontier</code> are used by default.</li> </ol> </div> </div> </div> <p>Optimizing a portfolio to maximize the Sharpe ratio, with direction constraints:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=go>directions = [&quot;long&quot;, &quot;long&quot;, &quot;long&quot;, &quot;short&quot;, &quot;short&quot;]</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=go>direction_mapper = dict(zip(data.symbols, directions))</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>PyPortfolioOpt</label><label for=__tabbed_2_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.expected_returns</span><span class=w> </span><span class=kn>import</span> <span class=n>capm_return</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>capm_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>,</span> <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=gp>&gt;&gt;&gt; </span><span class=k>for</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>direction</span> <span class=ow>in</span> <span class=n>direction_mapper</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=gp>... </span>    <span class=n>idx</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>symbols</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=gp>... </span>    <span class=k>if</span> <span class=n>direction</span> <span class=o>==</span> <span class=s2>&quot;long&quot;</span><span class=p>:</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=gp>... </span>        <span class=n>ef</span><span class=o>.</span><span class=n>add_constraint</span><span class=p>(</span><span class=k>lambda</span> <span class=n>w</span><span class=p>,</span> <span class=n>_idx</span><span class=o>=</span><span class=n>idx</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>_idx</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=gp>... </span>    <span class=k>if</span> <span class=n>direction</span> <span class=o>==</span> <span class=s2>&quot;short&quot;</span><span class=p>:</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=gp>... </span>        <span class=n>ef</span><span class=o>.</span><span class=n>add_constraint</span><span class=p>(</span><span class=k>lambda</span> <span class=n>w</span><span class=p>,</span> <span class=n>_idx</span><span class=o>=</span><span class=n>idx</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>_idx</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>max_sharpe</span><span class=p>()</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=go>OrderedDict([(&#39;BTCUSDT&#39;, 0.26614),</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=go>             (&#39;ETHUSDT&#39;, 0.433),</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=go>             (&#39;BNBUSDT&#39;, 0.30086),</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=go>             (&#39;XRPUSDT&#39;, 0.0),</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=go>             (&#39;ADAUSDT&#39;, 0.0)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>constraints</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=gp>&gt;&gt;&gt; </span><span class=k>for</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>direction</span> <span class=ow>in</span> <span class=n>direction_mapper</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=gp>... </span>    <span class=n>idx</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>symbols</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=gp>... </span>    <span class=k>if</span> <span class=n>direction</span> <span class=o>==</span> <span class=s2>&quot;long&quot;</span><span class=p>:</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=gp>... </span>        <span class=n>constraints</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=k>lambda</span> <span class=n>w</span><span class=p>,</span> <span class=n>_idx</span><span class=o>=</span><span class=n>idx</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>_idx</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=gp>... </span>    <span class=k>if</span> <span class=n>direction</span> <span class=o>==</span> <span class=s2>&quot;short&quot;</span><span class=p>:</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=gp>... </span>        <span class=n>constraints</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=k>lambda</span> <span class=n>w</span><span class=p>,</span> <span class=n>_idx</span><span class=o>=</span><span class=n>idx</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>_idx</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;capm_return&quot;</span><span class=p>,</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=gp>... </span>    <span class=n>cov_matrix</span><span class=o>=</span><span class=s2>&quot;ledoit_wolf&quot;</span><span class=p>,</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;max_sharpe&quot;</span><span class=p>,</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=gp>... </span>    <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=gp>... </span>    <span class=n>constraints</span><span class=o>=</span><span class=n>constraints</span><span class=p>,</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=go>{&#39;BTCUSDT&#39;: 0.26614,</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=go> &#39;ETHUSDT&#39;: 0.433,</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=go> &#39;BNBUSDT&#39;: 0.30086,</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=go> &#39;XRPUSDT&#39;: 0.0,</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=go> &#39;ADAUSDT&#39;: 0.0}</span>
</span></code></pre></div> </div> </div> </div> <p>Optimizing a portfolio to maximize the Sharpe ratio with sector constraints:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sector_mapper</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=gp>... </span>    <span class=s2>&quot;ADAUSDT&quot;</span><span class=p>:</span> <span class=s2>&quot;DeFi&quot;</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=gp>... </span>    <span class=s2>&quot;BNBUSDT&quot;</span><span class=p>:</span> <span class=s2>&quot;DeFi&quot;</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=gp>... </span>    <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>:</span> <span class=s2>&quot;Payment&quot;</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=gp>... </span>    <span class=s2>&quot;ETHUSDT&quot;</span><span class=p>:</span> <span class=s2>&quot;DeFi&quot;</span><span class=p>,</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=gp>... </span>    <span class=s2>&quot;XRPUSDT&quot;</span><span class=p>:</span> <span class=s2>&quot;Payment&quot;</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=gp>... </span><span class=p>}</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sector_lower</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=gp>... </span>    <span class=s2>&quot;DeFi&quot;</span><span class=p>:</span> <span class=mf>0.75</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=gp>... </span><span class=p>}</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sector_upper</span> <span class=o>=</span> <span class=p>{}</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>PyPortfolioOpt</label><label for=__tabbed_3_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>capm_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_sector_constraints</span><span class=p>(</span><span class=n>sector_mapper</span><span class=p>,</span> <span class=n>sector_lower</span><span class=p>,</span> <span class=n>sector_upper</span><span class=p>)</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>adausdt_index</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>tickers</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=s2>&quot;ADAUSDT&quot;</span><span class=p>)</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_constraint</span><span class=p>(</span><span class=k>lambda</span> <span class=n>w</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>adausdt_index</span><span class=p>]</span> <span class=o>==</span> <span class=mf>0.10</span><span class=p>)</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>max_sharpe</span><span class=p>()</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.1),</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=go>             (&#39;BNBUSDT&#39;, 0.2772),</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=go>             (&#39;BTCUSDT&#39;, 0.0524),</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=go>             (&#39;ETHUSDT&#39;, 0.3728),</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=go>             (&#39;XRPUSDT&#39;, 0.1976)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>adausdt_index</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>sector_mapper</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=s2>&quot;ADAUSDT&quot;</span><span class=p>)</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;capm_return&quot;</span><span class=p>,</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=gp>... </span>    <span class=n>sector_mapper</span><span class=o>=</span><span class=n>sector_mapper</span><span class=p>,</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=gp>... </span>    <span class=n>sector_lower</span><span class=o>=</span><span class=n>sector_lower</span><span class=p>,</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=gp>... </span>    <span class=n>sector_upper</span><span class=o>=</span><span class=n>sector_upper</span><span class=p>,</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=gp>... </span>    <span class=n>constraints</span><span class=o>=</span><span class=p>[</span><span class=k>lambda</span> <span class=n>w</span><span class=p>:</span> <span class=n>w</span><span class=p>[</span><span class=n>adausdt_index</span><span class=p>]</span> <span class=o>==</span> <span class=mf>0.10</span><span class=p>]</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=go>{&#39;ADAUSDT&#39;: 0.1,</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=go> &#39;BNBUSDT&#39;: 0.2772,</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=go> &#39;BTCUSDT&#39;: 0.0524,</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=go> &#39;ETHUSDT&#39;: 0.3728,</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=go> &#39;XRPUSDT&#39;: 0.1976}</span>
</span></code></pre></div> <ol> <li><code>CovarianceShrinkage.ledoit_wolf</code>, <code>EfficientFrontier</code>, and <code>EfficientFrontier.max_sharpe</code> are used by default.</li> </ol> </div> </div> </div> <p>Optimizing a portfolio to maximize return for a given risk, with sector constraints and an L2 regularization objective:</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>PyPortfolioOpt</label><label for=__tabbed_4_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.objective_functions</span><span class=w> </span><span class=kn>import</span> <span class=n>L2_reg</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>capm_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_sector_constraints</span><span class=p>(</span><span class=n>sector_mapper</span><span class=p>,</span> <span class=n>sector_lower</span><span class=p>,</span> <span class=n>sector_upper</span><span class=p>)</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_objective</span><span class=p>(</span><span class=n>L2_reg</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>efficient_risk</span><span class=p>(</span><span class=mf>0.15</span><span class=p>)</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.26004),</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=go>             (&#39;BNBUSDT&#39;, 0.24466),</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=go>             (&#39;BTCUSDT&#39;, 0.10778),</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=go>             (&#39;ETHUSDT&#39;, 0.2453),</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=go>             (&#39;XRPUSDT&#39;, 0.14222)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;capm_return&quot;</span><span class=p>,</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=gp>... </span>    <span class=n>sector_mapper</span><span class=o>=</span><span class=n>sector_mapper</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=gp>... </span>    <span class=n>sector_lower</span><span class=o>=</span><span class=n>sector_lower</span><span class=p>,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=gp>... </span>    <span class=n>sector_upper</span><span class=o>=</span><span class=n>sector_upper</span><span class=p>,</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=gp>... </span>    <span class=n>objectives</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;L2_reg&quot;</span><span class=p>],</span>  <span class=c1># (2)!</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=gp>... </span>    <span class=n>gamma</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>  <span class=c1># (3)!</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;efficient_risk&quot;</span><span class=p>,</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=gp>... </span>    <span class=n>target_volatility</span><span class=o>=</span><span class=mf>0.15</span>  <span class=c1># (4)!</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=go>{&#39;ADAUSDT&#39;: 0.26004,</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=go> &#39;BNBUSDT&#39;: 0.24466,</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=go> &#39;BTCUSDT&#39;: 0.10778,</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=go> &#39;ETHUSDT&#39;: 0.2453,</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=go> &#39;XRPUSDT&#39;: 0.14222}</span>
</span></code></pre></div> <ol> <li><code>CovarianceShrinkage.ledoit_wolf</code> and <code>EfficientFrontier</code> are used by default.</li> <li>Objectives can be provided as attributes of the <code>pypfopt.objective_functions</code> module.</li> <li>Recognized as an argument of the objective function.</li> <li>Recognized as an argument of the target metric method.</li> </ol> </div> </div> </div> <p>Optimizing along the mean-semivariance frontier:</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>PyPortfolioOpt</label><label for=__tabbed_5_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt</span><span class=w> </span><span class=kn>import</span> <span class=n>EfficientSemivariance</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.expected_returns</span><span class=w> </span><span class=kn>import</span> <span class=n>returns_from_prices</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>capm_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>returns</span> <span class=o>=</span> <span class=n>returns_from_prices</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>returns</span> <span class=o>=</span> <span class=n>returns</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>es</span> <span class=o>=</span> <span class=n>EfficientSemivariance</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>returns</span><span class=p>)</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>es</span><span class=o>.</span><span class=n>efficient_return</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>es</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.0),</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=go>             (&#39;BNBUSDT&#39;, 0.0),</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=go>             (&#39;BTCUSDT&#39;, 1.0),</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=go>             (&#39;ETHUSDT&#39;, 0.0),</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=go>             (&#39;XRPUSDT&#39;, 0.0)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;capm_return&quot;</span><span class=p>,</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=gp>... </span>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;efficient_semivariance&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;efficient_return&quot;</span><span class=p>,</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=gp>... </span>    <span class=n>target_return</span><span class=o>=</span><span class=mf>0.01</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=go>{&#39;ADAUSDT&#39;: 0.0, &#39;BNBUSDT&#39;: 0.0, &#39;BTCUSDT&#39;: 1, &#39;ETHUSDT&#39;: 0.0, &#39;XRPUSDT&#39;: 0.0}</span>
</span></code></pre></div> <ol> <li>The second argument of <code>EfficientSemivariance</code> is <code>returns</code>, which VBT recognizes and automatically converts from prices.</li> </ol> </div> </div> </div> <p>Minimizing transaction costs:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>initial_weights</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>symbols</span><span class=p>)]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>symbols</span><span class=p>))</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>PyPortfolioOpt</label><label for=__tabbed_6_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.objective_functions</span><span class=w> </span><span class=kn>import</span> <span class=n>transaction_cost</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>mean_historical_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_objective</span><span class=p>(</span><span class=n>transaction_cost</span><span class=p>,</span> <span class=n>w_prev</span><span class=o>=</span><span class=n>initial_weights</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mf>0.001</span><span class=p>)</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>add_objective</span><span class=p>(</span><span class=n>L2_reg</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=mf>0.05</span><span class=p>)</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>min_volatility</span><span class=p>()</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.16025),</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=go>             (&#39;BNBUSDT&#39;, 0.2),</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=go>             (&#39;BTCUSDT&#39;, 0.27241),</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=go>             (&#39;ETHUSDT&#39;, 0.2),</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=go>             (&#39;XRPUSDT&#39;, 0.16734)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=gp>... </span>    <span class=n>objectives</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;transaction_cost&quot;</span><span class=p>,</span> <span class=s2>&quot;L2_reg&quot;</span><span class=p>],</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=gp>... </span>    <span class=n>w_prev</span><span class=o>=</span><span class=n>initial_weights</span><span class=p>,</span> 
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=gp>... </span>    <span class=n>k</span><span class=o>=</span><span class=mf>0.001</span><span class=p>,</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=gp>... </span>    <span class=n>gamma</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;min_volatility&quot;</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=go>{&#39;ADAUSDT&#39;: 0.16025,</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=go> &#39;BNBUSDT&#39;: 0.2,</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=go> &#39;BTCUSDT&#39;: 0.27241,</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=go> &#39;ETHUSDT&#39;: 0.2,</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=go> &#39;XRPUSDT&#39;: 0.16734}</span>
</span></code></pre></div> <ol> <li><code>mean_historical_return</code>, <code>CovarianceShrinkage.ledoit_wolf</code>, and <code>EfficientFrontier</code> are used by default.</li> </ol> </div> </div> </div> <p>Custom convex objective:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>cvxpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>cp</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>logarithmic_barrier_objective</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mf>0.1</span><span class=p>):</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=gp>... </span>    <span class=n>log_sum</span> <span class=o>=</span> <span class=n>cp</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>cp</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>w</span><span class=p>))</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=gp>... </span>    <span class=n>var</span> <span class=o>=</span> <span class=n>cp</span><span class=o>.</span><span class=n>quad_form</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=p>)</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>var</span> <span class=o>-</span> <span class=n>k</span> <span class=o>*</span> <span class=n>log_sum</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>PyPortfolioOpt</label><label for=__tabbed_7_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>mean_historical_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>,</span> <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>))</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>convex_objective</span><span class=p>(</span><span class=n>logarithmic_barrier_objective</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=o>=</span><span class=n>S</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mf>0.001</span><span class=p>)</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.12214),</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=go>             (&#39;BNBUSDT&#39;, 0.22175),</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=go>             (&#39;BTCUSDT&#39;, 0.3),</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=go>             (&#39;ETHUSDT&#39;, 0.21855),</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=go>             (&#39;XRPUSDT&#39;, 0.13756)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=gp>... </span>    <span class=n>weight_bounds</span><span class=o>=</span><span class=p>(</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>),</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=gp>... </span>    <span class=n>k</span><span class=o>=</span><span class=mf>0.001</span><span class=p>,</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=n>logarithmic_barrier_objective</span>  <span class=c1># (2)!</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=go>{&#39;ADAUSDT&#39;: 0.12214,</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=go> &#39;BNBUSDT&#39;: 0.22175,</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=go> &#39;BTCUSDT&#39;: 0.3,</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=go> &#39;ETHUSDT&#39;: 0.21855,</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=go> &#39;XRPUSDT&#39;: 0.13756}</span>
</span></code></pre></div> <ol> <li><code>mean_historical_return</code>, <code>CovarianceShrinkage.ledoit_wolf</code>, and <code>EfficientFrontier</code> are used by default.</li> <li>The second argument of <code>logarithmic_barrier_objective</code> is <code>cov_matrix</code>, which VBT recognizes and calculates automatically (or retrieves from cache).</li> </ol> </div> </div> </div> <p>Custom non-convex objective:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>deviation_risk_parity</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=p>):</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=gp>... </span>    <span class=n>cov_matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>cov_matrix</span><span class=p>)</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=gp>... </span>    <span class=n>n</span> <span class=o>=</span> <span class=n>cov_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=gp>... </span>    <span class=n>rp</span> <span class=o>=</span> <span class=p>(</span><span class=n>w</span> <span class=o>*</span> <span class=p>(</span><span class=n>cov_matrix</span> <span class=o>@</span> <span class=n>w</span><span class=p>))</span> <span class=o>/</span> <span class=n>cp</span><span class=o>.</span><span class=n>quad_form</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>cov_matrix</span><span class=p>)</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>cp</span><span class=o>.</span><span class=n>sum_squares</span><span class=p>(</span><span class=n>rp</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>/</span> <span class=n>n</span><span class=p>)</span><span class=o>.</span><span class=n>value</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><input id=__tabbed_8_2 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=__tabbed_8_1>PyPortfolioOpt</label><label for=__tabbed_8_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mu</span> <span class=o>=</span> <span class=n>mean_historical_return</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>mu</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>nonconvex_objective</span><span class=p>(</span><span class=n>deviation_risk_parity</span><span class=p>,</span> <span class=n>ef</span><span class=o>.</span><span class=n>cov_matrix</span><span class=p>)</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.17421),</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=go>             (&#39;BNBUSDT&#39;, 0.19933),</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=go>             (&#39;BTCUSDT&#39;, 0.2515),</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=go>             (&#39;ETHUSDT&#39;, 0.1981),</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=go>             (&#39;XRPUSDT&#39;, 0.17686)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=n>deviation_risk_parity</span><span class=p>,</span>  <span class=c1># (2)!</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=gp>... </span>    <span class=n>target_is_convex</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=go>{&#39;ADAUSDT&#39;: 0.17421,</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=go> &#39;BNBUSDT&#39;: 0.19933,</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=go> &#39;BTCUSDT&#39;: 0.2515,</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=go> &#39;ETHUSDT&#39;: 0.1981,</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=go> &#39;XRPUSDT&#39;: 0.17686}</span>
</span></code></pre></div> <ol> <li><code>mean_historical_return</code>, <code>CovarianceShrinkage.ledoit_wolf</code>, and <code>EfficientFrontier</code> are used by default.</li> <li>The second argument of <code>deviation_risk_parity</code> is <code>cov_matrix</code>, which VBT recognizes and calculates automatically (or retrieves from cache).</li> </ol> </div> </div> </div> <p>Black-Litterman Allocation (<a href=https://pyportfolioopt.readthedocs.io/en/latest/BlackLitterman.html>read more</a>):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sp500_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=gp>... </span>    <span class=s2>&quot;^GSPC&quot;</span><span class=p>,</span> 
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> 
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>market_caps</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span> <span class=o>*</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Volume&quot;</span><span class=p>)</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>viewdict</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=gp>... </span>    <span class=s2>&quot;ADAUSDT&quot;</span><span class=p>:</span> <span class=mf>0.20</span><span class=p>,</span> 
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=gp>... </span>    <span class=s2>&quot;BNBUSDT&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mf>0.30</span><span class=p>,</span> 
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=gp>... </span>    <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=gp>... </span>    <span class=s2>&quot;ETHUSDT&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>,</span> 
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=gp>... </span>    <span class=s2>&quot;XRPUSDT&quot;</span><span class=p>:</span> <span class=mf>0.15</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=gp>... </span><span class=p>}</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><input id=__tabbed_9_2 name=__tabbed_9 type=radio><div class=tabbed-labels><label for=__tabbed_9_1>PyPortfolioOpt</label><label for=__tabbed_9_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt.black_litterman</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=gp>... </span>    <span class=n>market_implied_risk_aversion</span><span class=p>,</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=gp>... </span>    <span class=n>market_implied_prior_returns</span><span class=p>,</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=gp>... </span>    <span class=n>BlackLittermanModel</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>S</span> <span class=o>=</span> <span class=n>CovarianceShrinkage</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>ledoit_wolf</span><span class=p>()</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta</span> <span class=o>=</span> <span class=n>market_implied_risk_aversion</span><span class=p>(</span><span class=n>sp500_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>prior</span> <span class=o>=</span> <span class=n>market_implied_prior_returns</span><span class=p>(</span><span class=n>market_caps</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>delta</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>bl</span> <span class=o>=</span> <span class=n>BlackLittermanModel</span><span class=p>(</span><span class=n>S</span><span class=p>,</span> <span class=n>pi</span><span class=o>=</span><span class=n>prior</span><span class=p>,</span> <span class=n>absolute_views</span><span class=o>=</span><span class=n>viewdict</span><span class=p>)</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rets</span> <span class=o>=</span> <span class=n>bl</span><span class=o>.</span><span class=n>bl_returns</span><span class=p>()</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span> <span class=o>=</span> <span class=n>EfficientFrontier</span><span class=p>(</span><span class=n>rets</span><span class=p>,</span> <span class=n>S</span><span class=p>)</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ef</span><span class=o>.</span><span class=n>min_volatility</span><span class=p>()</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>ef</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.0),</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=go>             (&#39;BNBUSDT&#39;, 0.06743),</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=go>             (&#39;BTCUSDT&#39;, 0.89462),</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=go>             (&#39;ETHUSDT&#39;, 0.0),</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=go>             (&#39;XRPUSDT&#39;, 0.03795)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;bl_returns&quot;</span><span class=p>,</span>  <span class=c1># (2)!</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=gp>... </span>    <span class=n>market_prices</span><span class=o>=</span><span class=n>sp500_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=gp>... </span>    <span class=n>market_caps</span><span class=o>=</span><span class=n>market_caps</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=gp>... </span>    <span class=n>absolute_views</span><span class=o>=</span><span class=n>viewdict</span><span class=p>,</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;min_volatility&quot;</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=go>{&#39;ADAUSDT&#39;: 0.0,</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=go> &#39;BNBUSDT&#39;: 0.06743,</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=go> &#39;BTCUSDT&#39;: 0.89462,</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=go> &#39;ETHUSDT&#39;: 0.0,</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=go> &#39;XRPUSDT&#39;: 0.03795}</span>
</span></code></pre></div> <ol> <li><code>mean_historical_return</code> and <code>EfficientFrontier</code> are used by default.</li> <li><code>BlackLittermanModel</code>, <code>delta</code>, <code>prior</code>, and <code>bl_returns</code> are all resolved automatically.</li> </ol> </div> </div> </div> <p>Hierarchical Risk Parity (<a href=https://pyportfolioopt.readthedocs.io/en/latest/OtherOptimizers.html#hierarchical-risk-parity-hrp>read more</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=10:2><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><input id=__tabbed_10_2 name=__tabbed_10 type=radio><div class=tabbed-labels><label for=__tabbed_10_1>PyPortfolioOpt</label><label for=__tabbed_10_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>pypfopt</span><span class=w> </span><span class=kn>import</span> <span class=n>HRPOpt</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rets</span> <span class=o>=</span> <span class=n>returns_from_prices</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hrp</span> <span class=o>=</span> <span class=n>HRPOpt</span><span class=p>(</span><span class=n>rets</span><span class=p>)</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>hrp</span><span class=o>.</span><span class=n>optimize</span><span class=p>()</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>hrp</span><span class=o>.</span><span class=n>clean_weights</span><span class=p>()</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=go>OrderedDict([(&#39;ADAUSDT&#39;, 0.19415),</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=go>             (&#39;BNBUSDT&#39;, 0.24834),</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=go>             (&#39;BTCUSDT&#39;, 0.22827),</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=go>             (&#39;ETHUSDT&#39;, 0.15217),</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=go>             (&#39;XRPUSDT&#39;, 0.17707)])</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>  <span class=c1># (1)!</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=gp>... </span>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;hrp&quot;</span><span class=p>,</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;optimize&quot;</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=go>{&#39;ADAUSDT&#39;: 0.19415,</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=go> &#39;BNBUSDT&#39;: 0.24834,</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=go> &#39;BTCUSDT&#39;: 0.22827,</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=go> &#39;ETHUSDT&#39;: 0.15217,</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=go> &#39;XRPUSDT&#39;: 0.17707}</span>
</span></code></pre></div> <ol> <li>Returns are automatically recognized by VBT and converted from prices.</li> </ol> </div> </div> </div> <h3 id=argument-groups>Argument groups<a class=headerlink href=#argument-groups title="Permanent link">&para;</a></h3> <p>If you need to provide two functions with an argument that has the same name but requires different values, pass the argument as an instance of <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pfopt_func_dict>pfopt_func_dict</a>. The keys should be the functions or their names, and the values should be the corresponding argument values:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span>  
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=gp>... </span>    <span class=n>expected_returns</span><span class=o>=</span><span class=s2>&quot;bl_returns&quot;</span><span class=p>,</span>  
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=gp>... </span>    <span class=n>market_prices</span><span class=o>=</span><span class=n>sp500_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=gp>... </span>    <span class=n>market_caps</span><span class=o>=</span><span class=n>market_caps</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=gp>... </span>    <span class=n>absolute_views</span><span class=o>=</span><span class=n>viewdict</span><span class=p>,</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=s2>&quot;min_volatility&quot;</span><span class=p>,</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=gp>... </span>    <span class=n>cov_matrix</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>pfopt_func_dict</span><span class=p>({</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=gp>... </span>        <span class=s2>&quot;EfficientFrontier&quot;</span><span class=p>:</span> <span class=s2>&quot;sample_cov&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=gp>... </span>        <span class=s2>&quot;_def&quot;</span><span class=p>:</span> <span class=s2>&quot;ledoit_wolf&quot;</span>  <span class=c1># (2)!</span>
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=gp>... </span>    <span class=p>})</span>
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-31-13><a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a><span class=go>{&#39;ADAUSDT&#39;: 0.0,</span>
</span><span id=__span-31-14><a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=go> &#39;BNBUSDT&#39;: 0.05013,</span>
</span><span id=__span-31-15><a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=go> &#39;BTCUSDT&#39;: 0.91912,</span>
</span><span id=__span-31-16><a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=go> &#39;ETHUSDT&#39;: 0.0,</span>
</span><span id=__span-31-17><a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a><span class=go> &#39;XRPUSDT&#39;: 0.03075}</span>
</span></code></pre></div> <ol> <li>Use the annualized sample covariance matrix for the <code>EfficientFrontier</code> class.</li> <li>Use the Ledoit-Wolf shrinkage estimate for all other functions.</li> </ol> <h3 id=periodically>Periodically<a class=headerlink href=#periodically title="Permanent link">&para;</a></h3> <p>So, why does VBT implement a special parser for PyPortfolioOpt instead of relying on the original, modular API of the library?</p> <p>Using a single function that addresses all requirements makes it much simpler to use as an optimization function. For example, VBT applies sensible defaults for expected returns and other variables, and understands where each variable should be utilized. Also, passing arbitrary keyword arguments and having VBT distribute them across the relevant functions makes it easy to test multiple argument combinations using groups.</p> <p>Let's see this in action with <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer.from_pypfopt>PortfolioOptimizer.from_pypfopt</a>, which uses <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pypfopt_optimize>pypfopt_optimize</a> as its <code>optimize_func</code>. Optimize for maximum Sharpe in each week:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_pypfopt</span><span class=p>(</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=gp>... </span>    <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/pypfopt.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/pypfopt.dark.svg#only-dark></p> <p>Now, see how easy it is to test several values for the <code>target</code> argument:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_pypfopt</span><span class=p>(</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=gp>... </span>    <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span><span class=p>,</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=gp>... </span>    <span class=n>target</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>([</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=gp>... </span>        <span class=s2>&quot;max_sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=gp>... </span>        <span class=s2>&quot;min_volatility&quot;</span><span class=p>,</span> 
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=gp>... </span>        <span class=s2>&quot;max_quadratic_utility&quot;</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=gp>... </span>    <span class=p>])</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>column</span><span class=o>=</span><span class=s2>&quot;min_volatility&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>  <span class=c1># (1)!</span>
</span></code></pre></div> <ol> <li>Only one group can be plotted. Note that <code>column</code> here refers to a group, since each <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer>PortfolioOptimizer</a> instance is always grouped.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Group 3/3</p> </div> </div> </p> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/pypfopt_groups.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/pypfopt_groups.dark.svg#only-dark></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>pfo</span><span class=o>.</span><span class=n>simulate</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s2>&quot;1h&quot;</span><span class=p>)</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=go>target</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=go>max_sharpe               2.779042</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=go>min_volatility           1.862926</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=go>max_quadratic_utility    2.352667</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=go>Name: sharpe_ratio, dtype: float64</span>
</span></code></pre></div> <p>You can see that optimizing for maximum Sharpe provides the highest out-of-sample Sharpe. Great!</p> <h4 id=manually>Manually<a class=headerlink href=#manually title="Permanent link">&para;</a></h4> <p>You can also manually wrap the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.pypfopt_optimize>pypfopt_optimize</a> function. This is useful, for example, when you want to preprocess the data or postprocess the weights:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>optimize_func</span><span class=p>(</span><span class=n>prices</span><span class=p>,</span> <span class=n>index_slice</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=gp>... </span>    <span class=n>period_prices</span> <span class=o>=</span> <span class=n>prices</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>index_slice</span><span class=p>]</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>pypfopt_optimize</span><span class=p>(</span><span class=n>prices</span><span class=o>=</span><span class=n>period_prices</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_optimize_func</span><span class=p>(</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>symbol_wrapper</span><span class=p>,</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=gp>... </span>    <span class=n>optimize_func</span><span class=p>,</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=gp>... </span>    <span class=n>prices</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>),</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=gp>... </span>    <span class=n>index_slice</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Rep</span><span class=p>(</span><span class=s2>&quot;index_slice&quot;</span><span class=p>),</span>
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=gp>... </span>    <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span>
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <h2 id=riskfolio-lib>Riskfolio-Lib<a class=headerlink href=#riskfolio-lib title="Permanent link">&para;</a></h2> <blockquote> <p><a href=https://github.com/dcajasn/Riskfolio-Lib>Riskfolio-Lib</a> is a library for quantitative strategic asset allocation and portfolio optimization in Python, developed in Peru 🇵🇪. Its goal is to help students, academics, and practitioners build investment portfolios based on mathematically complex models with minimal effort. It is built on top of <a href=https://www.cvxpy.org/ >cvxpy</a> and closely integrates with <a href=https://pandas.pydata.org/ >pandas</a> data structures.</p> </blockquote> <p>Like PyPortfolioOpt, Riskfolio-Lib also offers a variety of portfolio optimization tools. A typical optimization workflow follows these steps:</p> <ul> <li>Load price data and convert it into returns.</li> <li>Create and configure a new portfolio object (usually with the suffix <code>Portfolio</code>).</li> <li>Depending on the chosen model, run one or more methods (usually with the suffix <code>stats</code>) that pre-calculate various statistics required for the optimization.</li> <li>Run the optimization method (usually with the suffix <code>optimization</code>) to obtain the weights.</li> </ul> <p>For example, here is how to perform mean-variance optimization (MVO) to maximize the Sharpe ratio:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>riskfolio</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>rp</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>returns</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>to_returns</span><span class=p>()</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-36-12><a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span>
</span><span id=__span-36-13><a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span>
</span><span id=__span-36-14><a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span>
</span><span id=__span-36-15><a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-36-16><a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-36-17><a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-36-18><a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-36-19><a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-36-20><a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a><span class=go>          ADAUSDT       BNBUSDT   BTCUSDT   ETHUSDT       XRPUSDT</span>
</span><span id=__span-36-21><a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a><span class=go>weights  0.207779  1.043621e-08  0.336897  0.455323  3.650466e-09</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Why does <code>assets_stats</code> not return anything? It is because it calculates <code>mu</code> and <code>cov</code> and updates the portfolio attributes <code>port.mu</code> and <code>port.cov</code> in place.</p> </div> <h3 id=parsing_1>Parsing<a class=headerlink href=#parsing_1 title="Permanent link">&para;</a></h3> <p>The method described above for generating a vector of weights from vectors of returns works well, but splitting the optimization process across several function calls can make parameterization more challenging. Ideally, we want a single function that can express any Riskfolio-Lib setup, preferably using only keyword arguments. To create such a function that covers many cases, we need to identify the inputs and outputs of each function and understand how these functions connect. Thanks to the consistent naming of arguments and functions in Riskfolio-Lib (kudos to <a class="magiclink magiclink-github magiclink-mention" href=https://github.com/dcajasn title="GitHub User: dcajasn">@dcajasn</a>!), along with the <a href=https://riskfolio-lib.readthedocs.io/en/latest/examples.html>comprehensive tutorials</a>, we can determine the required order of function calls for each optimization task.</p> <p>For example, the optimization method <a href=https://riskfolio-lib.readthedocs.io/en/latest/portfolio.html#Portfolio.Portfolio.optimization>Portfolio.optimization</a> with the "Classic" model requires the statistics method <a href=https://riskfolio-lib.readthedocs.io/en/latest/portfolio.html#Portfolio.Portfolio.assets_stats>Portfolio.assets_stats</a> to be called first. The "FM" model, on the other hand, requires both <a href=https://riskfolio-lib.readthedocs.io/en/latest/portfolio.html#Portfolio.Portfolio.assets_stats>Portfolio.assets_stats</a> and <a href=https://riskfolio-lib.readthedocs.io/en/latest/portfolio.html#Portfolio.Portfolio.factors_stats>Portfolio.factors_stats</a>. If the user provides constraints, we need to pre-process them using the corresponding <a href=https://riskfolio-lib.readthedocs.io/en/latest/constraints.html>constraints function</a>.</p> <p>Once we have established the call stack, how do we assign arguments to each function? We can check the signature of each function:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro.utils.parsing</span><span class=w> </span><span class=kn>import</span> <span class=n>get_func_arg_names</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>get_func_arg_names</span><span class=p>(</span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>)</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=go>[&#39;method_mu&#39;, &#39;method_cov&#39;, &#39;d&#39;]</span>
</span></code></pre></div> <p>If the user provides an argument called <code>method_mu</code>, it should be passed to this function and any other function that lists this argument, since it likely serves the same purpose. To determine which arguments need to be given to a particular Riskfolio-Lib function, you can use the handy <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_riskfolio_func_kwargs>resolve_riskfolio_func_kwargs</a> function:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro.portfolio.pfopt.base</span><span class=w> </span><span class=kn>import</span> <span class=n>resolve_riskfolio_func_kwargs</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>resolve_riskfolio_func_kwargs</span><span class=p>(</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=gp>... </span>    <span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>,</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-38-7><a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span>
</span><span id=__span-38-8><a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-38-9><a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=go>{&#39;method_mu&#39;: &#39;hist&#39;, &#39;method_cov&#39;: &#39;hist&#39;}</span>
</span></code></pre></div> <p>If you need to override any argument for a specific function only, you can provide a <code>func_kwargs</code> dictionary with functions as keys and keyword arguments as values:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>resolve_riskfolio_func_kwargs</span><span class=p>(</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=gp>... </span>    <span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>,</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=gp>... </span>    <span class=n>func_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=gp>... </span>        <span class=n>assets_stats</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;ewma1&quot;</span><span class=p>),</span>
</span><span id=__span-39-8><a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a><span class=gp>... </span>        <span class=n>optimization</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;BL&quot;</span><span class=p>)</span>
</span><span id=__span-39-9><a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-39-10><a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-39-11><a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a><span class=go>{&#39;method_mu&#39;: &#39;ewma1&#39;, &#39;method_cov&#39;: &#39;hist&#39;}</span>
</span></code></pre></div> <p>In this way, you can let VBT distribute the arguments automatically, but still have the option to manage it manually using <code>func_kwargs</code>.</p> <h3 id=auto-optimization_1>Auto-optimization<a class=headerlink href=#auto-optimization_1 title="Permanent link">&para;</a></h3> <p>Now that we know how to parse and resolve function arguments, VBT provides a function that can take a single set of keyword arguments and translate them into an optimization procedure: <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.riskfolio_optimize>riskfolio_optimize</a>. This function is just as easy to use as the one for PyPortfolioOpt!</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=go>{&#39;ADAUSDT&#39;: 0.20777948652846492,</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=go> &#39;BNBUSDT&#39;: 1.0435918170753283e-08,</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=go> &#39;BTCUSDT&#39;: 0.33689720861500716,</span>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=go> &#39;ETHUSDT&#39;: 0.45532329077024425,</span>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=go> &#39;XRPUSDT&#39;: 3.6503655112892327e-09}</span>
</span></code></pre></div> <p>Under the hood, the function first determines the portfolio class using the <code>port_cls</code> argument. It then creates a new portfolio instance, passing any keyword arguments that match the constructor method <code>__init__</code>. Next, it identifies the optimization method from the <code>opt_method</code> argument, which is set to <code>"optimization"</code> by default. Given the optimization method and the model (provided through the <code>model</code> argument), it can determine which statistics methods to run beforehand and in what order. The names of these statistics methods are stored in <code>stats_methods</code>, unless the user has already specified them. The next step is to resolve any asset classes, constraints, and views, translating them into keyword arguments suitable for the following functions in the call stack. For example, asset classes are pre-processed using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.resolve_asset_classes>resolve_asset_classes</a>, which allows users to pass <code>asset_classes</code> using various formats that Riskfolio-Lib does not otherwise support. Once all keyword arguments are prepared, the function runs the statistics methods (if any), followed by the optimization method. It then returns the weights as a dictionary, using the column names (i.e., asset names) from the returns array as keys.</p> <p>Below, we demonstrate several optimizations using both Riskfolio-Lib and VBT. Ulcer Index Portfolio Optimization for Mean Risk (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=11:2><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><input id=__tabbed_11_2 name=__tabbed_11 type=radio><div class=tabbed-labels><label for=__tabbed_11_1>Riskfolio-Lib</label><label for=__tabbed_11_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-41-8><a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span> 
</span><span id=__span-41-9><a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;UCI&quot;</span><span class=p>,</span> 
</span><span id=__span-41-10><a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-41-11><a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-41-12><a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-41-13><a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-41-14><a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-41-15><a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-41-16><a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a><span class=go>              ADAUSDT       BNBUSDT  BTCUSDT  ETHUSDT       XRPUSDT</span>
</span><span id=__span-41-17><a id=__codelineno-41-17 name=__codelineno-41-17 href=#__codelineno-41-17></a><span class=go>weights  4.421983e-11  1.922731e-11   0.8343   0.1657  9.143250e-11</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span><span class=p>,</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span> 
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;UCI&quot;</span><span class=p>,</span> 
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-42-9><a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-42-10><a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-42-11><a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-42-12><a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-42-13><a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a><span class=go>{&#39;ADAUSDT&#39;: 4.4219828299615346e-11,</span>
</span><span id=__span-42-14><a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a><span class=go> &#39;BNBUSDT&#39;: 1.9227309961407513e-11,</span>
</span><span id=__span-42-15><a id=__codelineno-42-15 name=__codelineno-42-15 href=#__codelineno-42-15></a><span class=go> &#39;BTCUSDT&#39;: 0.8342998038068898,</span>
</span><span id=__span-42-16><a id=__codelineno-42-16 name=__codelineno-42-16 href=#__codelineno-42-16></a><span class=go> &#39;ETHUSDT&#39;: 0.16570019603823058,</span>
</span><span id=__span-42-17><a id=__codelineno-42-17 name=__codelineno-42-17 href=#__codelineno-42-17></a><span class=go> &#39;XRPUSDT&#39;: 9.143250192538338e-11}</span>
</span></code></pre></div> </div> </div> </div> <p>Worst Case Mean Variance Portfolio Optimization using box and elliptical uncertainty sets (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=12:3><input checked=checked id=__tabbed_12_1 name=__tabbed_12 type=radio><input id=__tabbed_12_2 name=__tabbed_12 type=radio><input id=__tabbed_12_3 name=__tabbed_12 type=radio><div class=tabbed-labels><label for=__tabbed_12_1>Riskfolio-Lib</label><label for=__tabbed_12_2>VBT</label><label for=__tabbed_12_3>VBT (using func_kwargs)</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>wc_stats</span><span class=p>(</span>
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=gp>... </span>    <span class=n>box</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=gp>... </span>    <span class=n>ellip</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-43-10><a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=gp>... </span>    <span class=n>q</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> 
</span><span id=__span-43-11><a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=gp>... </span>    <span class=n>n_sim</span><span class=o>=</span><span class=mi>3000</span><span class=p>,</span> 
</span><span id=__span-43-12><a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=gp>... </span>    <span class=n>window</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> 
</span><span id=__span-43-13><a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=gp>... </span>    <span class=n>dmu</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-43-14><a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a><span class=gp>... </span>    <span class=n>dcov</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-43-15><a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=gp>... </span>    <span class=n>seed</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-43-16><a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-43-17><a id=__codelineno-43-17 name=__codelineno-43-17 href=#__codelineno-43-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>wc_optimization</span><span class=p>(</span>
</span><span id=__span-43-18><a id=__codelineno-43-18 name=__codelineno-43-18 href=#__codelineno-43-18></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-43-19><a id=__codelineno-43-19 name=__codelineno-43-19 href=#__codelineno-43-19></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-43-20><a id=__codelineno-43-20 name=__codelineno-43-20 href=#__codelineno-43-20></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-43-21><a id=__codelineno-43-21 name=__codelineno-43-21 href=#__codelineno-43-21></a><span class=gp>... </span>    <span class=n>Umu</span><span class=o>=</span><span class=s2>&quot;box&quot;</span><span class=p>,</span> 
</span><span id=__span-43-22><a id=__codelineno-43-22 name=__codelineno-43-22 href=#__codelineno-43-22></a><span class=gp>... </span>    <span class=n>Ucov</span><span class=o>=</span><span class=s2>&quot;box&quot;</span>
</span><span id=__span-43-23><a id=__codelineno-43-23 name=__codelineno-43-23 href=#__codelineno-43-23></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-43-24><a id=__codelineno-43-24 name=__codelineno-43-24 href=#__codelineno-43-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-43-25><a id=__codelineno-43-25 name=__codelineno-43-25 href=#__codelineno-43-25></a><span class=go>              ADAUSDT       BNBUSDT   BTCUSDT   ETHUSDT       XRPUSDT</span>
</span><span id=__span-43-26><a id=__codelineno-43-26 name=__codelineno-43-26 href=#__codelineno-43-26></a><span class=go>weights  8.434620e-11  4.298850e-11  0.385894  0.614106  4.185089e-11</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=gp>... </span>    <span class=n>opt_method</span><span class=o>=</span><span class=s2>&quot;wc&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-44-6><a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=gp>... </span>    <span class=n>box</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-44-7><a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a><span class=gp>... </span>    <span class=n>ellip</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-44-8><a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=gp>... </span>    <span class=n>q</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> 
</span><span id=__span-44-9><a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a><span class=gp>... </span>    <span class=n>n_sim</span><span class=o>=</span><span class=mi>3000</span><span class=p>,</span> 
</span><span id=__span-44-10><a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a><span class=gp>... </span>    <span class=n>window</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> 
</span><span id=__span-44-11><a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=gp>... </span>    <span class=n>dmu</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-44-12><a id=__codelineno-44-12 name=__codelineno-44-12 href=#__codelineno-44-12></a><span class=gp>... </span>    <span class=n>dcov</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-44-13><a id=__codelineno-44-13 name=__codelineno-44-13 href=#__codelineno-44-13></a><span class=gp>... </span>    <span class=n>seed</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-44-14><a id=__codelineno-44-14 name=__codelineno-44-14 href=#__codelineno-44-14></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-44-15><a id=__codelineno-44-15 name=__codelineno-44-15 href=#__codelineno-44-15></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-44-16><a id=__codelineno-44-16 name=__codelineno-44-16 href=#__codelineno-44-16></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-44-17><a id=__codelineno-44-17 name=__codelineno-44-17 href=#__codelineno-44-17></a><span class=gp>... </span>    <span class=n>Umu</span><span class=o>=</span><span class=s2>&quot;box&quot;</span><span class=p>,</span> 
</span><span id=__span-44-18><a id=__codelineno-44-18 name=__codelineno-44-18 href=#__codelineno-44-18></a><span class=gp>... </span>    <span class=n>Ucov</span><span class=o>=</span><span class=s2>&quot;box&quot;</span>
</span><span id=__span-44-19><a id=__codelineno-44-19 name=__codelineno-44-19 href=#__codelineno-44-19></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-44-20><a id=__codelineno-44-20 name=__codelineno-44-20 href=#__codelineno-44-20></a><span class=go>{&#39;ADAUSDT&#39;: 8.434620227152581e-11,</span>
</span><span id=__span-44-21><a id=__codelineno-44-21 name=__codelineno-44-21 href=#__codelineno-44-21></a><span class=go> &#39;BNBUSDT&#39;: 4.2988498616065945e-11,</span>
</span><span id=__span-44-22><a id=__codelineno-44-22 name=__codelineno-44-22 href=#__codelineno-44-22></a><span class=go> &#39;BTCUSDT&#39;: 0.38589404919778153,</span>
</span><span id=__span-44-23><a id=__codelineno-44-23 name=__codelineno-44-23 href=#__codelineno-44-23></a><span class=go> &#39;ETHUSDT&#39;: 0.6141059506330329,</span>
</span><span id=__span-44-24><a id=__codelineno-44-24 name=__codelineno-44-24 href=#__codelineno-44-24></a><span class=go> &#39;XRPUSDT&#39;: 4.185089189555317e-11}</span>
</span></code></pre></div> <ol> <li>Use the worst-case optimization method.</li> </ol> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=gp>... </span>    <span class=n>func_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a><span class=gp>... </span>        <span class=n>assets_stats</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a><span class=gp>... </span>            <span class=n>opt_method</span><span class=o>=</span><span class=s2>&quot;wc&quot;</span><span class=p>,</span>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=gp>... </span>            <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-45-7><a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a><span class=gp>... </span>            <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span>
</span><span id=__span-45-8><a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a><span class=gp>... </span>        <span class=p>),</span>
</span><span id=__span-45-9><a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a><span class=gp>... </span>        <span class=n>wc_stats</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-45-10><a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a><span class=gp>... </span>            <span class=n>box</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-45-11><a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a><span class=gp>... </span>            <span class=n>ellip</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> 
</span><span id=__span-45-12><a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a><span class=gp>... </span>            <span class=n>q</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> 
</span><span id=__span-45-13><a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a><span class=gp>... </span>            <span class=n>n_sim</span><span class=o>=</span><span class=mi>3000</span><span class=p>,</span> 
</span><span id=__span-45-14><a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a><span class=gp>... </span>            <span class=n>window</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> 
</span><span id=__span-45-15><a id=__codelineno-45-15 name=__codelineno-45-15 href=#__codelineno-45-15></a><span class=gp>... </span>            <span class=n>dmu</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-45-16><a id=__codelineno-45-16 name=__codelineno-45-16 href=#__codelineno-45-16></a><span class=gp>... </span>            <span class=n>dcov</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> 
</span><span id=__span-45-17><a id=__codelineno-45-17 name=__codelineno-45-17 href=#__codelineno-45-17></a><span class=gp>... </span>            <span class=n>seed</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-45-18><a id=__codelineno-45-18 name=__codelineno-45-18 href=#__codelineno-45-18></a><span class=gp>... </span>        <span class=p>),</span>
</span><span id=__span-45-19><a id=__codelineno-45-19 name=__codelineno-45-19 href=#__codelineno-45-19></a><span class=gp>... </span>        <span class=n>wc_optimization</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-45-20><a id=__codelineno-45-20 name=__codelineno-45-20 href=#__codelineno-45-20></a><span class=gp>... </span>            <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-45-21><a id=__codelineno-45-21 name=__codelineno-45-21 href=#__codelineno-45-21></a><span class=gp>... </span>            <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-45-22><a id=__codelineno-45-22 name=__codelineno-45-22 href=#__codelineno-45-22></a><span class=gp>... </span>            <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-45-23><a id=__codelineno-45-23 name=__codelineno-45-23 href=#__codelineno-45-23></a><span class=gp>... </span>            <span class=n>Umu</span><span class=o>=</span><span class=s2>&quot;box&quot;</span><span class=p>,</span> 
</span><span id=__span-45-24><a id=__codelineno-45-24 name=__codelineno-45-24 href=#__codelineno-45-24></a><span class=gp>... </span>            <span class=n>Ucov</span><span class=o>=</span><span class=s2>&quot;box&quot;</span>
</span><span id=__span-45-25><a id=__codelineno-45-25 name=__codelineno-45-25 href=#__codelineno-45-25></a><span class=gp>... </span>        <span class=p>)</span>
</span><span id=__span-45-26><a id=__codelineno-45-26 name=__codelineno-45-26 href=#__codelineno-45-26></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-45-27><a id=__codelineno-45-27 name=__codelineno-45-27 href=#__codelineno-45-27></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-45-28><a id=__codelineno-45-28 name=__codelineno-45-28 href=#__codelineno-45-28></a><span class=go>{&#39;ADAUSDT&#39;: 8.434620227152581e-11,</span>
</span><span id=__span-45-29><a id=__codelineno-45-29 name=__codelineno-45-29 href=#__codelineno-45-29></a><span class=go> &#39;BNBUSDT&#39;: 4.2988498616065945e-11,</span>
</span><span id=__span-45-30><a id=__codelineno-45-30 name=__codelineno-45-30 href=#__codelineno-45-30></a><span class=go> &#39;BTCUSDT&#39;: 0.38589404919778153,</span>
</span><span id=__span-45-31><a id=__codelineno-45-31 name=__codelineno-45-31 href=#__codelineno-45-31></a><span class=go> &#39;ETHUSDT&#39;: 0.6141059506330329,</span>
</span><span id=__span-45-32><a id=__codelineno-45-32 name=__codelineno-45-32 href=#__codelineno-45-32></a><span class=go> &#39;XRPUSDT&#39;: 4.185089189555317e-11}</span>
</span></code></pre></div> <ol> <li>Functions listed as keys must be in the order they should be called. Any key ending with <code>stats</code> will be interpreted as a statistic method (one or more). Any key ending with <code>optimization</code> will be interpreted as an optimization function (only one).</li> </ol> </div> </div> </div> <p>Mean Variance Portfolio with Short Weights (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=13:2><input checked=checked id=__tabbed_13_1 name=__tabbed_13 type=radio><input id=__tabbed_13_2 name=__tabbed_13 type=radio><div class=tabbed-labels><label for=__tabbed_13_1>Riskfolio-Lib</label><label for=__tabbed_13_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>sht</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>uppersht</span> <span class=o>=</span> <span class=mf>0.3</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>upperlng</span> <span class=o>=</span> <span class=mf>1.3</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>budget</span> <span class=o>=</span> <span class=mf>1.0</span>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-46-9><a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-46-10><a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-46-11><a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-46-12><a id=__codelineno-46-12 name=__codelineno-46-12 href=#__codelineno-46-12></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span> 
</span><span id=__span-46-13><a id=__codelineno-46-13 name=__codelineno-46-13 href=#__codelineno-46-13></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span> 
</span><span id=__span-46-14><a id=__codelineno-46-14 name=__codelineno-46-14 href=#__codelineno-46-14></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-46-15><a id=__codelineno-46-15 name=__codelineno-46-15 href=#__codelineno-46-15></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-46-16><a id=__codelineno-46-16 name=__codelineno-46-16 href=#__codelineno-46-16></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-46-17><a id=__codelineno-46-17 name=__codelineno-46-17 href=#__codelineno-46-17></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-46-18><a id=__codelineno-46-18 name=__codelineno-46-18 href=#__codelineno-46-18></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-46-19><a id=__codelineno-46-19 name=__codelineno-46-19 href=#__codelineno-46-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-46-20><a id=__codelineno-46-20 name=__codelineno-46-20 href=#__codelineno-46-20></a><span class=go>          ADAUSDT       BNBUSDT   BTCUSDT   ETHUSDT   XRPUSDT</span>
</span><span id=__span-46-21><a id=__codelineno-46-21 name=__codelineno-46-21 href=#__codelineno-46-21></a><span class=go>weights  0.295482 -2.109934e-07  0.456143  0.548375 -0.299999</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=gp>... </span>    <span class=n>sht</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=gp>... </span>    <span class=n>uppersht</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=gp>... </span>    <span class=n>upperlng</span><span class=o>=</span><span class=mf>1.3</span><span class=p>,</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a><span class=gp>... </span>    <span class=n>budget</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span><span class=p>,</span>
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span> 
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-47-15><a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-47-16><a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a><span class=go>{&#39;ADAUSDT&#39;: 0.2954820993653493,</span>
</span><span id=__span-47-17><a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=go> &#39;BNBUSDT&#39;: -2.1099344275128538e-07,</span>
</span><span id=__span-47-18><a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a><span class=go> &#39;BTCUSDT&#39;: 0.45614303697962627,</span>
</span><span id=__span-47-19><a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a><span class=go> &#39;ETHUSDT&#39;: 0.5483745379125106,</span>
</span><span id=__span-47-20><a id=__codelineno-47-20 name=__codelineno-47-20 href=#__codelineno-47-20></a><span class=go> &#39;XRPUSDT&#39;: -0.2999994632634474}</span>
</span></code></pre></div> </div> </div> </div> <p>Constraints on Assets (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=14:2><input checked=checked id=__tabbed_14_1 name=__tabbed_14 type=radio><input id=__tabbed_14_2 name=__tabbed_14 type=radio><div class=tabbed-labels><label for=__tabbed_14_1>Riskfolio-Lib</label><label for=__tabbed_14_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-48-6><a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-48-7><a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>asset_classes</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;Assets&quot;</span><span class=p>:</span> <span class=n>returns</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()}</span>
</span><span id=__span-48-8><a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>asset_classes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>asset_classes</span><span class=p>)</span>
</span><span id=__span-48-9><a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>constraints</span> <span class=o>=</span> <span class=p>{</span>  <span class=c1># (1)!</span>
</span><span id=__span-48-10><a id=__codelineno-48-10 name=__codelineno-48-10 href=#__codelineno-48-10></a><span class=gp>... </span>    <span class=s2>&quot;Disabled&quot;</span><span class=p>:</span> <span class=p>[</span><span class=kc>False</span><span class=p>,</span> <span class=kc>False</span><span class=p>],</span>
</span><span id=__span-48-11><a id=__codelineno-48-11 name=__codelineno-48-11 href=#__codelineno-48-11></a><span class=gp>... </span>    <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;All Assets&quot;</span><span class=p>,</span> <span class=s2>&quot;Assets&quot;</span><span class=p>],</span>
</span><span id=__span-48-12><a id=__codelineno-48-12 name=__codelineno-48-12 href=#__codelineno-48-12></a><span class=gp>... </span>    <span class=s2>&quot;Set&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-48-13><a id=__codelineno-48-13 name=__codelineno-48-13 href=#__codelineno-48-13></a><span class=gp>... </span>    <span class=s2>&quot;Position&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>],</span>
</span><span id=__span-48-14><a id=__codelineno-48-14 name=__codelineno-48-14 href=#__codelineno-48-14></a><span class=gp>... </span>    <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span> <span class=s2>&quot;&lt;=&quot;</span><span class=p>],</span>
</span><span id=__span-48-15><a id=__codelineno-48-15 name=__codelineno-48-15 href=#__codelineno-48-15></a><span class=gp>... </span>    <span class=s1>&#39;Weight&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>],</span>
</span><span id=__span-48-16><a id=__codelineno-48-16 name=__codelineno-48-16 href=#__codelineno-48-16></a><span class=gp>... </span>    <span class=s2>&quot;Type Relative&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-48-17><a id=__codelineno-48-17 name=__codelineno-48-17 href=#__codelineno-48-17></a><span class=gp>... </span>    <span class=s2>&quot;Relative Set&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-48-18><a id=__codelineno-48-18 name=__codelineno-48-18 href=#__codelineno-48-18></a><span class=gp>... </span>    <span class=s2>&quot;Relative&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-48-19><a id=__codelineno-48-19 name=__codelineno-48-19 href=#__codelineno-48-19></a><span class=gp>... </span>    <span class=s2>&quot;Factor&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-48-20><a id=__codelineno-48-20 name=__codelineno-48-20 href=#__codelineno-48-20></a><span class=gp>... </span><span class=p>}</span>
</span><span id=__span-48-21><a id=__codelineno-48-21 name=__codelineno-48-21 href=#__codelineno-48-21></a><span class=gp>&gt;&gt;&gt; </span><span class=n>constraints</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>constraints</span><span class=p>)</span>
</span><span id=__span-48-22><a id=__codelineno-48-22 name=__codelineno-48-22 href=#__codelineno-48-22></a><span class=gp>&gt;&gt;&gt; </span><span class=n>A</span><span class=p>,</span> <span class=n>B</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>assets_constraints</span><span class=p>(</span><span class=n>constraints</span><span class=p>,</span> <span class=n>asset_classes</span><span class=p>)</span>
</span><span id=__span-48-23><a id=__codelineno-48-23 name=__codelineno-48-23 href=#__codelineno-48-23></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>ainequality</span> <span class=o>=</span> <span class=n>A</span>
</span><span id=__span-48-24><a id=__codelineno-48-24 name=__codelineno-48-24 href=#__codelineno-48-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>binequality</span> <span class=o>=</span> <span class=n>B</span>
</span><span id=__span-48-25><a id=__codelineno-48-25 name=__codelineno-48-25 href=#__codelineno-48-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-48-26><a id=__codelineno-48-26 name=__codelineno-48-26 href=#__codelineno-48-26></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span>
</span><span id=__span-48-27><a id=__codelineno-48-27 name=__codelineno-48-27 href=#__codelineno-48-27></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span>
</span><span id=__span-48-28><a id=__codelineno-48-28 name=__codelineno-48-28 href=#__codelineno-48-28></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span>
</span><span id=__span-48-29><a id=__codelineno-48-29 name=__codelineno-48-29 href=#__codelineno-48-29></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-48-30><a id=__codelineno-48-30 name=__codelineno-48-30 href=#__codelineno-48-30></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-48-31><a id=__codelineno-48-31 name=__codelineno-48-31 href=#__codelineno-48-31></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-48-32><a id=__codelineno-48-32 name=__codelineno-48-32 href=#__codelineno-48-32></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-48-33><a id=__codelineno-48-33 name=__codelineno-48-33 href=#__codelineno-48-33></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-48-34><a id=__codelineno-48-34 name=__codelineno-48-34 href=#__codelineno-48-34></a><span class=go>          ADAUSDT  BNBUSDT  BTCUSDT   ETHUSDT  XRPUSDT</span>
</span><span id=__span-48-35><a id=__codelineno-48-35 name=__codelineno-48-35 href=#__codelineno-48-35></a><span class=go>weights  0.181443      0.1     0.15  0.468557      0.1</span>
</span></code></pre></div> <ol> <li>Each asset must have a weight of at least 10%. <code>BTCUSDT</code> must have a weight of at most 15%.</li> </ol> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a><span class=gp>... </span>    <span class=n>constraints</span><span class=o>=</span><span class=p>[{</span>  <span class=c1># (1)!</span>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a><span class=gp>... </span>        <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=s2>&quot;All Assets&quot;</span><span class=p>,</span>
</span><span id=__span-49-7><a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=gp>... </span>        <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span>
</span><span id=__span-49-8><a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a><span class=gp>... </span>        <span class=s2>&quot;Weight&quot;</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-49-9><a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a><span class=gp>... </span>    <span class=p>},</span> <span class=p>{</span>
</span><span id=__span-49-10><a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a><span class=gp>... </span>        <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=s2>&quot;Assets&quot;</span><span class=p>,</span>
</span><span id=__span-49-11><a id=__codelineno-49-11 name=__codelineno-49-11 href=#__codelineno-49-11></a><span class=gp>... </span>        <span class=s2>&quot;Position&quot;</span><span class=p>:</span> <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>,</span>
</span><span id=__span-49-12><a id=__codelineno-49-12 name=__codelineno-49-12 href=#__codelineno-49-12></a><span class=gp>... </span>        <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=s2>&quot;&lt;=&quot;</span><span class=p>,</span>
</span><span id=__span-49-13><a id=__codelineno-49-13 name=__codelineno-49-13 href=#__codelineno-49-13></a><span class=gp>... </span>        <span class=s2>&quot;Weight&quot;</span><span class=p>:</span> <span class=mf>0.15</span>
</span><span id=__span-49-14><a id=__codelineno-49-14 name=__codelineno-49-14 href=#__codelineno-49-14></a><span class=gp>... </span>    <span class=p>}],</span>
</span><span id=__span-49-15><a id=__codelineno-49-15 name=__codelineno-49-15 href=#__codelineno-49-15></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span><span class=p>,</span>
</span><span id=__span-49-16><a id=__codelineno-49-16 name=__codelineno-49-16 href=#__codelineno-49-16></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span> 
</span><span id=__span-49-17><a id=__codelineno-49-17 name=__codelineno-49-17 href=#__codelineno-49-17></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-49-18><a id=__codelineno-49-18 name=__codelineno-49-18 href=#__codelineno-49-18></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-49-19><a id=__codelineno-49-19 name=__codelineno-49-19 href=#__codelineno-49-19></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-49-20><a id=__codelineno-49-20 name=__codelineno-49-20 href=#__codelineno-49-20></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-49-21><a id=__codelineno-49-21 name=__codelineno-49-21 href=#__codelineno-49-21></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-49-22><a id=__codelineno-49-22 name=__codelineno-49-22 href=#__codelineno-49-22></a><span class=go>{&#39;ADAUSDT&#39;: 0.181442978888792,</span>
</span><span id=__span-49-23><a id=__codelineno-49-23 name=__codelineno-49-23 href=#__codelineno-49-23></a><span class=go> &#39;BNBUSDT&#39;: 0.10000000609450148,</span>
</span><span id=__span-49-24><a id=__codelineno-49-24 name=__codelineno-49-24 href=#__codelineno-49-24></a><span class=go> &#39;BTCUSDT&#39;: 0.1499998352568763,</span>
</span><span id=__span-49-25><a id=__codelineno-49-25 name=__codelineno-49-25 href=#__codelineno-49-25></a><span class=go> &#39;ETHUSDT&#39;: 0.4685571774444982,</span>
</span><span id=__span-49-26><a id=__codelineno-49-26 name=__codelineno-49-26 href=#__codelineno-49-26></a><span class=go> &#39;XRPUSDT&#39;: 0.10000000231533206}</span>
</span></code></pre></div> <ol> <li>There is no need to build a complete DataFrame; VBT will handle this for you. Also, there is no need to provide <code>asset_classes</code>; they are inferred from the columns.</li> </ol> </div> </div> </div> <p>Constraints on Asset Classes (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>tags</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=gp>... </span>    <span class=s2>&quot;Smart contracts&quot;</span><span class=p>,</span>
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=gp>... </span>    <span class=s2>&quot;Smart contracts&quot;</span><span class=p>,</span>
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=gp>... </span>    <span class=s2>&quot;Payments&quot;</span><span class=p>,</span>
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a><span class=gp>... </span>    <span class=s2>&quot;Smart contracts&quot;</span><span class=p>,</span>
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a><span class=gp>... </span>    <span class=s2>&quot;Payments&quot;</span>
</span><span id=__span-50-7><a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a><span class=gp>... </span><span class=p>]</span>
</span></code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=15:2><input checked=checked id=__tabbed_15_1 name=__tabbed_15 type=radio><input id=__tabbed_15_2 name=__tabbed_15 type=radio><div class=tabbed-labels><label for=__tabbed_15_1>Riskfolio-Lib</label><label for=__tabbed_15_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>Portfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>assets_stats</span><span class=p>(</span>
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-51-4><a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-51-5><a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span>
</span><span id=__span-51-6><a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-51-7><a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>asset_classes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-51-8><a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a><span class=gp>... </span>    <span class=s2>&quot;Assets&quot;</span><span class=p>:</span> <span class=n>returns</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
</span><span id=__span-51-9><a id=__codelineno-51-9 name=__codelineno-51-9 href=#__codelineno-51-9></a><span class=gp>... </span>    <span class=s2>&quot;Tags&quot;</span><span class=p>:</span> <span class=n>tags</span>
</span><span id=__span-51-10><a id=__codelineno-51-10 name=__codelineno-51-10 href=#__codelineno-51-10></a><span class=gp>... </span><span class=p>}</span>
</span><span id=__span-51-11><a id=__codelineno-51-11 name=__codelineno-51-11 href=#__codelineno-51-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>asset_classes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>asset_classes</span><span class=p>)</span>
</span><span id=__span-51-12><a id=__codelineno-51-12 name=__codelineno-51-12 href=#__codelineno-51-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>constraints</span> <span class=o>=</span> <span class=p>{</span>  <span class=c1># (1)!</span>
</span><span id=__span-51-13><a id=__codelineno-51-13 name=__codelineno-51-13 href=#__codelineno-51-13></a><span class=gp>... </span>    <span class=s2>&quot;Disabled&quot;</span><span class=p>:</span> <span class=p>[</span><span class=kc>False</span><span class=p>],</span>
</span><span id=__span-51-14><a id=__codelineno-51-14 name=__codelineno-51-14 href=#__codelineno-51-14></a><span class=gp>... </span>    <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;Classes&quot;</span><span class=p>],</span>
</span><span id=__span-51-15><a id=__codelineno-51-15 name=__codelineno-51-15 href=#__codelineno-51-15></a><span class=gp>... </span>    <span class=s2>&quot;Set&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;Tags&quot;</span><span class=p>],</span>
</span><span id=__span-51-16><a id=__codelineno-51-16 name=__codelineno-51-16 href=#__codelineno-51-16></a><span class=gp>... </span>    <span class=s2>&quot;Position&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;Smart contracts&quot;</span><span class=p>],</span>
</span><span id=__span-51-17><a id=__codelineno-51-17 name=__codelineno-51-17 href=#__codelineno-51-17></a><span class=gp>... </span>    <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&gt;=&quot;</span><span class=p>],</span>
</span><span id=__span-51-18><a id=__codelineno-51-18 name=__codelineno-51-18 href=#__codelineno-51-18></a><span class=gp>... </span>    <span class=s1>&#39;Weight&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.8</span><span class=p>],</span>
</span><span id=__span-51-19><a id=__codelineno-51-19 name=__codelineno-51-19 href=#__codelineno-51-19></a><span class=gp>... </span>    <span class=s2>&quot;Type Relative&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-51-20><a id=__codelineno-51-20 name=__codelineno-51-20 href=#__codelineno-51-20></a><span class=gp>... </span>    <span class=s2>&quot;Relative Set&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-51-21><a id=__codelineno-51-21 name=__codelineno-51-21 href=#__codelineno-51-21></a><span class=gp>... </span>    <span class=s2>&quot;Relative&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-51-22><a id=__codelineno-51-22 name=__codelineno-51-22 href=#__codelineno-51-22></a><span class=gp>... </span>    <span class=s2>&quot;Factor&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;&quot;</span><span class=p>],</span>
</span><span id=__span-51-23><a id=__codelineno-51-23 name=__codelineno-51-23 href=#__codelineno-51-23></a><span class=gp>... </span><span class=p>}</span>
</span><span id=__span-51-24><a id=__codelineno-51-24 name=__codelineno-51-24 href=#__codelineno-51-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>constraints</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>constraints</span><span class=p>)</span>
</span><span id=__span-51-25><a id=__codelineno-51-25 name=__codelineno-51-25 href=#__codelineno-51-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>A</span><span class=p>,</span> <span class=n>B</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>assets_constraints</span><span class=p>(</span><span class=n>constraints</span><span class=p>,</span> <span class=n>asset_classes</span><span class=p>)</span>
</span><span id=__span-51-26><a id=__codelineno-51-26 name=__codelineno-51-26 href=#__codelineno-51-26></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>ainequality</span> <span class=o>=</span> <span class=n>A</span>
</span><span id=__span-51-27><a id=__codelineno-51-27 name=__codelineno-51-27 href=#__codelineno-51-27></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span><span class=o>.</span><span class=n>binequality</span> <span class=o>=</span> <span class=n>B</span>
</span><span id=__span-51-28><a id=__codelineno-51-28 name=__codelineno-51-28 href=#__codelineno-51-28></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-51-29><a id=__codelineno-51-29 name=__codelineno-51-29 href=#__codelineno-51-29></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;Classic&quot;</span><span class=p>,</span>
</span><span id=__span-51-30><a id=__codelineno-51-30 name=__codelineno-51-30 href=#__codelineno-51-30></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span>
</span><span id=__span-51-31><a id=__codelineno-51-31 name=__codelineno-51-31 href=#__codelineno-51-31></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span>
</span><span id=__span-51-32><a id=__codelineno-51-32 name=__codelineno-51-32 href=#__codelineno-51-32></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-51-33><a id=__codelineno-51-33 name=__codelineno-51-33 href=#__codelineno-51-33></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-51-34><a id=__codelineno-51-34 name=__codelineno-51-34 href=#__codelineno-51-34></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-51-35><a id=__codelineno-51-35 name=__codelineno-51-35 href=#__codelineno-51-35></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-51-36><a id=__codelineno-51-36 name=__codelineno-51-36 href=#__codelineno-51-36></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-51-37><a id=__codelineno-51-37 name=__codelineno-51-37 href=#__codelineno-51-37></a><span class=go>          ADAUSDT       BNBUSDT  BTCUSDT   ETHUSDT       XRPUSDT</span>
</span><span id=__span-51-38><a id=__codelineno-51-38 name=__codelineno-51-38 href=#__codelineno-51-38></a><span class=go>weights  0.227839  5.856725e-10      0.2  0.572161  1.852774e-10</span>
</span></code></pre></div> <ol> <li>The sum of all weights in the "Smart contracts" class from the "Tags" set must be at least 80%.</li> </ol> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a><span class=gp>... </span>    <span class=n>method_mu</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=gp>... </span>    <span class=n>method_cov</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span> 
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a><span class=gp>... </span>    <span class=n>asset_classes</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;Tags&quot;</span><span class=p>:</span> <span class=n>tags</span><span class=p>},</span>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a><span class=gp>... </span>    <span class=n>constraints</span><span class=o>=</span><span class=p>[{</span>
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a><span class=gp>... </span>        <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=s2>&quot;Classes&quot;</span><span class=p>,</span>
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a><span class=gp>... </span>        <span class=s2>&quot;Set&quot;</span><span class=p>:</span> <span class=s2>&quot;Tags&quot;</span><span class=p>,</span>
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a><span class=gp>... </span>        <span class=s2>&quot;Position&quot;</span><span class=p>:</span> <span class=s2>&quot;Smart contracts&quot;</span><span class=p>,</span>
</span><span id=__span-52-10><a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a><span class=gp>... </span>        <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span>
</span><span id=__span-52-11><a id=__codelineno-52-11 name=__codelineno-52-11 href=#__codelineno-52-11></a><span class=gp>... </span>        <span class=s2>&quot;Weight&quot;</span><span class=p>:</span> <span class=mf>0.8</span>
</span><span id=__span-52-12><a id=__codelineno-52-12 name=__codelineno-52-12 href=#__codelineno-52-12></a><span class=gp>... </span>    <span class=p>}],</span>
</span><span id=__span-52-13><a id=__codelineno-52-13 name=__codelineno-52-13 href=#__codelineno-52-13></a><span class=gp>... </span>    <span class=n>d</span><span class=o>=</span><span class=mf>0.94</span><span class=p>,</span>
</span><span id=__span-52-14><a id=__codelineno-52-14 name=__codelineno-52-14 href=#__codelineno-52-14></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span> 
</span><span id=__span-52-15><a id=__codelineno-52-15 name=__codelineno-52-15 href=#__codelineno-52-15></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;Sharpe&quot;</span><span class=p>,</span> 
</span><span id=__span-52-16><a id=__codelineno-52-16 name=__codelineno-52-16 href=#__codelineno-52-16></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-52-17><a id=__codelineno-52-17 name=__codelineno-52-17 href=#__codelineno-52-17></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-52-18><a id=__codelineno-52-18 name=__codelineno-52-18 href=#__codelineno-52-18></a><span class=gp>... </span>    <span class=n>hist</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-52-19><a id=__codelineno-52-19 name=__codelineno-52-19 href=#__codelineno-52-19></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-52-20><a id=__codelineno-52-20 name=__codelineno-52-20 href=#__codelineno-52-20></a><span class=go>{&#39;ADAUSDT&#39;: 0.22783907021563807,</span>
</span><span id=__span-52-21><a id=__codelineno-52-21 name=__codelineno-52-21 href=#__codelineno-52-21></a><span class=go> &#39;BNBUSDT&#39;: 5.856745345006487e-10,</span>
</span><span id=__span-52-22><a id=__codelineno-52-22 name=__codelineno-52-22 href=#__codelineno-52-22></a><span class=go> &#39;BTCUSDT&#39;: 0.19999999471503008,</span>
</span><span id=__span-52-23><a id=__codelineno-52-23 name=__codelineno-52-23 href=#__codelineno-52-23></a><span class=go> &#39;ETHUSDT&#39;: 0.5721609342983793,</span>
</span><span id=__span-52-24><a id=__codelineno-52-24 name=__codelineno-52-24 href=#__codelineno-52-24></a><span class=go> &#39;XRPUSDT&#39;: 1.852779892852209e-10}</span>
</span></code></pre></div> </div> </div> </div> <p>Nested Clustered Optimization (NCO) (<a href=https://nbviewer.org/github/dcajasn/Riskfolio-Lib/tree/master/examples/ >notebook</a>):</p> <div class="tabbed-set tabbed-alternate" data-tabs=16:2><input checked=checked id=__tabbed_16_1 name=__tabbed_16 type=radio><input id=__tabbed_16_2 name=__tabbed_16 type=radio><div class=tabbed-labels><label for=__tabbed_16_1>Riskfolio-Lib</label><label for=__tabbed_16_2>VBT</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>port</span> <span class=o>=</span> <span class=n>rp</span><span class=o>.</span><span class=n>HCPortfolio</span><span class=p>(</span><span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>)</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span> <span class=o>=</span> <span class=n>port</span><span class=o>.</span><span class=n>optimization</span><span class=p>(</span>
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;NCO&quot;</span><span class=p>,</span>
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a><span class=gp>... </span>    <span class=n>codependence</span><span class=o>=</span><span class=s2>&quot;pearson&quot;</span><span class=p>,</span>
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=gp>... </span>    <span class=n>covariance</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;MinRisk&quot;</span><span class=p>,</span>
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span>
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-53-9><a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-53-10><a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a><span class=gp>... </span>    <span class=n>linkage</span><span class=o>=</span><span class=s2>&quot;ward&quot;</span><span class=p>,</span>
</span><span id=__span-53-11><a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a><span class=gp>... </span>    <span class=n>max_k</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-53-12><a id=__codelineno-53-12 name=__codelineno-53-12 href=#__codelineno-53-12></a><span class=gp>... </span>    <span class=n>leaf_order</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-53-13><a id=__codelineno-53-13 name=__codelineno-53-13 href=#__codelineno-53-13></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-53-14><a id=__codelineno-53-14 name=__codelineno-53-14 href=#__codelineno-53-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>w</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-53-15><a id=__codelineno-53-15 name=__codelineno-53-15 href=#__codelineno-53-15></a><span class=go>              ADAUSDT  BNBUSDT   BTCUSDT       ETHUSDT   XRPUSDT</span>
</span><span id=__span-53-16><a id=__codelineno-53-16 name=__codelineno-53-16 href=#__codelineno-53-16></a><span class=go>weights  6.402583e-09  0.05898  0.911545  3.331509e-09  0.029475</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>riskfolio_optimize</span><span class=p>(</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=p>,</span>
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=gp>... </span>    <span class=n>port_cls</span><span class=o>=</span><span class=s2>&quot;HCPortfolio&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-54-4><a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a><span class=gp>... </span>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;NCO&quot;</span><span class=p>,</span>
</span><span id=__span-54-5><a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=gp>... </span>    <span class=n>codependence</span><span class=o>=</span><span class=s2>&quot;pearson&quot;</span><span class=p>,</span>
</span><span id=__span-54-6><a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a><span class=gp>... </span>    <span class=n>covariance</span><span class=o>=</span><span class=s2>&quot;hist&quot;</span><span class=p>,</span>
</span><span id=__span-54-7><a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a><span class=gp>... </span>    <span class=n>obj</span><span class=o>=</span><span class=s2>&quot;MinRisk&quot;</span><span class=p>,</span>
</span><span id=__span-54-8><a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a><span class=gp>... </span>    <span class=n>rm</span><span class=o>=</span><span class=s2>&quot;MV&quot;</span><span class=p>,</span>
</span><span id=__span-54-9><a id=__codelineno-54-9 name=__codelineno-54-9 href=#__codelineno-54-9></a><span class=gp>... </span>    <span class=n>rf</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-54-10><a id=__codelineno-54-10 name=__codelineno-54-10 href=#__codelineno-54-10></a><span class=gp>... </span>    <span class=n>l</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-54-11><a id=__codelineno-54-11 name=__codelineno-54-11 href=#__codelineno-54-11></a><span class=gp>... </span>    <span class=n>linkage</span><span class=o>=</span><span class=s2>&quot;ward&quot;</span><span class=p>,</span>
</span><span id=__span-54-12><a id=__codelineno-54-12 name=__codelineno-54-12 href=#__codelineno-54-12></a><span class=gp>... </span>    <span class=n>max_k</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-54-13><a id=__codelineno-54-13 name=__codelineno-54-13 href=#__codelineno-54-13></a><span class=gp>... </span>    <span class=n>leaf_order</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-54-14><a id=__codelineno-54-14 name=__codelineno-54-14 href=#__codelineno-54-14></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-54-15><a id=__codelineno-54-15 name=__codelineno-54-15 href=#__codelineno-54-15></a><span class=go>{&#39;ADAUSDT&#39;: 6.402581338827853e-09,</span>
</span><span id=__span-54-16><a id=__codelineno-54-16 name=__codelineno-54-16 href=#__codelineno-54-16></a><span class=go> &#39;BNBUSDT&#39;: 0.05897978986842499,</span>
</span><span id=__span-54-17><a id=__codelineno-54-17 name=__codelineno-54-17 href=#__codelineno-54-17></a><span class=go> &#39;BTCUSDT&#39;: 0.9115447868616637,</span>
</span><span id=__span-54-18><a id=__codelineno-54-18 name=__codelineno-54-18 href=#__codelineno-54-18></a><span class=go> &#39;ETHUSDT&#39;: 3.3315084935084894e-09,</span>
</span><span id=__span-54-19><a id=__codelineno-54-19 name=__codelineno-54-19 href=#__codelineno-54-19></a><span class=go> &#39;XRPUSDT&#39;: 0.029475413535821407}</span>
</span></code></pre></div> <ol> <li>Specify the name of the portfolio class.</li> </ol> </div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>If you receive the message "The problem doesn't have a solution with actual input parameters" when using the "MOSEK" solver, make sure you have installed and activated <a href=https://www.mosek.com/ >MOSEK</a>. You can also try using "ECOS".</p> </div> <h3 id=periodically_1>Periodically<a class=headerlink href=#periodically_1 title="Permanent link">&para;</a></h3> <p>As mentioned earlier, having a single function to handle everything is not only easier to use, but its main advantage is that it can be parameterized and leveraged for rebalancing with <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer>PortfolioOptimizer</a>. Specifically, the optimization function shown above is used by the method <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer.from_riskfolio>PortfolioOptimizer.from_riskfolio</a>, which calls it on a periodic basis. Let's demonstrate its flexibility by optimizing for maximum Sharpe in the previous week:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_riskfolio</span><span class=p>(</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>,</span>
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a><span class=gp>... </span>    <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span>
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/riskfolio.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/riskfolio.dark.svg#only-dark></p> <p>What about parameters? We can wrap any argument, even nested ones, with <a href=https://vectorbt.pro/pvt_41531c19/api/utils/params/#vectorbtpro.utils.params.Param>Param</a> to test multiple parameter combinations. For example, let's test different maximum <code>BTCUSDT</code> weights to ensure constraints behave as expected:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_riskfolio</span><span class=p>(</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a><span class=gp>... </span>    <span class=n>returns</span><span class=o>=</span><span class=n>returns</span><span class=p>,</span>
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a><span class=gp>... </span>    <span class=n>constraints</span><span class=o>=</span><span class=p>[{</span>
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a><span class=gp>... </span>        <span class=s2>&quot;Type&quot;</span><span class=p>:</span> <span class=s2>&quot;Assets&quot;</span><span class=p>,</span>
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a><span class=gp>... </span>        <span class=s2>&quot;Position&quot;</span><span class=p>:</span> <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>,</span>
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a><span class=gp>... </span>        <span class=s2>&quot;Sign&quot;</span><span class=p>:</span> <span class=s2>&quot;&lt;=&quot;</span><span class=p>,</span>
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a><span class=gp>... </span>        <span class=s2>&quot;Weight&quot;</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;BTCUSDT_maxw&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-56-8><a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a><span class=gp>... </span>    <span class=p>}],</span>
</span><span id=__span-56-9><a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a><span class=gp>... </span>    <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span><span class=p>,</span>
</span><span id=__span-56-10><a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a><span class=gp>... </span>    <span class=n>param_search_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>incl_types</span><span class=o>=</span><span class=nb>list</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-56-11><a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <ol> <li>Parameters can be defined in any nested structure.</li> <li>For VBT to search for parameters within nested structures, you need to whitelist them first.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Group 3/3</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span><span class=o>.</span><span class=n>allocations</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>&quot;BTCUSDT_maxw&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a><span class=go>symbol        ADAUSDT  BNBUSDT  BTCUSDT  ETHUSDT  XRPUSDT</span>
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=go>BTCUSDT_maxw                                             </span>
</span><span id=__span-57-4><a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a><span class=go>0.1               1.0      1.0      0.1      1.0      1.0</span>
</span><span id=__span-57-5><a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a><span class=go>0.2               1.0      1.0      0.2      1.0      1.0</span>
</span><span id=__span-57-6><a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a><span class=go>0.3               1.0      1.0      0.3      1.0      1.0</span>
</span></code></pre></div> <p>It works perfectly <img alt=👌 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f44c.svg title=:ok_hand:></p> <h2 id=universal-portfolios>Universal portfolios<a class=headerlink href=#universal-portfolios title="Permanent link">&para;</a></h2> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To install this package, first install vectorbtpro, and then install universal-portfolios, not both together. Because its dependency versions are quite strict, you may want to ignore its dependencies altogether by running <code>pip install -U universal-portfolios --no-deps</code>.</p> </div> <blockquote> <p>The purpose of <a href=https://github.com/Marigold/universal-portfolios>Universal Portfolios</a> is to bring together different Online Portfolio Selection (OLPS) algorithms and provide unified tools for analyzing them.</p> </blockquote> <p>Unlike PyPortfolioOpt, which generates weights for a specific time range, OLPS aims to select portfolio weights for each period to maximize final wealth. This means the generated weights always have the same shape as the original array.</p> <p>Let's look at the uniform allocation (UCRP):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>universal</span><span class=w> </span><span class=kn>import</span> <span class=n>tools</span><span class=p>,</span> <span class=n>algos</span>
</span><span id=__span-58-2><a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
</span><span id=__span-58-3><a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>WarningsFiltered</span><span class=p>():</span>  <span class=c1># (1)!</span>
</span><span id=__span-58-4><a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a><span class=gp>... </span>    <span class=n>algo</span> <span class=o>=</span> <span class=n>algos</span><span class=o>.</span><span class=n>CRP</span><span class=p>()</span>
</span><span id=__span-58-5><a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=gp>... </span>    <span class=n>algo_result</span> <span class=o>=</span> <span class=n>algo</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>))</span>
</span><span id=__span-58-6><a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a>
</span><span id=__span-58-7><a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>algo_result</span><span class=o>.</span><span class=n>weights</span>
</span><span id=__span-58-8><a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a><span class=go>symbol                     ADAUSDT  BNBUSDT  BTCUSDT  ETHUSDT  XRPUSDT  CASH</span>
</span><span id=__span-58-9><a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a><span class=go>Open time                                                                   </span>
</span><span id=__span-58-10><a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a><span class=go>2020-01-01 00:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-11><a id=__codelineno-58-11 name=__codelineno-58-11 href=#__codelineno-58-11></a><span class=go>2020-01-01 01:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-12><a id=__codelineno-58-12 name=__codelineno-58-12 href=#__codelineno-58-12></a><span class=go>2020-01-01 02:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-13><a id=__codelineno-58-13 name=__codelineno-58-13 href=#__codelineno-58-13></a><span class=go>...                            ...      ...      ...      ...      ...   ...</span>
</span><span id=__span-58-14><a id=__codelineno-58-14 name=__codelineno-58-14 href=#__codelineno-58-14></a><span class=go>2020-12-31 21:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-15><a id=__codelineno-58-15 name=__codelineno-58-15 href=#__codelineno-58-15></a><span class=go>2020-12-31 22:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-16><a id=__codelineno-58-16 name=__codelineno-58-16 href=#__codelineno-58-16></a><span class=go>2020-12-31 23:00:00+00:00      0.2      0.2      0.2      0.2      0.2   0.0</span>
</span><span id=__span-58-17><a id=__codelineno-58-17 name=__codelineno-58-17 href=#__codelineno-58-17></a>
</span><span id=__span-58-18><a id=__codelineno-58-18 name=__codelineno-58-18 href=#__codelineno-58-18></a><span class=go>[8767 rows x 6 columns]</span>
</span></code></pre></div> <ol> <li>You may see some deprecation warnings from Pandas; prepend this line to ignore them.</li> </ol> <p>As you can see, Universal Portfolios generates and allocates weights at every single timestamp, which is not realistic in practice since rebalancing that frequently is unsustainable unless the data frequency is low. Also, iterating over this amount of data with this library is usually <strong>quite slow</strong>.</p> <p>To address this, we should downsample the pricing array to a longer time frame, then upsample back to the original index. Let's try this with the <code>DynamicCRP</code> algorithm by first downsampling to a daily frequency:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>WarningsFiltered</span><span class=p>():</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a><span class=gp>... </span>    <span class=n>algo</span> <span class=o>=</span> <span class=n>algos</span><span class=o>.</span><span class=n>DynamicCRP</span><span class=p>(</span>
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=gp>... </span>        <span class=n>n</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=gp>... </span>        <span class=n>min_history</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span>
</span><span id=__span-59-5><a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=gp>... </span>        <span class=n>metric</span><span class=o>=</span><span class=s1>&#39;sharpe&#39;</span><span class=p>,</span>
</span><span id=__span-59-6><a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a><span class=gp>... </span>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.01</span>
</span><span id=__span-59-7><a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-59-8><a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a><span class=gp>... </span>    <span class=n>algo_result</span> <span class=o>=</span> <span class=n>algo</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s2>&quot;D&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>last</span><span class=p>())</span>
</span><span id=__span-59-9><a id=__codelineno-59-9 name=__codelineno-59-9 href=#__codelineno-59-9></a><span class=gp>... </span>    <span class=n>down_weights</span> <span class=o>=</span> <span class=n>algo_result</span><span class=o>.</span><span class=n>weights</span>
</span><span id=__span-59-10><a id=__codelineno-59-10 name=__codelineno-59-10 href=#__codelineno-59-10></a>
</span><span id=__span-59-11><a id=__codelineno-59-11 name=__codelineno-59-11 href=#__codelineno-59-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>down_weights</span>
</span><span id=__span-59-12><a id=__codelineno-59-12 name=__codelineno-59-12 href=#__codelineno-59-12></a><span class=go>symbol                          ADAUSDT       BNBUSDT   BTCUSDT       ETHUSDT  \</span>
</span><span id=__span-59-13><a id=__codelineno-59-13 name=__codelineno-59-13 href=#__codelineno-59-13></a><span class=go>Open time</span>
</span><span id=__span-59-14><a id=__codelineno-59-14 name=__codelineno-59-14 href=#__codelineno-59-14></a><span class=go>2020-01-01 00:00:00+00:00  2.000000e-01  2.000000e-01  0.200000  2.000000e-01</span>
</span><span id=__span-59-15><a id=__codelineno-59-15 name=__codelineno-59-15 href=#__codelineno-59-15></a><span class=go>2020-01-02 00:00:00+00:00  2.000000e-01  2.000000e-01  0.200000  2.000000e-01</span>
</span><span id=__span-59-16><a id=__codelineno-59-16 name=__codelineno-59-16 href=#__codelineno-59-16></a><span class=go>2020-01-03 00:00:00+00:00  2.000000e-01  2.000000e-01  0.200000  2.000000e-01</span>
</span><span id=__span-59-17><a id=__codelineno-59-17 name=__codelineno-59-17 href=#__codelineno-59-17></a><span class=go>...                                 ...           ...       ...           ...</span>
</span><span id=__span-59-18><a id=__codelineno-59-18 name=__codelineno-59-18 href=#__codelineno-59-18></a><span class=go>2020-12-29 00:00:00+00:00  8.475716e-09  8.176270e-09  0.664594  8.274986e-09</span>
</span><span id=__span-59-19><a id=__codelineno-59-19 name=__codelineno-59-19 href=#__codelineno-59-19></a><span class=go>2020-12-30 00:00:00+00:00  0.000000e+00  0.000000e+00  0.656068  0.000000e+00</span>
</span><span id=__span-59-20><a id=__codelineno-59-20 name=__codelineno-59-20 href=#__codelineno-59-20></a><span class=go>2020-12-31 00:00:00+00:00  0.000000e+00  0.000000e+00  0.655105  0.000000e+00</span>
</span><span id=__span-59-21><a id=__codelineno-59-21 name=__codelineno-59-21 href=#__codelineno-59-21></a>
</span><span id=__span-59-22><a id=__codelineno-59-22 name=__codelineno-59-22 href=#__codelineno-59-22></a><span class=go>symbol                          XRPUSDT</span>
</span><span id=__span-59-23><a id=__codelineno-59-23 name=__codelineno-59-23 href=#__codelineno-59-23></a><span class=go>Open time</span>
</span><span id=__span-59-24><a id=__codelineno-59-24 name=__codelineno-59-24 href=#__codelineno-59-24></a><span class=go>2020-01-01 00:00:00+00:00  2.000000e-01</span>
</span><span id=__span-59-25><a id=__codelineno-59-25 name=__codelineno-59-25 href=#__codelineno-59-25></a><span class=go>2020-01-02 00:00:00+00:00  2.000000e-01</span>
</span><span id=__span-59-26><a id=__codelineno-59-26 name=__codelineno-59-26 href=#__codelineno-59-26></a><span class=go>2020-01-03 00:00:00+00:00  2.000000e-01</span>
</span><span id=__span-59-27><a id=__codelineno-59-27 name=__codelineno-59-27 href=#__codelineno-59-27></a><span class=go>...                                 ...</span>
</span><span id=__span-59-28><a id=__codelineno-59-28 name=__codelineno-59-28 href=#__codelineno-59-28></a><span class=go>2020-12-29 00:00:00+00:00  9.004152e-09</span>
</span><span id=__span-59-29><a id=__codelineno-59-29 name=__codelineno-59-29 href=#__codelineno-59-29></a><span class=go>2020-12-30 00:00:00+00:00  0.000000e+00</span>
</span><span id=__span-59-30><a id=__codelineno-59-30 name=__codelineno-59-30 href=#__codelineno-59-30></a><span class=go>2020-12-31 00:00:00+00:00  0.000000e+00</span>
</span><span id=__span-59-31><a id=__codelineno-59-31 name=__codelineno-59-31 href=#__codelineno-59-31></a>
</span><span id=__span-59-32><a id=__codelineno-59-32 name=__codelineno-59-32 href=#__codelineno-59-32></a><span class=go>[366 rows x 5 columns]</span>
</span></code></pre></div> <p>Notice that the calculation still takes quite a bit of time, even though we have reduced the total number of reallocation timestamps by a factor of 24.</p> <p>Next, let's bring these weights back to the original time frame:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span> <span class=o>=</span> <span class=n>down_weights</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>realign</span><span class=p>(</span>
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>,</span>
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=gp>... </span>    <span class=n>freq</span><span class=o>=</span><span class=s2>&quot;1h&quot;</span><span class=p>,</span>
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a><span class=gp>... </span>    <span class=n>source_rbound</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a><span class=gp>... </span>    <span class=n>target_rbound</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-60-6><a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a><span class=gp>... </span>    <span class=n>ffill</span><span class=o>=</span><span class=kc>False</span>  <span class=c1># (2)!</span>
</span><span id=__span-60-7><a id=__codelineno-60-7 name=__codelineno-60-7 href=#__codelineno-60-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-60-8><a id=__codelineno-60-8 name=__codelineno-60-8 href=#__codelineno-60-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>weights</span>
</span><span id=__span-60-9><a id=__codelineno-60-9 name=__codelineno-60-9 href=#__codelineno-60-9></a><span class=go>symbol                     ADAUSDT  BNBUSDT   BTCUSDT  ETHUSDT  XRPUSDT</span>
</span><span id=__span-60-10><a id=__codelineno-60-10 name=__codelineno-60-10 href=#__codelineno-60-10></a><span class=go>Open time</span>
</span><span id=__span-60-11><a id=__codelineno-60-11 name=__codelineno-60-11 href=#__codelineno-60-11></a><span class=go>2020-01-01 00:00:00+00:00      NaN      NaN       NaN      NaN      NaN</span>
</span><span id=__span-60-12><a id=__codelineno-60-12 name=__codelineno-60-12 href=#__codelineno-60-12></a><span class=go>2020-01-01 01:00:00+00:00      NaN      NaN       NaN      NaN      NaN</span>
</span><span id=__span-60-13><a id=__codelineno-60-13 name=__codelineno-60-13 href=#__codelineno-60-13></a><span class=go>2020-01-01 02:00:00+00:00      NaN      NaN       NaN      NaN      NaN</span>
</span><span id=__span-60-14><a id=__codelineno-60-14 name=__codelineno-60-14 href=#__codelineno-60-14></a><span class=go>...                            ...      ...       ...      ...      ...</span>
</span><span id=__span-60-15><a id=__codelineno-60-15 name=__codelineno-60-15 href=#__codelineno-60-15></a><span class=go>2020-12-31 21:00:00+00:00      NaN      NaN       NaN      NaN      NaN</span>
</span><span id=__span-60-16><a id=__codelineno-60-16 name=__codelineno-60-16 href=#__codelineno-60-16></a><span class=go>2020-12-31 22:00:00+00:00      NaN      NaN       NaN      NaN      NaN</span>
</span><span id=__span-60-17><a id=__codelineno-60-17 name=__codelineno-60-17 href=#__codelineno-60-17></a><span class=go>2020-12-31 23:00:00+00:00      0.0      0.0  0.655105      0.0      0.0</span>
</span><span id=__span-60-18><a id=__codelineno-60-18 name=__codelineno-60-18 href=#__codelineno-60-18></a>
</span><span id=__span-60-19><a id=__codelineno-60-19 name=__codelineno-60-19 href=#__codelineno-60-19></a><span class=go>[8766 rows x 5 columns]</span>
</span></code></pre></div> <ol> <li>We are working with the close price, so set the right bound of each bar.</li> <li>Do not forward-fill to avoid rebalancing at every timestamp.</li> </ol> <p>This array is now ready to be used in a simulation.</p> <p>To simplify this workflow, VBT provides the class method <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer.from_universal_algo>PortfolioOptimizer.from_universal_algo</a>, which runs the full simulation with Universal Portfolios and, once finished, selects allocations at specific dates from the resulting DataFrame. By default, it selects timestamps with non-NA, non-repeating weights. The method requires an algorithm (<code>algo</code>) and the pricing data (<code>S</code>) as input. The algorithm can be provided in several forms: as the name or instance of the algorithm class (which must be a subclass of <code>universal.algo.Algo</code>), or as the result of the algorithm (a <code>universal.result.AlgoResult</code> object).</p> <p>Let's run the same algorithm as above, but now using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer>PortfolioOptimizer</a>. We will also try several values for <code>n</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>WarningsFiltered</span><span class=p>():</span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a><span class=gp>... </span>    <span class=n>down_pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_universal_algo</span><span class=p>(</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a><span class=gp>... </span>        <span class=s2>&quot;DynamicCRP&quot;</span><span class=p>,</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=gp>... </span>        <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s2>&quot;D&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>last</span><span class=p>(),</span>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=gp>... </span>        <span class=n>n</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>([</span><span class=mi>7</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>90</span><span class=p>]),</span>
</span><span id=__span-61-6><a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a><span class=gp>... </span>        <span class=n>min_history</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span>
</span><span id=__span-61-7><a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a><span class=gp>... </span>        <span class=n>metric</span><span class=o>=</span><span class=s1>&#39;sharpe&#39;</span><span class=p>,</span>
</span><span id=__span-61-8><a id=__codelineno-61-8 name=__codelineno-61-8 href=#__codelineno-61-8></a><span class=gp>... </span>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.01</span>
</span><span id=__span-61-9><a id=__codelineno-61-9 name=__codelineno-61-9 href=#__codelineno-61-9></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-61-10><a id=__codelineno-61-10 name=__codelineno-61-10 href=#__codelineno-61-10></a>
</span><span id=__span-61-11><a id=__codelineno-61-11 name=__codelineno-61-11 href=#__codelineno-61-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>down_pfo</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>column</span><span class=o>=</span><span class=mi>90</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Group 4/4</p> </div> </div> </p> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/universal.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/universal.dark.svg#only-dark></p> <p>You can upsample the optimizer back to the original time frame by creating an instance of <a href=https://vectorbt.pro/pvt_41531c19/api/base/resampling/base/#vectorbtpro.base.resampling.base.Resampler>Resampler</a> and passing it to <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/base/#vectorbtpro.portfolio.pfopt.base.PortfolioOptimizer.resample>PortfolioOptimizer.resample</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>resampler</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Resampler</span><span class=p>(</span>
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a><span class=gp>... </span>    <span class=n>down_pfo</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>,</span>
</span><span id=__span-62-3><a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>,</span>
</span><span id=__span-62-4><a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a><span class=gp>... </span>    <span class=n>target_freq</span><span class=o>=</span><span class=s2>&quot;1h&quot;</span>
</span><span id=__span-62-5><a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-62-6><a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span> <span class=o>=</span> <span class=n>down_pfo</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=n>resampler</span><span class=p>)</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>An allocation made at the end of a daily bar will be placed at the end of the first hourly bar on that day. This may not be desired if the allocation uses information from that daily bar. To address this, calculate and use the right bounds of both indexes with <a href=https://vectorbt.pro/pvt_41531c19/api/base/resampling/base/#vectorbtpro.base.resampling.base.Resampler.get_rbound_index>Resampler.get_rbound_index</a>.</p> </div> <p>Finally, use the new optimizer in a simulation:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>pfo</span><span class=o>.</span><span class=n>simulate</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s2>&quot;1h&quot;</span><span class=p>)</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a>
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-63-4><a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=go>n</span>
</span><span id=__span-63-5><a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a><span class=go>7     2.913174</span>
</span><span id=__span-63-6><a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a><span class=go>14    3.456085</span>
</span><span id=__span-63-7><a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a><span class=go>30    3.276883</span>
</span><span id=__span-63-8><a id=__codelineno-63-8 name=__codelineno-63-8 href=#__codelineno-63-8></a><span class=go>90    2.176654</span>
</span><span id=__span-63-9><a id=__codelineno-63-9 name=__codelineno-63-9 href=#__codelineno-63-9></a><span class=go>Name: sharpe_ratio, dtype: float64</span>
</span></code></pre></div> <h3 id=custom-algorithm>Custom algorithm<a class=headerlink href=#custom-algorithm title="Permanent link">&para;</a></h3> <p>Let's create a mean-reversion algorithm using Universal Portfolios. The idea is that stocks that have performed poorly will revert to the mean and may achieve higher returns than those trading above their mean.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>universal.algo</span><span class=w> </span><span class=kn>import</span> <span class=n>Algo</span>
</span><span id=__span-64-2><a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>
</span><span id=__span-64-3><a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>class</span><span class=w> </span><span class=nc>MeanReversion</span><span class=p>(</span><span class=n>Algo</span><span class=p>):</span>
</span><span id=__span-64-4><a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=gp>... </span>    <span class=n>PRICE_TYPE</span> <span class=o>=</span> <span class=s1>&#39;log&#39;</span>
</span><span id=__span-64-5><a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=gp>... </span>    
</span><span id=__span-64-6><a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a><span class=gp>... </span>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span><span id=__span-64-7><a id=__codelineno-64-7 name=__codelineno-64-7 href=#__codelineno-64-7></a><span class=gp>... </span>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=n>n</span>
</span><span id=__span-64-8><a id=__codelineno-64-8 name=__codelineno-64-8 href=#__codelineno-64-8></a><span class=gp>... </span>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>min_history</span><span class=o>=</span><span class=n>n</span><span class=p>)</span>
</span><span id=__span-64-9><a id=__codelineno-64-9 name=__codelineno-64-9 href=#__codelineno-64-9></a><span class=gp>... </span>    
</span><span id=__span-64-10><a id=__codelineno-64-10 name=__codelineno-64-10 href=#__codelineno-64-10></a><span class=gp>... </span>    <span class=k>def</span><span class=w> </span><span class=nf>init_weights</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cols</span><span class=p>):</span>
</span><span id=__span-64-11><a id=__codelineno-64-11 name=__codelineno-64-11 href=#__codelineno-64-11></a><span class=gp>... </span>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>cols</span><span class=p>)),</span> <span class=n>cols</span><span class=p>)</span>
</span><span id=__span-64-12><a id=__codelineno-64-12 name=__codelineno-64-12 href=#__codelineno-64-12></a><span class=gp>... </span>    
</span><span id=__span-64-13><a id=__codelineno-64-13 name=__codelineno-64-13 href=#__codelineno-64-13></a><span class=gp>... </span>    <span class=k>def</span><span class=w> </span><span class=nf>step</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>last_b</span><span class=p>,</span> <span class=n>history</span><span class=p>):</span>
</span><span id=__span-64-14><a id=__codelineno-64-14 name=__codelineno-64-14 href=#__codelineno-64-14></a><span class=gp>... </span>        <span class=n>ma</span> <span class=o>=</span> <span class=n>history</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=bp>self</span><span class=o>.</span><span class=n>n</span><span class=p>:]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span><span id=__span-64-15><a id=__codelineno-64-15 name=__codelineno-64-15 href=#__codelineno-64-15></a><span class=gp>... </span>        <span class=n>delta</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>ma</span>
</span><span id=__span-64-16><a id=__codelineno-64-16 name=__codelineno-64-16 href=#__codelineno-64-16></a><span class=gp>... </span>        <span class=n>w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=o>-</span><span class=n>delta</span><span class=p>,</span> <span class=mf>0.</span><span class=p>)</span>
</span><span id=__span-64-17><a id=__codelineno-64-17 name=__codelineno-64-17 href=#__codelineno-64-17></a><span class=gp>... </span>        <span class=k>return</span> <span class=n>w</span> <span class=o>/</span> <span class=nb>sum</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-64-18><a id=__codelineno-64-18 name=__codelineno-64-18 href=#__codelineno-64-18></a>
</span><span id=__span-64-19><a id=__codelineno-64-19 name=__codelineno-64-19 href=#__codelineno-64-19></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>WarningsFiltered</span><span class=p>():</span>
</span><span id=__span-64-20><a id=__codelineno-64-20 name=__codelineno-64-20 href=#__codelineno-64-20></a><span class=gp>... </span>    <span class=n>pfo</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PortfolioOptimizer</span><span class=o>.</span><span class=n>from_universal_algo</span><span class=p>(</span>
</span><span id=__span-64-21><a id=__codelineno-64-21 name=__codelineno-64-21 href=#__codelineno-64-21></a><span class=gp>... </span>        <span class=n>MeanReversion</span><span class=p>,</span>
</span><span id=__span-64-22><a id=__codelineno-64-22 name=__codelineno-64-22 href=#__codelineno-64-22></a><span class=gp>... </span>        <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s2>&quot;D&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>last</span><span class=p>(),</span>  <span class=c1># (1)!</span>
</span><span id=__span-64-23><a id=__codelineno-64-23 name=__codelineno-64-23 href=#__codelineno-64-23></a><span class=gp>... </span>        <span class=n>n</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>  <span class=c1># (2)!</span>
</span><span id=__span-64-24><a id=__codelineno-64-24 name=__codelineno-64-24 href=#__codelineno-64-24></a><span class=gp>... </span>        <span class=n>every</span><span class=o>=</span><span class=s2>&quot;W&quot;</span>  <span class=c1># (3)!</span>
</span><span id=__span-64-25><a id=__codelineno-64-25 name=__codelineno-64-25 href=#__codelineno-64-25></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-64-26><a id=__codelineno-64-26 name=__codelineno-64-26 href=#__codelineno-64-26></a>
</span><span id=__span-64-27><a id=__codelineno-64-27 name=__codelineno-64-27 href=#__codelineno-64-27></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pfo</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Data frequency is daily.</li> <li>Window length (in days).</li> <li>Allocate at the beginning of each week.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/universal_custom.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/pf-opt/universal_custom.dark.svg#only-dark></p> <p>Now it's your turn: try creating and implementing a simple optimization strategy that could work in the real world. You may be surprised by how complex and fascinating some strategies can become after starting with something very basic <img alt=🙂 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f642.svg title=:slightly_smiling_face:></p> <p><a class=md-button href=https://vectorbt.pro/pvt_41531c19/assets/jupytext/tutorials/portfolio-optimization/integrations.py.txt target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"/></svg></span> Python code</a> <a class=md-button href=https://github.com/polakowo/vectorbt.pro/blob/notebooks/PortfolioOptimization.ipynb target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg></span> Notebook</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Portfolio optimization"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Portfolio optimization </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/dynamic/ class="md-footer__link md-footer__link--next" aria-label="Next: Dynamic"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Dynamic </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/integrations/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:59 GMT -->
</html>