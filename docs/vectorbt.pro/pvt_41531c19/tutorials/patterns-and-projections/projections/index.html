<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/projections/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Learn about generating projections using VectorBT PRO"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/tutorials/patterns-and-projections/projections/ rel=canonical><link href=../patterns/index.html rel=prev><link href=../../cross-validation/index.html rel=next><link rel=icon href=../../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>Projections - VectorBT® PRO</title><link rel=stylesheet href=../../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=Projections><meta property=og:type content=website><meta content=https://vectorbt.pro/tutorials/patterns-and-projections/projections/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Learn about generating projections using VectorBT PRO"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#projections class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-header__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBT® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Projections </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-nav__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBT® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/basic-rsi/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3.5 18.5 6-6 4 4L22 6.92 20.59 5.5l-7.09 8-4-4L2 17z"/></svg> <span class=md-ellipsis> Basic RSI strategy </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/superfast-supertrend/ class=md-nav__link> <span class=md-ellipsis> SuperFast SuperTrend </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/signal-development/generation/ class=md-nav__link> <span class=md-ellipsis> Signal development </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/stop-signals/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 23h-2V1h2zm-4-4H5V5h4V3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h4zM19 7v2h2V7zm0-2h2a2 2 0 0 0-2-2zm2 10h-2v2h2zm-2-4v2h2v-2zm-2-8h-2v2h2zm2 18c1.11 0 2-.89 2-2h-2zm-2-2h-2v2h2z"/></svg> <span class=md-ellipsis> Stop signals </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/mtf-analysis/ class=md-nav__link> <span class=md-ellipsis> MTF analysis </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/portfolio-optimization/ class=md-nav__link> <span class=md-ellipsis> Portfolio optimization </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/pairs-trading/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 6.92 20.59 5.5l-2.85 3.22C15.68 6.4 12.83 5 9.61 5 6.72 5 4.07 6.16 2 8l1.42 1.42C5.12 7.93 7.27 7 9.61 7c2.74 0 5.09 1.26 6.77 3.24L13.5 13.5l-4-4L2 17l1.5 1.5 6-6 4 4 4.05-4.57c.75 1.35 1.25 2.9 1.45 4.57h2c-.22-2.32-.95-4.41-2.04-6.16z"/></svg> <span class=md-ellipsis> Pairs trading </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_9 checked> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex=0> <span class=md-ellipsis> Patterns and projections </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_9_label aria-expanded=true> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Patterns and projections </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/patterns/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 7.5-6.47-.54L14 1l-2.53 5.96L5 7.5l4.9 4.27-1.46 6.33L14 14.74l5.56 3.36-1.47-6.33zm-6.86 4.73.4 1.71-1.51-.91-1.03-.62-1.03.62-1.51.91.39-1.71.28-1.18-.91-.79L9.88 9.1l1.76-.15 1.2-.1.47-1.11.69-1.62.69 1.62.47 1.11 1.2.1 1.75.15-1.33 1.16-.92.79zM1.16 12c-.299-.5-.171-1.11.29-1.41l2.73-1.8 1.57 1.36-3.2 2.11c-.17.11-.36.17-.55.17-.32 0-.64-.16-.84-.43m.29 8.16 5.86-3.85L7 17.76l-.34 1.37-4.11 2.71c-.17.11-.36.16-.55.16-.32 0-.64-.16-.84-.45a1.013 1.013 0 0 1 .29-1.39m5.87-8.66.92.81-.27 1.19-5.42 3.55c-.17.11-.36.16-.55.16-.32 0-.64-.15-.84-.45a1 1 0 0 1 .29-1.38z"/></svg> <span class=md-ellipsis> Patterns </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 7.5-6.47-.54L14 1l-2.53 5.96L5 7.5l4.9 4.27-1.46 6.33L14 14.74l5.56 3.36-1.47-6.33zm-6.86 4.73.4 1.71-1.51-.91-1.03-.62-1.03.62-1.51.91.39-1.71.28-1.18-.91-.79L9.88 9.1l1.76-.15 1.2-.1.47-1.11.69-1.62.69 1.62.47 1.11 1.2.1 1.75.15-1.33 1.16-.92.79zM1.16 12c-.299-.5-.171-1.11.29-1.41l2.73-1.8 1.57 1.36-3.2 2.11c-.17.11-.36.17-.55.17-.32 0-.64-.16-.84-.43m.29 8.16 5.86-3.85L7 17.76l-.34 1.37-4.11 2.71c-.17.11-.36.16-.55.16-.32 0-.64-.16-.84-.45a1.013 1.013 0 0 1 .29-1.39m5.87-8.66.92.81-.27 1.19-5.42 3.55c-.17.11-.36.16-.55.16-.32 0-.64-.15-.84-.45a1 1 0 0 1 .29-1.38z"/></svg> <span class=md-ellipsis> Projections </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/projections/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 7.5-6.47-.54L14 1l-2.53 5.96L5 7.5l4.9 4.27-1.46 6.33L14 14.74l5.56 3.36-1.47-6.33zm-6.86 4.73.4 1.71-1.51-.91-1.03-.62-1.03.62-1.51.91.39-1.71.28-1.18-.91-.79L9.88 9.1l1.76-.15 1.2-.1.47-1.11.69-1.62.69 1.62.47 1.11 1.2.1 1.75.15-1.33 1.16-.92.79zM1.16 12c-.299-.5-.171-1.11.29-1.41l2.73-1.8 1.57 1.36-3.2 2.11c-.17.11-.36.17-.55.17-.32 0-.64-.16-.84-.43m.29 8.16 5.86-3.85L7 17.76l-.34 1.37-4.11 2.71c-.17.11-.36.16-.55.16-.32 0-.64-.16-.84-.45a1.013 1.013 0 0 1 .29-1.39m5.87-8.66.92.81-.27 1.19-5.42 3.55c-.17.11-.36.16-.55.16-.32 0-.64-.15-.84-.45a1 1 0 0 1 .29-1.38z"/></svg> <span class=md-ellipsis> Projections </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pattern-projections class=md-nav__link> <span class=md-ellipsis> Pattern projections </span> </a> </li> <li class=md-nav__item> <a href=#delta-projections class=md-nav__link> <span class=md-ellipsis> Delta projections </span> </a> </li> <li class=md-nav__item> <a href=#plotting class=md-nav__link> <span class=md-ellipsis> Plotting </span> </a> <nav class=md-nav aria-label=Plotting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#colorization class=md-nav__link> <span class=md-ellipsis> Colorization </span> </a> </li> <li class=md-nav__item> <a href=#bands class=md-nav__link> <span class=md-ellipsis> Bands </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filtering class=md-nav__link> <span class=md-ellipsis> Filtering </span> </a> </li> <li class=md-nav__item> <a href=#latest-projections class=md-nav__link> <span class=md-ellipsis> Latest projections </span> </a> <nav class=md-nav aria-label="Latest projections"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quick-plotting class=md-nav__link> <span class=md-ellipsis> Quick plotting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#non-uniform-projections class=md-nav__link> <span class=md-ellipsis> Non-uniform projections </span> </a> <nav class=md-nav aria-label="Non-uniform projections"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#shrinking class=md-nav__link> <span class=md-ellipsis> Shrinking </span> </a> </li> <li class=md-nav__item> <a href=#stretching class=md-nav__link> <span class=md-ellipsis> Stretching </span> </a> </li> <li class=md-nav__item> <a href=#quick-plotting_1 class=md-nav__link> <span class=md-ellipsis> Quick plotting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#open-projections class=md-nav__link> <span class=md-ellipsis> Open projections </span> </a> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/cross-validation/ class=md-nav__link> <span class=md-ellipsis> Cross-validation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/more-tutorials/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10.6 13.4a1 1 0 0 1-1.4 1.4 4.8 4.8 0 0 1 0-7l3.5-3.6a5.1 5.1 0 0 1 7.1 0 5.1 5.1 0 0 1 0 7.1l-1.5 1.5a6.4 6.4 0 0 0-.4-2.4l.5-.5a3.2 3.2 0 0 0 0-4.3 3.2 3.2 0 0 0-4.3 0l-3.5 3.6a2.9 2.9 0 0 0 0 4.2M23 18v2h-3v3h-2v-3h-3v-2h3v-3h2v3m-3.8-4.3a4.8 4.8 0 0 0-1.4-4.5 1 1 0 0 0-1.4 1.4 2.9 2.9 0 0 1 0 4.2l-3.5 3.6a3.2 3.2 0 0 1-4.3 0 3.2 3.2 0 0 1 0-4.3l.5-.4a7.3 7.3 0 0 1-.4-2.5l-1.5 1.5a5.1 5.1 0 0 0 0 7.1 5.1 5.1 0 0 0 7.1 0l1.8-1.8a6 6 0 0 1 3.1-4.3"/></svg> <span class=md-ellipsis> More tutorials </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/to-be-continued/ class=md-nav__link> <span class=md-ellipsis> To be continued... </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-path__link> <span class=md-ellipsis> Tutorials </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/patterns/ class=md-path__link> <span class=md-ellipsis> Patterns and projections </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=projections><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 7.5-6.47-.54L14 1l-2.53 5.96L5 7.5l4.9 4.27-1.46 6.33L14 14.74l5.56 3.36-1.47-6.33zm-6.86 4.73.4 1.71-1.51-.91-1.03-.62-1.03.62-1.51.91.39-1.71.28-1.18-.91-.79L9.88 9.1l1.76-.15 1.2-.1.47-1.11.69-1.62.69 1.62.47 1.11 1.2.1 1.75.15-1.33 1.16-.92.79zM1.16 12c-.299-.5-.171-1.11.29-1.41l2.73-1.8 1.57 1.36-3.2 2.11c-.17.11-.36.17-.55.17-.32 0-.64-.16-.84-.43m.29 8.16 5.86-3.85L7 17.76l-.34 1.37-4.11 2.71c-.17.11-.36.16-.55.16-.32 0-.64-.16-.84-.45a1.013 1.013 0 0 1 .29-1.39m5.87-8.66.92.81-.27 1.19-5.42 3.55c-.17.11-.36.16-.55.16-.32 0-.64-.15-.84-.45a1 1 0 0 1 .29-1.38z"/></svg></span> Projections<a class=headerlink href=#projections title="Permanent link">&para;</a></h1> <p>Given a set of detected patterns, how can we determine if they give us an edge? One approach is to backtest them using signals and analyze the resulting trades, but the performance of each trade will also depend on the chosen backtesting parameters and the outcomes of previous trades. However, what we really need are clear statistics that rely solely on the price movement following each pattern. Here is a simplified workflow: capture the price movement (also called a projection) for a set number of bars after each pattern, store them all in a single array (called projections), and run various statistics on that array. The main idea is that if the pattern is effective, the price will generally rise or fall depending on whether the pattern is bullish or bearish. In this case, "generally" refers to the median return, which is just one of many statistics you can analyze.</p> <p>Projections represent the price movement over a specified period of time. Since time periods are best handled using range records of the type <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges>Ranges</a>, we can easily map each range to a projection. The Numba-compiled function that performs this task is <a href=https://vectorbt.pro/pvt_41531c19/api/generic/nb/records/#vectorbtpro.generic.nb.records.map_ranges_to_projections_nb>map_ranges_to_projections_nb</a>. It takes the close price (or any other price), information on each range, and returns a two-dimensional NumPy array where each <em>row</em> is a single projection. Before using this function, let's find all the ranges in which the price increased by 20% within 7 days. We will allow this requirement to deviate by up to 1%:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span> <span class=o>=</span> <span class=n>price</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>find_pattern</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>],</span> 
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> 
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>rescale_mode</span><span class=o>=</span><span class=s2>&quot;rebase&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>max_error</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>max_error_interp_mode</span><span class=o>=</span><span class=s2>&quot;discrete&quot;</span><span class=p>,</span>  <span class=c1># (2)!</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>max_error_strict</span><span class=o>=</span><span class=kc>True</span>  <span class=c1># (3)!</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=go>3</span>
</span></code></pre></div> <ol> <li>Use this mode to search for a specific percentage change.</li> <li>Apply the 1% requirement only to the last point in the pattern array.</li> <li>Any violation of the 1% requirement will cause the range to be skipped.</li> </ol> <h2 id=pattern-projections>Pattern projections<a class=headerlink href=#pattern-projections title="Permanent link">&para;</a></h2> <p>Let's call the Numba-compiled function on the pattern ranges we generated above. This operation builds projections from the price <strong>inside</strong> each range, meaning each projection should be highly similar to our pattern:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>range_idxs</span><span class=p>,</span> <span class=n>raw_projections</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>nb</span><span class=o>.</span><span class=n>map_ranges_to_projections_nb</span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>to_2d_array</span><span class=p>(</span><span class=n>price</span><span class=p>),</span>  <span class=c1># (1)!</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=gp>... </span>    <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_field_arr</span><span class=p>(</span><span class=s2>&quot;col&quot;</span><span class=p>),</span>  <span class=c1># (2)!</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=gp>... </span>    <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_field_arr</span><span class=p>(</span><span class=s2>&quot;start_idx&quot;</span><span class=p>),</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=gp>... </span>    <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_field_arr</span><span class=p>(</span><span class=s2>&quot;end_idx&quot;</span><span class=p>),</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=gp>... </span>    <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_field_arr</span><span class=p>(</span><span class=s2>&quot;status&quot;</span><span class=p>)</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>range_idxs</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=go>array([0, 1, 2])</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>raw_projections</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=go>array([[1.        , 1.00936136, 1.0528197 , 1.11080047, 1.12247632,</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=go>        1.13616486, 1.18824968, 1.16303367],</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=go>       [1.        , 1.03041164, 1.07854881, 1.08766541, 1.14380648,</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=go>        1.17483528, 1.20173755, 1.11737666],</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=go>       [1.        , 1.02418635, 1.10605106, 1.12944688, 1.17161711,</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=go>        1.17323145, 1.20239992, 1.22269832]])</span>
</span></code></pre></div> <ol> <li>A two-dimensional NumPy array is expected.</li> <li>Use <a href=https://vectorbt.pro/pvt_41531c19/api/records/base/#vectorbtpro.records.base.Records.get_field_arr>Records.get_field_arr</a> to extract any field as a one-dimensional NumPy array. It will have the same number of values as there are ranges in the record array, one per range.</li> </ol> <p>Here is what happened: the function iterated through each range, selected the corresponding price subset within that range, and stored that price subset in the output array. By default, it also rebased all projections to <code>1</code> to make them comparable. Additionally, it returned an array of indices that link the passed ranges to the returned projections.</p> <p>To avoid manually preparing input and output data, an extra-convenient method <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.get_projections>Ranges.get_projections</a> returns a Series or DataFrame with projections as <em>columns</em>, labeled accordingly:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=go>range_id                          0         1         2</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=go>2022-05-31 00:00:00+00:00  1.000000  1.000000  1.000000</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>2022-06-01 00:00:00+00:00  1.009361  1.030412  1.024186</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=go>2022-06-02 00:00:00+00:00  1.052820  1.078549  1.106051</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>2022-06-03 00:00:00+00:00  1.110800  1.087665  1.129447</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>2022-06-04 00:00:00+00:00  1.122476  1.143806  1.171617</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>2022-06-05 00:00:00+00:00  1.136165  1.174835  1.173231</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>2022-06-06 00:00:00+00:00  1.188250  1.201738  1.202400</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>2022-06-07 00:00:00+00:00  1.163034  1.117377  1.222698</span>
</span></code></pre></div> <p>If you look at the DataFrame's index above, you will see that it starts with the last index in the price. This is because projections are meant to be <em>projected</em> into the future. You will also notice there are 8 elements, even though our patterns are set to be 7 bars long:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span><span class=o>.</span><span class=n>duration</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=go>array([7, 7, 7])</span>
</span></code></pre></div> <p>This happens because the first element (<code>1</code>) is treated as the base of each projection and is not counted as part of the number of projected entries, which defaults to the duration of the range. If you want to analyze only the duration of the range, you can disable this behavior by setting <code>incl_end_idx</code> to <code>False</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span><span class=n>incl_end_idx</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>range_id                          0         1         2</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go>2022-05-31 00:00:00+00:00  1.000000  1.000000  1.000000</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>2022-06-01 00:00:00+00:00  1.009361  1.030412  1.024186</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go>2022-06-02 00:00:00+00:00  1.052820  1.078549  1.106051</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>2022-06-03 00:00:00+00:00  1.110800  1.087665  1.129447</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>2022-06-04 00:00:00+00:00  1.122476  1.143806  1.171617</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>2022-06-05 00:00:00+00:00  1.136165  1.174835  1.173231</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=go>2022-06-06 00:00:00+00:00  1.188250  1.201738  1.202400</span>
</span></code></pre></div> <p>Now you can observe the cumulative returns of each price range that fits our pattern. This data format allows you to apply many data analysis techniques to assess the quality of the pattern. For example, let's get the total return of each range:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=go>range_id</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=go>0    0.188250</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=go>1    0.201738</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=go>2    0.202400</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=go>dtype: float64</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>You might wonder why the first return is 18.8% even though the maximum error requires it to be within 19% and 21%. The 1% requirement is not defined relative to the total return, but relative to the percentage change between the price and the pattern at the respective point.</p> </div> <p>And here is the visualization:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/pattern_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/pattern_projections.dark.svg#only-dark></p> <p>As you can see, each price range fits the pattern quite well.</p> <h2 id=delta-projections>Delta projections<a class=headerlink href=#delta-projections title="Permanent link">&para;</a></h2> <p>The main use case for projections is not debugging patterns, but analyzing their effect on price to see whether they provide alpha and outperform randomness consistently, even if only slightly. Since projections are taken from between the start and end row of each range, we need to shift the range of each detected pattern so it starts at the last point, and has a specific duration (= delta) that we want to analyze. This is handled by the class method <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.from_delta>Ranges.from_delta</a> and the instance method <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.with_delta>Ranges.with_delta</a>, which is based on the former. Let's create new ranges that start at the last point in each pattern range and end after a duration of 4 bars, meaning we want to analyze the impact of our pattern 4 bars into the future:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta_ranges</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>with_delta</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span></code></pre></div> <ol> <li>Delta can also be specified as a timedelta, for example, "4d".</li> </ol> <p>To better understand how the newly created ranges relate to the pattern ranges they were generated from, let's visualize both range types between January and March 2021:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s2>&quot;2021-01&quot;</span><span class=p>:</span><span class=s2>&quot;2021-03&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta_ranges</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s2>&quot;2021-01&quot;</span><span class=p>:</span><span class=s2>&quot;2021-03&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>... </span>    <span class=n>plot_ohlc</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=gp>... </span>    <span class=n>plot_close</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=gp>... </span>    <span class=n>plot_markers</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=gp>... </span>    <span class=n>closed_shape_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>fillcolor</span><span class=o>=</span><span class=s2>&quot;DeepSkyBlue&quot;</span><span class=p>),</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=gp>... </span>    <span class=n>fig</span><span class=o>=</span><span class=n>fig</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/delta_ranges.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/delta_ranges.dark.svg#only-dark></p> <p>We see that the "DeepSkyBlue" colored ranges start from the last point in the pattern range and last for 4 bars. Why not have them start after the last point in the range to avoid overlaps? Remember that the first point in each projection is the base point (<code>1</code>) from which the actual projections propagate, so this base point should be the last pattern point. Let's generate projections once again:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>delta_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=go>range_id                          0         1         2</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=go>2022-05-31 00:00:00+00:00  1.000000  1.000000  1.000000</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=go>2022-06-01 00:00:00+00:00  0.978779  0.929801  1.016882</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=go>2022-06-02 00:00:00+00:00  1.108145  0.864097  0.992104</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=go>2022-06-03 00:00:00+00:00  1.178824  0.864522  0.963215</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=go>2022-06-04 00:00:00+00:00  1.147739  0.851382  0.941327</span>
</span></code></pre></div> <p>These three columns contain the price development for 4 bars after their respective pattern and are now perfectly analyzable. For example, we can calculate the mean total return of that development:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=go>-0.01985064245106242</span>
</span></code></pre></div> <p>We see that whenever the price rises by 20% in 7 bars, after 4 bars it tends to fall by 2% on average. If you have some statistics experience, you will quickly point out that there are too few observations to draw meaningful conclusions. So instead, let's search for a 20% price increase in windows ranging from 7 to 30 bars, allowing overlaps, and perform our analysis again on both assets:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span> <span class=o>=</span> <span class=n>mult_price</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>find_pattern</span><span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=gp>... </span>    <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>],</span> 
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=gp>... </span>    <span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> 
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=gp>... </span>    <span class=n>max_window</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=gp>... </span>    <span class=n>rescale_mode</span><span class=o>=</span><span class=s2>&quot;rebase&quot;</span><span class=p>,</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=gp>... </span>    <span class=n>max_error</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=gp>... </span>    <span class=n>max_error_interp_mode</span><span class=o>=</span><span class=s2>&quot;discrete&quot;</span><span class=p>,</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=gp>... </span>    <span class=n>max_error_strict</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=gp>... </span>    <span class=n>overlap_mode</span><span class=o>=</span><span class=s2>&quot;allow&quot;</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=go>symbol</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=go>BTCUSDT    48</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=go>ETHUSDT    64</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=go>Name: count, dtype: int64</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta_ranges</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>with_delta</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>delta_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=gp>&gt;&gt;&gt; </span><span class=p>(</span><span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>describe</span><span class=p>()</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=go>count    112.000000</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=go>mean       0.010467</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=go>std        0.079566</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=go>min       -0.203760</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=go>25%       -0.044565</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=go>50%        0.014051</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=go>75%        0.055390</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=go>max        0.270107</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=go>dtype: float64</span>
</span></code></pre></div> <p>Half the time, the total return after 4 bars is at least 1.4%.</p> <p>Since projection columns are sorted by time (the pattern ranges are sorted by the end index, and the delta ranges are sorted by the start index), we can also visualize this metric over time to observe how it changes. We just need to split this operation by symbol, because projections from multiple symbols are stacked block-wise as columns. We also need to generate projections again, but this time with the argument <code>id_level</code> set to "end_idx" to replace the column level "range_id" with the actual time of the total return:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>delta_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span><span class=n>id_level</span><span class=o>=</span><span class=s2>&quot;end_idx&quot;</span><span class=p>)</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=go>MultiIndex([(&#39;BTCUSDT&#39;, &#39;2020-08-03 00:00:00+00:00&#39;),</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=go>            (&#39;BTCUSDT&#39;, &#39;2020-08-04 00:00:00+00:00&#39;),</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=go>            (&#39;BTCUSDT&#39;, &#39;2020-08-05 00:00:00+00:00&#39;),</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=go>            ...</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=go>            (&#39;ETHUSDT&#39;, &#39;2022-04-07 00:00:00+00:00&#39;),</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=go>            (&#39;ETHUSDT&#39;, &#39;2022-04-08 00:00:00+00:00&#39;),</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=go>            (&#39;ETHUSDT&#39;, &#39;2022-04-09 00:00:00+00:00&#39;)],</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=go>           names=[&#39;symbol&#39;, &#39;end_idx&#39;], length=112)</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span> <span class=o>=</span> <span class=n>projections</span><span class=o>.</span><span class=n>xs</span><span class=p>(</span><span class=s2>&quot;BTCUSDT&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;symbol&quot;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>total_proj_return</span> <span class=o>=</span> <span class=n>btc_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=n>btc_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>total_proj_return</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>scatterplot</span><span class=p>(</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=gp>... </span>    <span class=n>trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=gp>... </span>        <span class=n>marker</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=gp>... </span>            <span class=n>color</span><span class=o>=</span><span class=n>total_proj_return</span><span class=o>.</span><span class=n>values</span><span class=p>,</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=gp>... </span>            <span class=n>colorscale</span><span class=o>=</span><span class=s2>&quot;Temps_r&quot;</span><span class=p>,</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=gp>... </span>            <span class=n>cmid</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=gp>... </span>        <span class=p>)</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-12-22><a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/total_proj_return.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/total_proj_return.dark.svg#only-dark></p> <p>We can confirm that after a 20% increase, the price mostly continues to grow over the next 4 bars.</p> <h2 id=plotting>Plotting<a class=headerlink href=#plotting title="Permanent link">&para;</a></h2> <p>But what about plotting the projections themselves? Since all projections in our array share the same index, we can plot them as regular lines. Instead of doing this manually and wasting your valuable time, there is an accessor method <a href=https://vectorbt.pro/pvt_41531c19/api/generic/accessors/#vectorbtpro.generic.accessors.GenericDFAccessor.plot_projections>GenericDFAccessor.plot_projections</a> specialized for projection visualization:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/plot_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/plot_projections.dark.svg#only-dark></p> <p>You can see the price development after each detected pattern plotted as a line.</p> <h3 id=colorization>Colorization<a class=headerlink href=#colorization title="Permanent link">&para;</a></h3> <p>Each line is colorized based on the projection's performance. By default, the color reflects the median value of the projection relative to other projections. Here is the first projection in the array as an example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=p>[</span><span class=s2>&quot;2020-08-03&quot;</span><span class=p>]</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=go>2022-05-31 00:00:00+00:00    1.000000</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=go>2022-06-01 00:00:00+00:00    1.019300</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=go>2022-06-02 00:00:00+00:00    1.053823</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=go>2022-06-03 00:00:00+00:00    1.018510</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=go>2022-06-04 00:00:00+00:00    1.015957</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=go>Freq: D, Name: 2020-08-03 00:00:00+00:00, dtype: float64</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=p>[</span><span class=s2>&quot;2020-08-03&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>()</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=go>1.018510232892989</span>
</span></code></pre></div> <p>Why use the median instead of the final value? Imagine the projection is above the baseline (<code>1</code>) 90% of the time but then falls below the baseline abruptly at the end. Should this be classified as a positive or negative performing projection? There are two factors that influence an event's impact on price: the delay before impact and the duration of the impact. Some events cause an immediate reaction in price, while for others the reaction unfolds over time. In most cases, the effect of an event lasts only for a limited period and gradually fades. Valuing projections by their last value is risky and highly dependent on the chosen projection duration, while using the median is more robust and not affected by duration.</p> <p>If you are instead interested in the final value or any other statistic, you can use the <code>colorize</code> argument. This argument accepts several modes ("median", "mean", and "last") as well as a custom function that takes a Series or DataFrame and returns a number per column. For example, let's colorize the projections by their volatility:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=gp>... </span>    <span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>colorize</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>std</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/colorize_std.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/colorize_std.dark.svg#only-dark></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you prefer shades of gray, set <code>colorize=False</code>.</p> </div> <h3 id=bands>Bands<a class=headerlink href=#bands title="Permanent link">&para;</a></h3> <p>Seeing so many projections at once does not provide much insight into the overall performance of the pattern. What we need is a way to distill the most important price changes and present them in a clear and understandable format. If we look at the array with the projections again, we quickly notice that we can reduce that array across both rows and columns. This would collapse all the projections into a single projection, where each value is a statistic computed from all projections at each bar. For example, let's calculate the median projection for one symbol and for multiple symbols:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>xs</span><span class=p>(</span><span class=s2>&quot;ETHUSDT&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;symbol&quot;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>median</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=go>2022-05-31 00:00:00+00:00    1.000000</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=go>2022-06-01 00:00:00+00:00    1.005677</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=go>2022-06-02 00:00:00+00:00    1.014560</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=go>2022-06-03 00:00:00+00:00    1.017341</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=go>2022-06-04 00:00:00+00:00    1.019444</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=go>Freq: D, dtype: float64</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s2>&quot;symbol&quot;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>median</span><span class=p>()</span>  <span class=c1># (2)!</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=go>symbol                      BTCUSDT   ETHUSDT</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=go>2022-05-31 00:00:00+00:00  1.000000  1.000000</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=go>2022-06-01 00:00:00+00:00  1.003365  1.005677</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=go>2022-06-02 00:00:00+00:00  1.001214  1.014560</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=go>2022-06-03 00:00:00+00:00  1.010576  1.017341</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=go>2022-06-04 00:00:00+00:00  1.009568  1.019444</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>median</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=go>2022-05-31 00:00:00+00:00    1.000000</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=go>2022-06-01 00:00:00+00:00    1.004447</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=go>2022-06-02 00:00:00+00:00    1.006168</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=go>2022-06-03 00:00:00+00:00    1.014375</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=go>2022-06-04 00:00:00+00:00    1.014051</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=go>Freq: D, dtype: float64</span>
</span></code></pre></div> <ol> <li>One symbol, one projection.</li> <li>Multiple symbols, multiple projections.</li> <li>Multiple symbols, one projection.</li> </ol> <p>If we can build one projection from many, we can also construct so-called confidence bands, within which a certain percentage of projections fall. Such bands are automatically displayed when calling <a href=https://vectorbt.pro/pvt_41531c19/api/generic/accessors/#vectorbtpro.generic.accessors.GenericDFAccessor.plot_projections>GenericDFAccessor.plot_projections</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/bands.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/bands.dark.svg#only-dark></p> <p>The method generates four bands: the 20% quantile, 50% quantile (median), 80% quantile, and mean for the projections. Whenever quantiles are plotted, their trace name is prefixed with <code>Q=</code>. So, what do these quantiles mean? Quantiles divide sorted data into equal parts. In this context, quantiles are calculated across all projections at each time step (<code>axis=1</code>). For example, the 20% quantile means that 20% of the values are below that threshold. The 50% quantile is typically the most important because it tells us that 50% of values are below and 50% are above that value. If the median is zero, predicting the market's movement is no better than flipping a coin. If the median is not zero, there are more projections with a positive or negative return than the other way around, which is already worth investigating.</p> <p>Quantiles are useful to explore because they not only tell us how many values fall below a certain band, but also let's determine how many values are between bands. For example, in the chart above, <code>80% - 20% = 60%</code> of values are between the upper and lower bands. This also means that only <code>100% - 80% = 20%</code> of values are above the upper band, so the probability of exceeding a return of 7% (see below) is at most one in five:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.8</span><span class=p>)</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=go>1.0702371602730685</span>
</span></code></pre></div> <p>Now that we can approximate the probability of specific market reactions to our events, such an analysis can be helpful when deciding on optimal stop loss and take profit levels. For example, depending on your risk preference, you can set the stop loss at the lowest point of the 20% quantile band. If the 30% quantile is a better match for your trading style, you can plot it as the lower band by setting the <code>plot_lower</code> argument accordingly. You can also plot it as the middle band while hiding other bands:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=gp>... </span>    <span class=n>plot_lower</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=gp>... </span>    <span class=n>plot_middle</span><span class=o>=</span><span class=s2>&quot;30%&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=gp>... </span>    <span class=n>plot_upper</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=gp>... </span>    <span class=n>plot_aux_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Supported quantile formats include <code>Q=30%</code> and <code>Q=0.3</code>.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/bands_30.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/bands_30.dark.svg#only-dark></p> <p>This means that 30% of projections are below (or 70% are above) that band.</p> <p>The middle band, like any other band argument, supports a wide range of formats. For example, instead of quantiles, you can use significance levels and <a href=https://en.wikipedia.org/wiki/Standard_score>z-scores</a>. Standard scores assume that the distribution of projection values at any point is approximately normal, which may not always be true, but can be the case, especially for shorter timeframes. To check whether any set of values is normally distributed, you can display a QQ plot:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>qqplot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/qqplot.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/qqplot.dark.svg#only-dark></p> <p>Aside from a few outliers, most points lie on the red line, indicating that the distribution of all projection values at the last bar is roughly normal. Given this, you can instruct the projection plotting method to display bands based on a certain significance level. For example, similar to the 10% quantile, specifying a (one-tailed) significance level of 10% marks where 10% of the lowest data points are contained. You can provide this percentage using the format <code>P=X%</code> or as a float <code>P=0.X</code>. Internally, this is translated into a z-score using <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html>scipy.stats.norm.ppf</a>. The z-score, or standard score, indicates the number of standard deviations from the mean. If the significance level is 95%, the z-score is <code>1.96</code>, or almost twice the volatility. To specify a z-score directly, use the format <code>Z=X</code>.</p> <p>Let's plot significance levels of 20% and 80%:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=gp>... </span>    <span class=n>plot_lower</span><span class=o>=</span><span class=s2>&quot;P=20%&quot;</span><span class=p>,</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=gp>... </span>    <span class=n>plot_middle</span><span class=o>=</span><span class=s2>&quot;P=50%&quot;</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=gp>... </span>    <span class=n>plot_upper</span><span class=o>=</span><span class=s2>&quot;P=80%&quot;</span><span class=p>,</span> 
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=gp>... </span>    <span class=n>plot_aux_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>You could also provide <code>mean</code>.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/significance_levels.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/significance_levels.dark.svg#only-dark></p> <p>If the actual distribution of projection values at each bar is normal, the probability of a new projection falling between the lower and upper bands would be 60%. But what about custom bands? Just like with the <code>colorize</code> argument, you can provide a UDF here. Let's highlight two real projections: the one that finishes better than 20% of projections, and the one that finishes better than 80% of projections.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>finishes_at_quantile</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>q</span><span class=p>):</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=gp>... </span>    <span class=n>nth_element</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>q</span> <span class=o>*</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)))</span>  <span class=c1># (1)!</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=gp>... </span>    <span class=n>nth_index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])[</span><span class=n>nth_element</span><span class=p>]</span>  <span class=c1># (2)!</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>nth_index</span><span class=p>]</span>  <span class=c1># (3)!</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=gp>... </span>    <span class=n>plot_lower</span><span class=o>=</span><span class=n>partial</span><span class=p>(</span><span class=n>finishes_at_quantile</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mf>0.2</span><span class=p>),</span>  <span class=c1># (4)!</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=gp>... </span>    <span class=n>plot_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=gp>... </span>    <span class=n>plot_upper</span><span class=o>=</span><span class=n>partial</span><span class=p>(</span><span class=n>finishes_at_quantile</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mf>0.8</span><span class=p>),</span> 
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Get the position among projections that corresponds to a certain quantile.</li> <li>Get the new indices of projections sorted by their last value, and select the quantile position.</li> <li>Return the selected projection.</li> <li>Use <a href=https://docs.python.org/3/library/functools.html#functools.partial>functools.partial</a> to return <code>finishes_at_quantile</code> with <code>q</code> set to a predefined value.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/custom_bands.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/custom_bands.dark.svg#only-dark></p> <p>This shows why the final (or any other specific) performance is not always representative of the overall performance: even though the upper band finished in the top 20% of projections by their final value, it spent most of the time below the baseline.</p> <h2 id=filtering>Filtering<a class=headerlink href=#filtering title="Permanent link">&para;</a></h2> <p>We do not always want to analyze the entire projection array. What if we are only interested in projections that cross a certain threshold within a specific period of time? Let's filter and display both <code>BTCUSDT</code> and <code>ETHUSDT</code> projections that crossed a 5% return threshold at any point during the first two bars:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>crossed_mask</span> <span class=o>=</span> <span class=n>projections</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mf>1.05</span>  <span class=c1># (1)!</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>filt_projections</span> <span class=o>=</span> <span class=n>projections</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>crossed_mask</span><span class=p>]</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>filt_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>describe</span><span class=p>()</span>  <span class=c1># (2)!</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=go>count    8.000000</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=go>mean     1.095870</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=go>std      0.084343</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=go>min      0.955078</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=go>25%      1.059109</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=go>50%      1.092623</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=go>75%      1.139190</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=go>max      1.214039</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=go>Name: 2022-06-04 00:00:00+00:00, dtype: float64</span>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>filt_projections</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>crossed_mask</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Get the mask for projections whose highest high at the second position is above the value <code>1.05</code>.</li> <li>Assess the final performance of the filtered projections.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/filtering.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/filtering.dark.svg#only-dark></p> <p>If the price increased by 5% during the first two bars after our pattern, 80% of the found occurrences remained above that 5% mark, 50% crossed the 9% mark, and every fourth occurrence even passed the 14% mark after four bars.</p> <h2 id=latest-projections>Latest projections<a class=headerlink href=#latest-projections title="Permanent link">&para;</a></h2> <p>So far, we have discussed projection analysis for patterns and periods that follow them, but there is a use case that requires special handling: patterns based on the latest price. The idea is to find similar occurrences of the most recent price movements so we can project them into the future and make predictions. Let's select the most recent 7-bar date range from our <code>BTCUSDT</code> data for prediction. We will manually set search configs and use rescaling through rebasing to search for occurrences that match our pattern in both shape and magnitude:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span> <span class=o>=</span> <span class=n>price</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>find_pattern</span><span class=p>(</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=gp>... </span>    <span class=n>pattern</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>7</span><span class=p>:],</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=gp>... </span>    <span class=n>rescale_mode</span><span class=o>=</span><span class=s2>&quot;rebase&quot;</span><span class=p>,</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=gp>... </span>    <span class=n>overlap_mode</span><span class=o>=</span><span class=s2>&quot;allow&quot;</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=go>5</span>
</span></code></pre></div> <p>The algorithm found a total of 5 occurrences with a similarity score above 85%. One of these occurrences is marked as an open range and has a score of 100% (see <code>pattern_ranges.records_readable</code>) because it exactly matches the latest price as the prototype of our pattern. Let's exclude it and plot the pattern projections:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>status_closed</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pattern_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=go>4</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/latest_pattern_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/latest_pattern_projections.dark.svg#only-dark></p> <p>Although we have identified precise pattern ranges, what we actually need are delta ranges that occur after the pattern ranges. Let's project 7 bars into the future and visualize these projections as possible continuations of the latest price:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta_ranges</span> <span class=o>=</span> <span class=n>pattern_ranges</span><span class=o>.</span><span class=n>with_delta</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>delta_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span><span class=n>start_value</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>7</span><span class=p>:]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>plot_volume</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>The default baseline is <code>1</code>. To override it, you can specify the value or array manually, or set it to <code>-1</code> to use the latest price. The latter starts the projections from the most recent price.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/latest_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/latest_projections.dark.svg#only-dark></p> <p>As you can see, both the median and the mean band are rising, which suggests that the price may increase in the future. Let's quantify this observation:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=go>2022-05-31 00:00:00+00:00    31801.040000</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=go>2022-06-01 00:00:00+00:00    31955.412346</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=go>2022-06-02 00:00:00+00:00    32950.202299</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=go>2022-06-03 00:00:00+00:00    33227.236565</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=go>2022-06-04 00:00:00+00:00    35188.975154</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=go>2022-06-05 00:00:00+00:00    35928.715257</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=go>2022-06-06 00:00:00+00:00    35916.453055</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=go>2022-06-07 00:00:00+00:00    36003.074673</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=go>Freq: D, dtype: float64</span>
</span></code></pre></div> <p>Our data is defined between <code>2020-06-01</code> and <code>2022-06-01</code>. Let's fetch the next 7 bars to see how that prediction turned out:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>next_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>BinanceData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=gp>... </span>    <span class=s2>&quot;BTCUSDT&quot;</span><span class=p>,</span> 
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=gp>... </span>    <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-05-31&quot;</span><span class=p>,</span> 
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=gp>... </span>    <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-06-08&quot;</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>next_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=go>Open time</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=go>2022-05-31 00:00:00+00:00    31801.04</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=go>2022-06-01 00:00:00+00:00    29805.83</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=go>2022-06-02 00:00:00+00:00    30452.62</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=go>2022-06-03 00:00:00+00:00    29700.21</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=go>2022-06-04 00:00:00+00:00    29864.04</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=go>2022-06-05 00:00:00+00:00    29919.21</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=go>2022-06-06 00:00:00+00:00    31373.10</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=go>2022-06-07 00:00:00+00:00    31125.33</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=go>Freq: D, Name: Close, dtype: float64</span>
</span></code></pre></div> <p>Even though three out of four projections predicted the price would be well above the baseline, the actual price development was less optimistic. This is a very important concept to understand: there is no guarantee that the future will unfold as projected. What truly matters is having enough projections to provide statistical significance (a sample of four projections is much too small), and consistency in predictions (a single comparison above is not enough to represent the pattern's predictive power). To achieve both of these in the hundreds, you need more data (higher frequency and/or more assets) and cross-validation.</p> <h3 id=quick-plotting>Quick plotting<a class=headerlink href=#quick-plotting title="Permanent link">&para;</a></h3> <p>Manually building and visualizing projections can be useful when the main objective is statistical analysis, but this process can be cumbersome for quickly plotting results. There is a method, <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.plot_projections>Ranges.plot_projections</a>, that combines both tasks: generating and visualizing projections. The first part is handled by calling <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.get_projections>Ranges.get_projections</a>. The second part is handled by calling <a href=https://vectorbt.pro/pvt_41531c19/api/generic/accessors/#vectorbtpro.generic.accessors.GenericDFAccessor.plot_projections>GenericDFAccessor.plot_projections</a>. This is why it accepts all arguments supported by both of these methods, and more. It also lets you plot projection lines as continuations of the price line, which is especially useful when making predictions:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>delta_ranges</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/ranges_plot_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/ranges_plot_projections.dark.svg#only-dark></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>To plot OHLC, pass <code>open</code>, <code>high</code>, <code>low</code>, and <code>close</code> to any method that creates ranges, such as <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.with_delta>Ranges.with_delta</a>.</p> </div> <h2 id=non-uniform-projections>Non-uniform projections<a class=headerlink href=#non-uniform-projections title="Permanent link">&para;</a></h2> <p>Projecting the impact of patterns on price is straightforward when projections have the same duration (delta). However, sometimes projections need to be generated from ranges that are not uniform, such as ranges spanning between entry and exit signals with varying durations. Let's explore a slightly more advanced example: moving average crossovers!</p> <p>We will generate several window combinations and check whether price behavior after entry signals is different from price behavior after exit signals. In the example below, entry and exit signals are created from crossovers using 136 different window combinations. We require a minimum difference of 5 between fast and slow windows to reduce noisy crossovers.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>windows</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>31</span><span class=p>)</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>window_tuples</span> <span class=o>=</span> <span class=n>combinations</span><span class=p>(</span><span class=n>windows</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>window_tuples</span> <span class=o>=</span> <span class=nb>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>abs</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>,</span> <span class=n>window_tuples</span><span class=p>)</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_windows</span><span class=p>,</span> <span class=n>slow_windows</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=n>window_tuples</span><span class=p>)</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;sma&quot;</span><span class=p>,</span> <span class=n>fast_windows</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;fast_sma&quot;</span><span class=p>)</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>slow_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;sma&quot;</span><span class=p>,</span> <span class=n>slow_windows</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;slow_sma&quot;</span><span class=p>)</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entries</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>real_crossed_above</span><span class=p>(</span><span class=n>slow_sma</span><span class=o>.</span><span class=n>real</span><span class=p>)</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exits</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>real_crossed_below</span><span class=p>(</span><span class=n>slow_sma</span><span class=o>.</span><span class=n>real</span><span class=p>)</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entries</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a><span class=go>(730, 136)</span>
</span></code></pre></div> <p>First, let's examine whether the generated entry and exit signals produce different delta projections. To do this, we use the accessor method <a href=https://vectorbt.pro/pvt_41531c19/api/signals/accessors/#vectorbtpro.signals.accessors.SignalsAccessor.delta_ranges>SignalsAccessor.delta_ranges</a>, which builds delta ranges directly from the signals. The only parameter we need to specify is the delta, which will be 30 bars. To avoid incomplete data, we will only use closed ranges:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span> <span class=o>=</span> <span class=n>entries</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>delta_ranges</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>status_closed</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=go>2233</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span> <span class=o>=</span> <span class=n>exits</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>delta_ranges</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>status_closed</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=go>2233</span>
</span></code></pre></div> <p>Next, we will extract the price projections within those ranges:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=go>(31, 2233)</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=go>(31, 2233)</span>
</span></code></pre></div> <p>Remember when we worked with just 4 projections? Now we have 4.5k!</p> <p>Finally, we will plot the bands of both datasets on a single chart:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>entry_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=gp>... </span>    <span class=n>plot_projections</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=gp>... </span>    <span class=n>plot_aux_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=gp>... </span>    <span class=n>plot_fill</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=gp>... </span>    <span class=n>lower_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Lower (entry)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;green&quot;</span><span class=p>),</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=gp>... </span>    <span class=n>middle_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Middle (entry)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;green&quot;</span><span class=p>),</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=gp>... </span>    <span class=n>upper_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Upper (entry)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;green&quot;</span><span class=p>),</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>exit_projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=gp>... </span>    <span class=n>plot_projections</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=gp>... </span>    <span class=n>plot_aux_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=gp>... </span>    <span class=n>plot_fill</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a><span class=gp>... </span>    <span class=n>lower_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Lower (exit)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;orangered&quot;</span><span class=p>),</span>
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a><span class=gp>... </span>    <span class=n>middle_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Middle (exit)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;orangered&quot;</span><span class=p>),</span>
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=gp>... </span>    <span class=n>upper_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Upper (exit)&quot;</span><span class=p>,</span> <span class=n>line_color</span><span class=o>=</span><span class=s2>&quot;orangered&quot;</span><span class=p>),</span>
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=gp>... </span>    <span class=n>fig</span><span class=o>=</span><span class=n>fig</span>
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-33-18><a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_exit_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_exit_projections.dark.svg#only-dark></p> <p>Surprised? Exits seem to consistently outperform entries right after the event but ultimately lose to them in the long term. Of course, you can further analyze this by window length or difference, but that is left as an exercise for the reader.</p> <p>The projections we generated above are still uniform because they all have the same length, which makes them easy to manage. But what if our projections had varying lengths? Let's create a projection from the price between each consecutive entry and exit pair for long trades, and the reverse for short trades. This approach closely matches the performance of trades that would be generated by passing the signal arrays to <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/base/#vectorbtpro.portfolio.base.Portfolio.from_signals>Portfolio.from_signals</a>. To represent each pair of signals as a range, we can use the accessor method <a href=https://vectorbt.pro/pvt_41531c19/api/signals/accessors/#vectorbtpro.signals.accessors.SignalsAccessor.between_ranges>SignalsAccessor.between_ranges</a>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span> <span class=o>=</span> <span class=n>entries</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>between_ranges</span><span class=p>(</span><span class=n>exits</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>status_closed</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=go>2240</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span> <span class=o>=</span> <span class=n>exits</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>between_ranges</span><span class=p>(</span><span class=n>entries</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>status_closed</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=go>2118</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-34-13><a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a><span class=go>(124, 2240)</span>
</span><span id=__span-34-14><a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>
</span><span id=__span-34-15><a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>()</span>
</span><span id=__span-34-16><a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-34-17><a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a><span class=go>(83, 2118)</span>
</span></code></pre></div> <p>You will notice that both arrays now have a different number of rows. Furthermore, the projections themselves have different lengths and are padded at the end with NaNs. If you tried to plot any of these arrays directly, it would be extremely slow due to the creation of thousands of scatter traces. When you cannot plot something because of its size, it is best to select a random subset of elements (columns in this case):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/rand_entry_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/rand_entry_projections.dark.svg#only-dark></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/rand_exit_projections.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/rand_exit_projections.dark.svg#only-dark></p> <p>There are many shorter projections and a few longer ones. Interestingly, on a larger scale, entries are followed exclusively by bull runs and exits by bear runs.</p> <h3 id=shrinking>Shrinking<a class=headerlink href=#shrinking title="Permanent link">&para;</a></h3> <p>One challenge is building confidence bands, since the first points will have many more observations (non-NaN values) than the last ones. If we want to "shrink" the projection period, we can keep the larger projections and trim them later in Pandas, or simply use the <code>proj_period</code> argument in <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.get_projections>Ranges.get_projections</a>, which accepts either an integer (number of rows) or a timedelta. Let's reduce our projections to 30 days:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span><span class=n>proj_period</span><span class=o>=</span><span class=s2>&quot;30d&quot;</span><span class=p>)</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=go>(31, 2240)</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span><span class=n>proj_period</span><span class=o>=</span><span class=s2>&quot;30d&quot;</span><span class=p>)</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=go>(31, 2118)</span>
</span></code></pre></div> <p>Now each array has 31 rows: one baseline row and 30 projection rows. Let's plot the generated projections:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_proj_period.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_proj_period.dark.svg#only-dark></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/exit_proj_period.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/exit_proj_period.dark.svg#only-dark></p> <p>We can now be more confident that using above-crossovers for entries and below-crossovers for exits mostly produced positive returns, especially over the long term. These two graphs are more informative than many crossover heatmaps because they let's analyze the impact of any events across the time dimension. Randomly selecting projections, as we did above, is also a form of validation: by plotting random projections multiple times, we can test the consistency of our findings.</p> <h3 id=stretching>Stretching<a class=headerlink href=#stretching title="Permanent link">&para;</a></h3> <p>There is also a way to convert non-uniform projections into a uniform format: using the <code>extend</code> argument, we can "extend" shorter projections to match the period of the largest projection (or <code>proj_period</code>) by including the price that follows the end of the projection. This is essentially the same as generating delta ranges. Let's shrink our signal projections to 30 days and then extend the shorter projections so that all projections have the same length:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span> <span class=o>=</span> <span class=n>entry_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=gp>... </span>    <span class=n>proj_period</span><span class=o>=</span><span class=s2>&quot;30d&quot;</span><span class=p>,</span> <span class=n>extend</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=go>(31, 2240)</span>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span>
</span><span id=__span-40-8><a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=gp>... </span>    <span class=n>proj_period</span><span class=o>=</span><span class=s2>&quot;30d&quot;</span><span class=p>,</span> <span class=n>extend</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-40-9><a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-40-10><a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-40-11><a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a><span class=go>(31, 2118)</span>
</span><span id=__span-40-12><a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a>
</span><span id=__span-40-13><a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>entry_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-40-14><a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_extend.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/entry_extend.dark.svg#only-dark></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rand_cols</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>exit_projections</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_projections</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=n>rand_cols</span><span class=p>]</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/exit_extend.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/exit_extend.dark.svg#only-dark></p> <p>Stretching has extended each projection beyond its opposite signal, making it redundant. Looking at the chart, we can clearly see that without the opposite signal, the advantage of using crossovers disappears. This analysis once again underlines the importance of properly timing your exits.</p> <h3 id=quick-plotting_1>Quick plotting<a class=headerlink href=#quick-plotting_1 title="Permanent link">&para;</a></h3> <p>Just as we combined projection generation and visualization before, we can combine all the steps above using <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.plot_projections>Ranges.plot_projections</a>. The main difference is that this method only allows plotting one column at a time. We can also use various arguments to filter the ranges. For example, we can use <code>min_duration</code> and <code>max_duration</code> to filter out shorter or longer ranges before generating projections, or select a number of the most recent ranges using the <code>last_n</code> argument. Let's select the 10 most recent ranges:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=go>MultiIndex([(10, 15),</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=go>            (10, 16),</span>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=go>            (10, 17),</span>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=go>            ...</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=go>            (24, 29),</span>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=go>            (24, 30),</span>
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=go>            (25, 30)],</span>
</span><span id=__span-42-9><a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a><span class=go>           names=[&#39;fast_sma_timeperiod&#39;, &#39;slow_sma_timeperiod&#39;], length=136)</span>
</span><span id=__span-42-10><a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a>
</span><span id=__span-42-11><a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entry_ranges</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-42-12><a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a><span class=gp>... </span>    <span class=n>column</span><span class=o>=</span><span class=p>(</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span>
</span><span id=__span-42-13><a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a><span class=gp>... </span>    <span class=n>last_n</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-42-14><a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a><span class=gp>... </span>    <span class=n>proj_period</span><span class=o>=</span><span class=s2>&quot;30d&quot;</span><span class=p>,</span>
</span><span id=__span-42-15><a id=__codelineno-42-15 name=__codelineno-42-15 href=#__codelineno-42-15></a><span class=gp>... </span>    <span class=n>extend</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-42-16><a id=__codelineno-42-16 name=__codelineno-42-16 href=#__codelineno-42-16></a><span class=gp>... </span>    <span class=n>plot_lower</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-42-17><a id=__codelineno-42-17 name=__codelineno-42-17 href=#__codelineno-42-17></a><span class=gp>... </span>    <span class=n>plot_upper</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-42-18><a id=__codelineno-42-18 name=__codelineno-42-18 href=#__codelineno-42-18></a><span class=gp>... </span>    <span class=n>plot_aux_middle</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-42-19><a id=__codelineno-42-19 name=__codelineno-42-19 href=#__codelineno-42-19></a><span class=gp>... </span>    <span class=n>projection_trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>opacity</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-42-20><a id=__codelineno-42-20 name=__codelineno-42-20 href=#__codelineno-42-20></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/plot_projections_25_30.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/plot_projections_25_30.dark.svg#only-dark></p> <p>This graph answers the question: "How would the price most likely react if we saw an upward crossover of the 25 and 30 SMA today?"</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You can disable plotting of the price by setting <code>plot_close</code> to <code>False</code>.</p> </div> <h2 id=open-projections>Open projections<a class=headerlink href=#open-projections title="Permanent link">&para;</a></h2> <p>Another use case arises when the latest range (or trade) is not closed. In the crossover scenario above, this means the latest entry does not have a corresponding exit (or vice versa). In this case, we are mainly interested in projections that do not start from the signal, but instead continue from the current point. Let's regenerate our ranges, allowing open ranges. Since the most recent crossovers were exits, we will focus our analysis on exit signals. Suppose we have opened a short trade at the latest exit signal and want to examine future price development to decide whether to close the trade before the next entry:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span> <span class=o>=</span> <span class=n>exits</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>between_ranges</span><span class=p>(</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=gp>... </span>    <span class=n>entries</span><span class=p>,</span> 
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=gp>... </span>    <span class=n>incl_open</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> 
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=gp>... </span>    <span class=n>close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=go>2240</span>
</span></code></pre></div> <p>Which columns have a last exit with no entry?</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>columns</span><span class=p>[</span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>status_open</span><span class=o>.</span><span class=n>col_arr</span><span class=p>]</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=go>MultiIndex([(10, 17),</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=go>            (10, 18),</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=go>            (10, 19),</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=go>            (24, 29),</span>
</span><span id=__span-44-6><a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=go>            (24, 30),</span>
</span><span id=__span-44-7><a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a><span class=go>            (25, 30)],</span>
</span><span id=__span-44-8><a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=go>           names=[&#39;fast_sma_timeperiod&#39;, &#39;slow_sma_timeperiod&#39;], length=122)</span>
</span></code></pre></div> <p>Now, let's call the <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.plot_projections>Ranges.plot_projections</a> method on the <strong>closed</strong> ranges of the column <code>(20, 30)</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>status_closed</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=gp>... </span>    <span class=n>column</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span> <span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_closed.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_closed.dark.svg#only-dark></p> <p>Now, try including the open range:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exit_ranges</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=gp>... </span>    <span class=n>column</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span> <span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_all.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_all.dark.svg#only-dark></p> <p>What happened? The method detected that the last range is open (meaning the last signal does not have an opposite signal) and instructed <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ranges/#vectorbtpro.generic.ranges.Ranges.get_projections>Ranges.get_projections</a> to generate projections starting from the signal point. This behavior is controlled by the <code>proj_start</code> argument, which defaults to <code>current_or_0</code>. When there is an open range, it uses the signal point as the start; otherwise, it uses the first point. Another argument, <code>plot_past_period</code>, controls the plotted period of the price and defaults to <code>current_or_proj_period</code>. If there is an open range, it plots the close from the signal point; otherwise, it uses the projection period.</p> <p>To illustrate, let's plot all projections from the signal point:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>column</span> <span class=o>=</span> <span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>signal_index</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>flatnonzero</span><span class=p>(</span><span class=n>exits</span><span class=p>[</span><span class=n>column</span><span class=p>])[</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>plot_start_index</span> <span class=o>=</span> <span class=n>signal_index</span> <span class=o>-</span> <span class=n>pd</span><span class=o>.</span><span class=n>Timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sub_close</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>[</span><span class=n>plot_start_index</span><span class=p>:]</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sub_exits</span> <span class=o>=</span> <span class=n>exits</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>plot_start_index</span><span class=p>:,</span> <span class=n>column</span><span class=p>]</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>sub_close</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sub_exits</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>plot_as_exits</span><span class=p>(</span><span class=n>sub_close</span><span class=p>,</span> <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span> <span class=o>=</span> <span class=n>exit_ranges</span><span class=p>[</span><span class=n>column</span><span class=p>]</span><span class=o>.</span><span class=n>status_closed</span><span class=o>.</span><span class=n>get_projections</span><span class=p>(</span>
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=gp>... </span>    <span class=n>start_value</span><span class=o>=</span><span class=n>sub_close</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>signal_index</span><span class=p>],</span>
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=gp>... </span>    <span class=n>start_index</span><span class=o>=</span><span class=n>signal_index</span>
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>projections</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot_projections</span><span class=p>(</span><span class=n>plot_bands</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_sub.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/tutorials/patterns/open_projections_sub.dark.svg#only-dark></p> <p>As shown above, by the end of the price data there are only two projections left, which is why the other projections were omitted in the previous plot.</p> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">&para;</a></h2> <p>We have learned how to recognize patterns in any time series and evaluate their impact on price development using projections, without any backtesting. This approach allows us to analyze arbitrary events without dealing with the many challenges of backtesting, such as configuring initial capital, position sizing, and performance accumulation. By considering only the price itself, we set up a fair experiment that can offer insights into how our trading strategy would have performed if we entered at one point and exited at another. However, having only a few projections is not enough. As with all statistics, we need a large enough sample of events to estimate their impact with confidence. Otherwise, we could easily be misled by impressive results.</p> <p><a class=md-button href=https://vectorbt.pro/pvt_41531c19/assets/jupytext/tutorials/patterns-and-projections/projections.py.txt target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"/></svg></span> Python code</a> <a class=md-button href=https://github.com/polakowo/vectorbt.pro/blob/notebooks/PatternsProjections.ipynb target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg></span> Notebook</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/patterns/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Patterns"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Patterns </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/cross-validation/ class="md-footer__link md-footer__link--next" aria-label="Next: Cross-validation"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Cross-validation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/tutorials/patterns-and-projections/projections/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:52 GMT -->
</html>