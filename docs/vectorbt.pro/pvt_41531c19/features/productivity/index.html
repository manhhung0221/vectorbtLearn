<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/features/productivity/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Productivity features of VectorBT PRO"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/features/productivity/ rel=canonical><link href=../portfolio/index.html rel=prev><link href=../../tutorials/overview/index.html rel=next><link rel=icon href=../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>Productivity - VectorBT® PRO</title><link rel=stylesheet href=../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/stylesheets/extra.css><link rel=stylesheet href=../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=Productivity><meta property=og:type content=website><meta content=https://vectorbt.pro/features/productivity/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Productivity features of VectorBT PRO"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#productivity class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-header__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBT® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Productivity </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-nav__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBT® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/analysis/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.2 11.2c1.77 0 3.2 1.43 3.2 3.2s-1.43 3.2-3.2 3.2S4 16.17 4 14.4s1.43-3.2 3.2-3.2m7.6 4.8a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m.4-12A4.8 4.8 0 0 1 20 8.8c0 2.65-2.15 4.8-4.8 4.8a4.8 4.8 0 0 1-4.8-4.8c0-2.65 2.15-4.8 4.8-4.8"/></svg> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/data/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"/></svg> <span class=md-ellipsis> Data </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/indicators/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3 14 .5.07L8.07 9.5a1.95 1.95 0 0 1 .52-1.91c.78-.79 2.04-.79 2.82 0 .53.52.7 1.26.52 1.91l2.57 2.57.5-.07c.18 0 .35 0 .5.07l3.57-3.57C19 8.35 19 8.18 19 8a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2c-.18 0-.35 0-.5-.07l-3.57 3.57c.07.15.07.32.07.5a2 2 0 0 1-2 2 2 2 0 0 1-2-2l.07-.5-2.57-2.57c-.32.07-.68.07-1 0L4.93 15.5 5 16a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2"/></svg> <span class=md-ellipsis> Indicators </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/intelligence/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21.33 12.91c.09 1.55-.62 3.04-1.89 3.95l.77 1.49c.23.45.26.98.06 1.45-.19.47-.58.84-1.06 1l-.79.25a1.687 1.687 0 0 1-1.86-.55L14.44 18c-.89-.15-1.73-.53-2.44-1.1-.5.15-1 .23-1.5.23-.88 0-1.76-.27-2.5-.79-.53.16-1.07.23-1.62.22-.79.01-1.57-.15-2.3-.45a4.1 4.1 0 0 1-2.43-3.61c-.08-.72.04-1.45.35-2.11-.29-.75-.32-1.57-.07-2.33C2.3 7.11 3 6.32 3.87 5.82c.58-1.69 2.21-2.82 4-2.7 1.6-1.5 4.05-1.66 5.83-.37.42-.11.86-.17 1.3-.17 1.36-.03 2.65.57 3.5 1.64 2.04.53 3.5 2.35 3.58 4.47.05 1.11-.25 2.2-.86 3.13.07.36.11.72.11 1.09m-5-1.41c.57.07 1.02.5 1.02 1.07a1 1 0 0 1-1 1h-.63c-.32.9-.88 1.69-1.62 2.29.25.09.51.14.77.21 5.13-.07 4.53-3.2 4.53-3.25a2.59 2.59 0 0 0-2.69-2.49 1 1 0 0 1-1-1 1 1 0 0 1 1-1c1.23.03 2.41.49 3.33 1.3.05-.29.08-.59.08-.89-.06-1.24-.62-2.32-2.87-2.53-1.25-2.96-4.4-1.32-4.4-.4-.03.23.21.72.25.75a1 1 0 0 1 1 1c0 .55-.45 1-1 1-.53-.02-1.03-.22-1.43-.56-.48.31-1.03.5-1.6.56-.57.05-1.04-.35-1.07-.9a.97.97 0 0 1 .88-1.1c.16-.02.94-.14.94-.77 0-.66.25-1.29.68-1.79-.92-.25-1.91.08-2.91 1.29C6.75 5 6 5.25 5.45 7.2 4.5 7.67 4 8 3.78 9c1.08-.22 2.19-.13 3.22.25.5.19.78.75.59 1.29-.19.52-.77.78-1.29.59-.73-.32-1.55-.34-2.3-.06-.32.27-.32.83-.32 1.27 0 .74.37 1.43 1 1.83.53.27 1.12.41 1.71.4q-.225-.39-.39-.81a1.038 1.038 0 0 1 1.96-.68c.4 1.14 1.42 1.92 2.62 2.05 1.37-.07 2.59-.88 3.19-2.13.23-1.38 1.34-1.5 2.56-1.5m2 7.47-.62-1.3-.71.16 1 1.25zm-4.65-8.61a1 1 0 0 0-.91-1.03c-.71-.04-1.4.2-1.93.67-.57.58-.87 1.38-.84 2.19a1 1 0 0 0 1 1c.57 0 1-.45 1-1 0-.27.07-.54.23-.76.12-.1.27-.15.43-.15.55.03 1.02-.38 1.02-.92"/></svg> <span class=md-ellipsis> Intelligence </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/optimization/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16h-.58l-.81-.81A7.07 7.07 0 0 0 18 11c0-3.87-3.13-7-7-7-1.5 0-3 .5-4.21 1.4-3.09 2.32-3.72 6.71-1.4 9.8s6.71 3.72 9.8 1.4l.81.81V18l5 5 2-2zm-7 0c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5M3 6 1 8V1h7L6 3H3zm18-5v7l-2-2V3h-3l-2-2zM6 19l2 2H1v-7l2 2v3z"/></svg> <span class=md-ellipsis> Optimization </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/performance/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 16a3 3 0 0 1-3-3c0-1.12.61-2.1 1.5-2.61l9.71-5.62-5.53 9.58c-.5.98-1.51 1.65-2.68 1.65m0-13c1.81 0 3.5.5 4.97 1.32l-2.1 1.21C14 5.19 13 5 12 5a8 8 0 0 0-8 8c0 2.21.89 4.21 2.34 5.65h.01c.39.39.39 1.02 0 1.41s-1.03.39-1.42.01A9.97 9.97 0 0 1 2 13 10 10 0 0 1 12 3m10 10c0 2.76-1.12 5.26-2.93 7.07-.39.38-1.02.38-1.41-.01a.996.996 0 0 1 0-1.41A7.95 7.95 0 0 0 20 13c0-1-.19-2-.54-2.9L20.67 8C21.5 9.5 22 11.18 22 13"/></svg> <span class=md-ellipsis> Performance </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/features/portfolio/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17.45 15.18 22 7.31V21H2V3h2v12.54L9.5 6 16 9.78l4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L4.31 19h2.26l4.39-7.56z"/></svg> <span class=md-ellipsis> Portfolio </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 7a5 5 0 0 0-5 5 5 5 0 0 0 5 5 5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> <span class=md-ellipsis> Productivity </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/features/productivity/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 7a5 5 0 0 0-5 5 5 5 0 0 0 5 5 5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> <span class=md-ellipsis> Productivity </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#configuration-files class=md-nav__link> <span class=md-ellipsis> Configuration files </span> </a> </li> <li class=md-nav__item> <a href=#iterated-decorator class=md-nav__link> <span class=md-ellipsis> Iterated decorator </span> </a> </li> <li class=md-nav__item> <a href=#tasks class=md-nav__link> <span class=md-ellipsis> Tasks </span> </a> </li> <li class=md-nav__item> <a href=#nested-progress-bars class=md-nav__link> <span class=md-ellipsis> Nested progress bars </span> </a> </li> <li class=md-nav__item> <a href=#annotations class=md-nav__link> <span class=md-ellipsis> Annotations </span> </a> </li> <li class=md-nav__item> <a href=#dataframe-product class=md-nav__link> <span class=md-ellipsis> DataFrame product </span> </a> </li> <li class=md-nav__item> <a href=#compression class=md-nav__link> <span class=md-ellipsis> Compression </span> </a> </li> <li class=md-nav__item> <a href=#faster-loading class=md-nav__link> <span class=md-ellipsis> Faster loading </span> </a> </li> <li class=md-nav__item> <a href=#serialization class=md-nav__link> <span class=md-ellipsis> Serialization </span> </a> </li> <li class=md-nav__item> <a href=#data-parsing class=md-nav__link> <span class=md-ellipsis> Data parsing </span> </a> </li> <li class=md-nav__item> <a href=#index-dictionaries class=md-nav__link> <span class=md-ellipsis> Index dictionaries </span> </a> </li> <li class=md-nav__item> <a href=#slicing class=md-nav__link> <span class=md-ellipsis> Slicing </span> </a> </li> <li class=md-nav__item> <a href=#column-stacking class=md-nav__link> <span class=md-ellipsis> Column stacking </span> </a> </li> <li class=md-nav__item> <a href=#row-stacking class=md-nav__link> <span class=md-ellipsis> Row stacking </span> </a> </li> <li class=md-nav__item> <a href=#index-alignment class=md-nav__link> <span class=md-ellipsis> Index alignment </span> </a> </li> <li class=md-nav__item> <a href=#numba-datetime class=md-nav__link> <span class=md-ellipsis> Numba datetime </span> </a> </li> <li class=md-nav__item> <a href=#periods-ago class=md-nav__link> <span class=md-ellipsis> Periods ago </span> </a> </li> <li class=md-nav__item> <a href=#safe-resampling class=md-nav__link> <span class=md-ellipsis> Safe resampling </span> </a> </li> <li class=md-nav__item> <a href=#resamplable-objects class=md-nav__link> <span class=md-ellipsis> Resamplable objects </span> </a> </li> <li class=md-nav__item> <a href=#formatting-engine class=md-nav__link> <span class=md-ellipsis> Formatting engine </span> </a> </li> <li class=md-nav__item> <a href=#meta-methods class=md-nav__link> <span class=md-ellipsis> Meta methods </span> </a> </li> <li class=md-nav__item> <a href=#array-expressions class=md-nav__link> <span class=md-ellipsis> Array expressions </span> </a> </li> <li class=md-nav__item> <a href=#resource-management class=md-nav__link> <span class=md-ellipsis> Resource management </span> </a> </li> <li class=md-nav__item> <a href=#templates class=md-nav__link> <span class=md-ellipsis> Templates </span> </a> </li> <li class=md-nav__item> <a href=#and-many-more class=md-nav__link> <span class=md-ellipsis> And many more... </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=productivity><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 7a5 5 0 0 0-5 5 5 5 0 0 0 5 5 5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg></span> Productivity<a class=headerlink href=#productivity title="Permanent link">&para;</a></h1> <h2 id=configuration-files>Configuration files <span class="twemoji mdx-pulse" title="Recently added"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m23 12-2.44-2.78.34-3.68-3.61-.82-1.89-3.18L12 3 8.6 1.54 6.71 4.72l-3.61.81.34 3.68L1 12l2.44 2.78-.34 3.69 3.61.82 1.89 3.18L12 21l3.4 1.46 1.89-3.18 3.61-.82-.34-3.68zm-10 5h-2v-2h2zm0-4h-2V7h2z"/></svg></span><a class=headerlink href=#configuration-files title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/v2025_10_15.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> VBT extends popular configuration formats (INI, YAML, TOML) to define its own configuration format that allows users to save, introspect, modify, and load any complex in-house object. The main advantages of this format are readability and round-tripping: any object can be encoded and then decoded back without loss of information. The main features include nested structures, references, literal parsing, and evaluation of arbitrary Python expressions. Additionally, you can now create a configuration file for VBT and place it in the working directory— it will be used to update the default settings whenever the package is imported.</li> </ul> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>INI</label><label for=__tabbed_1_2>YAML</label><label for=__tabbed_1_3>TOML</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-ini highlight"><span class=filename>Define global settings in vbt.cfg</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>[plotting]</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=na>default_theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;dark&quot;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=k>[portfolio]</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=na>init_cash</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>5000</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=k>[data.custom.binance.client_config]</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=na>api_key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;&lt;YOUR_API_KEY&gt;&quot;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=na>api_secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;&lt;YOUR_API_SECRET&gt;&quot;</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=k>[data.custom.ccxt.exchanges.binance.exchange_config]</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=na>apiKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&amp;data.custom.binance.client_config.api_key</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=na>secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&amp;data.custom.binance.client_config.api_secret</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-yaml highlight"><span class=filename>Define global settings in vbt.yml</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>plotting</span><span class=p>:</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=nt>default_theme</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dark</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=nt>portfolio</span><span class=p>:</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span><span class=nt>init_cash</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=nt>data.custom.binance.client_config</span><span class=p>:</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>  </span><span class=nt>api_key</span><span class=p>:</span><span class=w> </span><span class=nl>&amp;api_key</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;YOUR_API_KEY&gt;</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>  </span><span class=nt>api_secret</span><span class=p>:</span><span class=w> </span><span class=nl>&amp;api_secret</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;YOUR_API_SECRET&gt;</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=nt>data.custom.ccxt.exchanges.binance.exchange_config</span><span class=p>:</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>  </span><span class=nt>apiKey</span><span class=p>:</span><span class=w> </span><span class=nv>*api_key</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>  </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class=nv>*api_secret</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-toml highlight"><span class=filename>Define global settings in vbt.toml</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>[plotting]</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>default_theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;dark&quot;</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=k>[portfolio]</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>init_cash</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=k>[data.custom.binance.client_config]</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>api_key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&lt;YOUR_API_KEY&gt;&quot;</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=n>api_secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&lt;YOUR_API_SECRET&gt;&quot;</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=k>[data.custom.ccxt.exchanges.binance.exchange_config]</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=n>apiKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>__vbt_ref__</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s2>&quot;data.custom.binance.client_config.api_key&quot;</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=n>secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>__vbt_ref__</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s2>&quot;data.custom.binance.client_config.api_secret&quot;</span><span class=w> </span><span class=p>}</span>
</span></code></pre></div> </div> </div> </div> <div class="language-pycon highlight"><span class=filename>Verify that the settings have been loaded correctly</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>settings</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s2>&quot;init_cash&quot;</span><span class=p>]</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=go>5000</span>
</span></code></pre></div> <h2 id=iterated-decorator>Iterated decorator<a class=headerlink href=#iterated-decorator title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/v2024_6_19.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Thinking about parallelizing a for-loop? No need to hesitate—VBT has a decorator for that.</li> </ul> <div class="language-pycon highlight"><span class=filename>Emulate a parallelized nested loop to get Sharpe by year and month</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>calendar</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=gp>&gt;&gt;&gt; </span><span class=nd>@vbt</span><span class=o>.</span><span class=n>iterated</span><span class=p>(</span><span class=n>over_arg</span><span class=o>=</span><span class=s2>&quot;year&quot;</span><span class=p>,</span> <span class=n>merge_func</span><span class=o>=</span><span class=s2>&quot;column_stack&quot;</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;pathos&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=gp>... </span><span class=nd>@vbt</span><span class=o>.</span><span class=n>iterated</span><span class=p>(</span><span class=n>over_arg</span><span class=o>=</span><span class=s2>&quot;month&quot;</span><span class=p>,</span> <span class=n>merge_func</span><span class=o>=</span><span class=s2>&quot;concat&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=gp>... </span><span class=k>def</span><span class=w> </span><span class=nf>get_year_month_sharpe</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>year</span><span class=p>,</span> <span class=n>month</span><span class=p>):</span>  <span class=c1># (3)!</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=gp>... </span>    <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>year</span> <span class=o>==</span> <span class=n>year</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>month</span> <span class=o>==</span> <span class=n>month</span><span class=p>)</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=gp>... </span>    <span class=k>if</span> <span class=ow>not</span> <span class=n>mask</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=gp>... </span>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=gp>... </span>    <span class=n>year_returns</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span><span class=o>.</span><span class=n>returns</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>year_returns</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>returns</span><span class=o>.</span><span class=n>sharpe_ratio</span><span class=p>()</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>years</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>year</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span><span class=o>.</span><span class=n>sort_values</span><span class=p>()</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&quot;year&quot;</span><span class=p>)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>months</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>month</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span><span class=o>.</span><span class=n>sort_values</span><span class=p>()</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&quot;month&quot;</span><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_matrix</span> <span class=o>=</span> <span class=n>get_year_month_sharpe</span><span class=p>(</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=gp>... </span>    <span class=n>data</span><span class=p>,</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=gp>... </span>    <span class=n>years</span><span class=p>,</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=gp>... </span>    <span class=p>{</span><span class=n>calendar</span><span class=o>.</span><span class=n>month_abbr</span><span class=p>[</span><span class=n>month</span><span class=p>]:</span> <span class=n>month</span> <span class=k>for</span> <span class=n>month</span> <span class=ow>in</span> <span class=n>months</span><span class=p>},</span>  <span class=c1># (4)!</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_matrix</span><span class=o>.</span><span class=n>transpose</span><span class=p>()</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=gp>... </span>    <span class=n>trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>colorscale</span><span class=o>=</span><span class=s2>&quot;RdBu&quot;</span><span class=p>,</span> <span class=n>zmid</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> 
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=gp>... </span>    <span class=n>yaxis</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>autorange</span><span class=o>=</span><span class=s2>&quot;reversed&quot;</span><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Iterate over years (in parallel).</li> <li>Iterate over months (sequentially).</li> <li>The function is called for each combination of year and month.</li> <li>Map month numbers to names and pass them as a dict. VBT will extract the keys and use them as labels.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/iterated_decorator.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/iterated_decorator.dark.svg#only-dark></p> <h2 id=tasks>Tasks<a class=headerlink href=#tasks title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/v2024_6_19.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Testing multiple parameter combinations usually involves using the <code>@vbt.parameterized</code> decorator. But what if you want to test entirely uncorrelated configurations or even different functions? The latest addition to VBT lets you execute any sequence of unrelated tests in parallel by assigning each test to a task.</li> </ul> <div class="language-pycon highlight"><span class=filename>Simulate SL, TSL, and TP parameters in three separate processes and compare their expectancy</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>task1</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Task</span><span class=p>(</span>  <span class=c1># (1)!</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>,</span> 
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=gp>... </span>    <span class=n>data</span><span class=p>,</span> 
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=gp>... </span>    <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=gp>... </span>    <span class=n>sl_stop</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>51</span><span class=p>)</span> <span class=o>/</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>task2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Task</span><span class=p>(</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>,</span> 
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=gp>... </span>    <span class=n>data</span><span class=p>,</span> 
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=gp>... </span>    <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=gp>... </span>    <span class=n>tsl_stop</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>51</span><span class=p>)</span> <span class=o>/</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>task3</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Task</span><span class=p>(</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>,</span> 
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=gp>... </span>    <span class=n>data</span><span class=p>,</span> 
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=gp>... </span>    <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=gp>... </span>    <span class=n>tp_stop</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>51</span><span class=p>)</span> <span class=o>/</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf1</span><span class=p>,</span> <span class=n>pf2</span><span class=p>,</span> <span class=n>pf3</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>execute</span><span class=p>([</span><span class=n>task1</span><span class=p>,</span> <span class=n>task2</span><span class=p>,</span> <span class=n>task3</span><span class=p>],</span> <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;pathos&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>pf1</span><span class=o>.</span><span class=n>trades</span><span class=o>.</span><span class=n>expectancy</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&quot;SL&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf2</span><span class=o>.</span><span class=n>trades</span><span class=o>.</span><span class=n>expectancy</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&quot;TSL&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf3</span><span class=o>.</span><span class=n>trades</span><span class=o>.</span><span class=n>expectancy</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&quot;TP&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>A task consists of a function and the arguments you want to pass to that function. Just creating a task does not execute the function!</li> <li>Execute all three tasks using multiprocessing.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/tasks.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/tasks.dark.svg#only-dark></p> <h2 id=nested-progress-bars>Nested progress bars<a class=headerlink href=#nested-progress-bars title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/v2024_5_15.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Progress bars are now aware of each other. When a new progress bar starts, it checks whether another progress bar with the same identifier has already finished its task. If so, the new progress bar will close itself and delegate its progress to the existing one.</li> </ul> <div class="language-pycon highlight"><span class=filename>Display progress of three parameters using nested progress bars</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>symbols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>]</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fast_windows</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>slow_windows</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_ratios</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ProgressBar</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>symbols</span><span class=p>),</span> <span class=n>bar_id</span><span class=o>=</span><span class=s2>&quot;pbar1&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar1</span><span class=p>:</span>  <span class=c1># (1)!</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=n>symbols</span><span class=p>:</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=gp>... </span>        <span class=n>pbar1</span><span class=o>.</span><span class=n>set_description</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=n>symbol</span><span class=o>=</span><span class=n>symbol</span><span class=p>),</span> <span class=n>refresh</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=gp>... </span>        <span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=gp>... </span>        
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=gp>... </span>        <span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ProgressBar</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>fast_windows</span><span class=p>),</span> <span class=n>bar_id</span><span class=o>=</span><span class=s2>&quot;pbar2&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar2</span><span class=p>:</span>  <span class=c1># (2)!</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=gp>... </span>            <span class=k>for</span> <span class=n>fast_window</span> <span class=ow>in</span> <span class=n>fast_windows</span><span class=p>:</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=gp>... </span>                <span class=n>pbar2</span><span class=o>.</span><span class=n>set_description</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=n>fast_window</span><span class=o>=</span><span class=n>fast_window</span><span class=p>),</span> <span class=n>refresh</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=gp>... </span>                
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=gp>... </span>                <span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ProgressBar</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>slow_windows</span><span class=p>),</span> <span class=n>bar_id</span><span class=o>=</span><span class=s2>&quot;pbar3&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar3</span><span class=p>:</span>  <span class=c1># (3)!</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=gp>... </span>                    <span class=k>for</span> <span class=n>slow_window</span> <span class=ow>in</span> <span class=n>slow_windows</span><span class=p>:</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=gp>... </span>                        <span class=k>if</span> <span class=n>fast_window</span> <span class=o>&lt;</span> <span class=n>slow_window</span><span class=p>:</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=gp>... </span>                            <span class=n>pbar3</span><span class=o>.</span><span class=n>set_description</span><span class=p>(</span><span class=nb>dict</span><span class=p>(</span><span class=n>slow_window</span><span class=o>=</span><span class=n>slow_window</span><span class=p>),</span> <span class=n>refresh</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=gp>... </span>                            <span class=n>fast_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;talib_func:sma&quot;</span><span class=p>,</span> <span class=n>fast_window</span><span class=p>)</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=gp>... </span>                            <span class=n>slow_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;talib_func:sma&quot;</span><span class=p>,</span> <span class=n>slow_window</span><span class=p>)</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=gp>... </span>                            <span class=n>entries</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>crossed_above</span><span class=p>(</span><span class=n>slow_sma</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=gp>... </span>                            <span class=n>exits</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>crossed_below</span><span class=p>(</span><span class=n>slow_sma</span><span class=p>)</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=gp>... </span>                            <span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_signals</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>entries</span><span class=p>,</span> <span class=n>exits</span><span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=gp>... </span>                            <span class=n>sharpe_ratios</span><span class=p>[(</span><span class=n>symbol</span><span class=p>,</span> <span class=n>fast_window</span><span class=p>,</span> <span class=n>slow_window</span><span class=p>)]</span> <span class=o>=</span> <span class=n>pf</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=gp>... </span>                        <span class=n>pbar3</span><span class=o>.</span><span class=n>update</span><span class=p>()</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=gp>... </span>                        
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=gp>... </span>                <span class=n>pbar2</span><span class=o>.</span><span class=n>update</span><span class=p>()</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=gp>... </span>                
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=gp>... </span>        <span class=n>pbar1</span><span class=o>.</span><span class=n>update</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Track iteration over symbols.</li> <li>Track iteration over fast windows.</li> <li>Track iteration over slow windows.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Symbol 2/2</p> </div> </div> </p> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Fast window 20/20</p> </div> </div> </p> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Slow window 20/20</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_ratios</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>sharpe_ratios</span><span class=p>)</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_ratios</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;symbol&quot;</span><span class=p>,</span> <span class=s2>&quot;fast_window&quot;</span><span class=p>,</span> <span class=s2>&quot;slow_window&quot;</span><span class=p>]</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sharpe_ratios</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=go>symbol   fast_window  slow_window</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=go>BTC-USD  5            10             1.063616</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=go>                      15             1.218345</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=go>                      20             1.273154</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=go>                      25             1.365664</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=go>                      30             1.394469</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=go>                                          ...</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=go>ETH-USD  80           90             0.582995</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=go>                      95             0.617568</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=go>         85           90             0.701215</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=go>                      95             0.616037</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>         90           95             0.566650</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=go>Length: 342, dtype: float64</span>
</span></code></pre></div> <h2 id=annotations>Annotations<a class=headerlink href=#annotations title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/v2023_12_23.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> When writing a function, you can specify the meaning of each argument using an annotation immediately next to the argument. VBT now provides a rich set of in-house annotations tailored to specific tasks. For example, whether an argument is a parameter can be specified directly in the function instead of in the <a href=https://vectorbt.pro/pvt_41531c19/features/optimization/#parameterized-decorator>parameterized decorator</a>.</li> </ul> <div class="language-pycon highlight"><span class=filename>Test a cross-validation function with annotations</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nd>@vbt</span><span class=o>.</span><span class=n>cv_split</span><span class=p>(</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=gp>... </span>    <span class=n>splitter</span><span class=o>=</span><span class=s2>&quot;from_rolling&quot;</span><span class=p>,</span> 
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>... </span>    <span class=n>splitter_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>length</span><span class=o>=</span><span class=mi>365</span><span class=p>,</span> <span class=n>split</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>set_labels</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;train&quot;</span><span class=p>,</span> <span class=s2>&quot;test&quot;</span><span class=p>]),</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=gp>... </span>    <span class=n>parameterized_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>random_subset</span><span class=o>=</span><span class=mi>100</span><span class=p>),</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=gp>... </span><span class=k>def</span><span class=w> </span><span class=nf>sma_crossover_cv</span><span class=p>(</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=gp>... </span>    <span class=n>data</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Takeable</span><span class=p>,</span>  <span class=c1># (1)!</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=gp>... </span>    <span class=n>fast_period</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>(</span><span class=n>condition</span><span class=o>=</span><span class=s2>&quot;x &lt; slow_period&quot;</span><span class=p>),</span>  <span class=c1># (2)!</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=gp>... </span>    <span class=n>slow_period</span><span class=p>:</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>,</span>  <span class=c1># (3)!</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=gp>... </span>    <span class=n>metric</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=gp>... </span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MergeFunc</span><span class=p>(</span><span class=s2>&quot;concat&quot;</span><span class=p>):</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=gp>... </span>    <span class=n>fast_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;sma&quot;</span><span class=p>,</span> <span class=n>fast_period</span><span class=p>,</span> <span class=n>hide_params</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=gp>... </span>    <span class=n>slow_sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;sma&quot;</span><span class=p>,</span> <span class=n>slow_period</span><span class=p>,</span> <span class=n>hide_params</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=gp>... </span>    <span class=n>entries</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>real_crossed_above</span><span class=p>(</span><span class=n>slow_sma</span><span class=p>)</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=gp>... </span>    <span class=n>exits</span> <span class=o>=</span> <span class=n>fast_sma</span><span class=o>.</span><span class=n>real_crossed_below</span><span class=p>(</span><span class=n>slow_sma</span><span class=p>)</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=gp>... </span>    <span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_signals</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>entries</span><span class=p>,</span> <span class=n>exits</span><span class=p>,</span> <span class=n>direction</span><span class=o>=</span><span class=s2>&quot;both&quot;</span><span class=p>)</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>pf</span><span class=o>.</span><span class=n>deep_getattr</span><span class=p>(</span><span class=n>metric</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sma_crossover_cv</span><span class=p>(</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;4 years ago&quot;</span><span class=p>),</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=gp>... </span>    <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=gp>... </span>    <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=gp>... </span>    <span class=s2>&quot;trades.expectancy&quot;</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=go>split  set    fast_period  slow_period</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=go>0      train  22           33             26.351841</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=go>       test   21           34             35.788733</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=go>1      train  21           46             24.114027</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=go>       test   21           39              2.261432</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=go>2      train  30           44             29.635233</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=go>       test   30           38              1.909916</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=go>3      train  20           49             -7.038924</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=go>       test   20           44             -1.366734</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=go>4      train  28           44              2.144805</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a><span class=go>       test   29           38             -4.945776</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=go>5      train  35           47             -8.877875</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=go>       test   34           37              2.792217</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=go>6      train  29           41              8.816846</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=go>       test   28           43             36.008302</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a><span class=go>dtype: float64</span>
</span></code></pre></div> <ol> <li>The passed argument must be takeable (for selecting subsets by split).</li> <li>Parameter with a condition requiring it to be less than the slow period.</li> <li>Parameter for the slow period.</li> </ol> <h2 id=dataframe-product>DataFrame product<a class=headerlink href=#dataframe-product title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_13_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Several parameterized indicators can produce DataFrames with different shapes and columns, which makes creating a Cartesian product tricky because they often share common column levels (such as "symbol") that should not be combined. There is now a method to cross-join multiple DataFrames block-wise.</li> </ul> <div class="language-pycon highlight"><span class=filename>Enter when SMA goes above WMA, exit when EMA goes below WMA</span><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>missing_index</span><span class=o>=</span><span class=s2>&quot;drop&quot;</span><span class=p>)</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;sma&quot;</span><span class=p>,</span> <span class=n>timeperiod</span><span class=o>=</span><span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>],</span> <span class=n>unpack</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ema</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;ema&quot;</span><span class=p>,</span> <span class=n>timeperiod</span><span class=o>=</span><span class=p>[</span><span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>],</span> <span class=n>unpack</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>wma</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;wma&quot;</span><span class=p>,</span> <span class=n>timeperiod</span><span class=o>=</span><span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>60</span><span class=p>],</span> <span class=n>unpack</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>sma</span><span class=p>,</span> <span class=n>ema</span><span class=p>,</span> <span class=n>wma</span> <span class=o>=</span> <span class=n>sma</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>x</span><span class=p>(</span><span class=n>ema</span><span class=p>,</span> <span class=n>wma</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entries</span> <span class=o>=</span> <span class=n>sma</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>crossed_above</span><span class=p>(</span><span class=n>wma</span><span class=p>)</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>exits</span> <span class=o>=</span> <span class=n>ema</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>crossed_below</span><span class=p>(</span><span class=n>wma</span><span class=p>)</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>entries</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=go>MultiIndex([(10, 30, 50, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=go>            (10, 30, 50, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=go>            (10, 30, 60, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=go>            (10, 30, 60, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=go>            (10, 40, 50, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=go>            (10, 40, 50, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=go>            (10, 40, 60, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=go>            (10, 40, 60, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=go>            (20, 30, 50, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=go>            (20, 30, 50, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=go>            (20, 30, 60, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=go>            (20, 30, 60, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=go>            (20, 40, 50, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=go>            (20, 40, 50, &#39;ETH-USD&#39;),</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=go>            (20, 40, 60, &#39;BTC-USD&#39;),</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=go>            (20, 40, 60, &#39;ETH-USD&#39;)],</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a><span class=go>           names=[&#39;sma_timeperiod&#39;, &#39;ema_timeperiod&#39;, &#39;wma_timeperiod&#39;, &#39;symbol&#39;])</span>
</span></code></pre></div> <ol> <li>Build a Cartesian product of three DataFrames while keeping the column level "symbol" untouched. This can also be done with <code>vbt.pd_acc.cross(sma, ema, wma)</code>.</li> </ol> <h2 id=compression>Compression<a class=headerlink href=#compression title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_10_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Serialized VBT objects can sometimes use a lot of disk space. With this update, VBT now supports a variety of compression algorithms to make files as light as possible! <img alt=🪶 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1fab6.svg title=:feather:></li> </ul> <div class="language-pycon highlight"><span class=filename>Save data without and with compression</span><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>RandomOHLCData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;RAND&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2023&quot;</span><span class=p>,</span> <span class=n>timeframe</span><span class=o>=</span><span class=s2>&quot;1 minute&quot;</span><span class=p>)</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>file_path</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>file_size</span><span class=p>(</span><span class=n>file_path</span><span class=p>))</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=go>21.0 MB</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>file_path</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>compression</span><span class=o>=</span><span class=s2>&quot;blosc&quot;</span><span class=p>)</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>file_size</span><span class=p>(</span><span class=n>file_path</span><span class=p>))</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=go>13.3 MB</span>
</span></code></pre></div> <h2 id=faster-loading>Faster loading<a class=headerlink href=#faster-loading title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_10_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> If your pipeline does not need accessors, Plotly graphs, or most other optional features, you can disable the auto-import feature entirely to reduce VBT's loading time to under a second <img alt=⏳ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/23f3.svg title=:hourglass_flowing_sand:></li> </ul> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>INI</label><label for=__tabbed_2_2>YAML</label><label for=__tabbed_2_3>TOML</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-ini highlight"><span class=filename>Define importing settings in vbt.cfg</span><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>[importing]</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=na>auto_import</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>False</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-yaml highlight"><span class=filename>Define importing settings in vbt.yml</span><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=nt>importing</span><span class=p>:</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>  </span><span class=nt>auto_import</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-toml highlight"><span class=filename>Define importing settings in vbt.toml</span><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>[importing]</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=n>auto_import</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span>
</span></code></pre></div> </div> </div> </div> <div class="language-pycon highlight"><span class=filename>Measure the loading time</span><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>start</span> <span class=o>=</span> <span class=n>utc_time</span><span class=p>()</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>vectorbtpro</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>end</span> <span class=o>=</span> <span class=n>utc_time</span><span class=p>()</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=go>0.580937910079956</span>
</span></code></pre></div> <h2 id=serialization>Serialization<a class=headerlink href=#serialization title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_9_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Just like machine learning models, every native VBT object can be serialized and saved to a binary file. It has never been easier to share data and insights! Another benefit is that only the actual content of each object is serialized, not its class definition, so the loaded object always uses the most up-to-date class definition. There is also special logic implemented to help you "reconstruct" objects if VBT introduces any breaking API changes <img alt=🏗 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f3d7.svg title=:construction_site:></li> </ul> <div class="language-pycon highlight"><span class=filename>Backtest each month of data and save the results for later</span><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-01-01&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-06-01&quot;</span><span class=p>)</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>backtest_month</span><span class=p>(</span><span class=n>close</span><span class=p>):</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>(</span><span class=n>close</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>month_pfs</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>offset</span><span class=p>(</span><span class=s2>&quot;M&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>backtest_month</span><span class=p>)</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>month_pfs</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=go>Date</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=go>2022-01-01 00:00:00+00:00    Portfolio(\n    wrapper=ArrayWrapper(\n       ...</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=go>2022-02-01 00:00:00+00:00    Portfolio(\n    wrapper=ArrayWrapper(\n       ...</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=go>2022-03-01 00:00:00+00:00    Portfolio(\n    wrapper=ArrayWrapper(\n       ...</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=go>2022-04-01 00:00:00+00:00    Portfolio(\n    wrapper=ArrayWrapper(\n       ...</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=go>2022-05-01 00:00:00+00:00    Portfolio(\n    wrapper=ArrayWrapper(\n       ...</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=go>Freq: MS, Name: Close, dtype: object</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>month_pfs</span><span class=p>,</span> <span class=s2>&quot;month_pfs&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>month_pfs</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;month_pfs&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>month_pfs</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>pf</span><span class=p>:</span> <span class=n>pf</span><span class=o>.</span><span class=n>total_return</span><span class=p>)</span>
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=go>Date</span>
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=go>2022-01-01 00:00:00+00:00   -0.048924</span>
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=go>2022-02-01 00:00:00+00:00    0.168370</span>
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=go>2022-03-01 00:00:00+00:00    0.016087</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=go>2022-04-01 00:00:00+00:00   -0.120525</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a><span class=go>2022-05-01 00:00:00+00:00    0.110751</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=go>Freq: MS, Name: Close, dtype: float64</span>
</span></code></pre></div> <ol> <li>Save to disk.</li> <li>Load from disk later.</li> </ol> <h2 id=data-parsing>Data parsing<a class=headerlink href=#data-parsing title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_3_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Tired of passing open, high, low, and close as separate time series? Portfolio class methods now accept a data instance instead of just close and automatically extract the contained OHLC data. This small but handy feature saves you time!</li> </ul> <div class="language-pycon highlight"><span class=filename>Run the example above using the new approach</span><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2020-03&quot;</span><span class=p>)</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></code></pre></div> <h2 id=index-dictionaries>Index dictionaries<a class=headerlink href=#index-dictionaries title="Permanent link">&para;</a></h2> <p>Manually creating arrays and setting their data with Pandas can often be challenging. Luckily, there is now a feature that offers much-needed assistance! Any broadcastable argument can become an index dictionary, which contains instructions on where to set values in the array and fills them in for you. It knows exactly which axis needs to be updated and does not create a full array unless necessary, saving RAM <img alt=❤ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2764.svg title=:heart:></p> <div class="language-pycon highlight"><span class=filename>1) Accumulate daily and exit on Sunday vs 2) accumulate weekly and exit on month end</span><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>])</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>tile</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>([</span><span class=s2>&quot;daily&quot;</span><span class=p>,</span> <span class=s2>&quot;weekly&quot;</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;strategy&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_orders</span><span class=p>(</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=gp>... </span>    <span class=n>size</span><span class=o>=</span><span class=n>vbt</span><span class=o>.</span><span class=n>index_dict</span><span class=p>({</span>  <span class=c1># (2)!</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>idx</span><span class=p>(</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>pointidx</span><span class=p>(</span><span class=n>every</span><span class=o>=</span><span class=s2>&quot;day&quot;</span><span class=p>),</span> 
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>colidx</span><span class=p>(</span><span class=s2>&quot;daily&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;strategy&quot;</span><span class=p>)):</span> <span class=mi>100</span><span class=p>,</span>  <span class=c1># (3)!</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>idx</span><span class=p>(</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>pointidx</span><span class=p>(</span><span class=n>every</span><span class=o>=</span><span class=s2>&quot;sunday&quot;</span><span class=p>),</span> 
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>colidx</span><span class=p>(</span><span class=s2>&quot;daily&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;strategy&quot;</span><span class=p>)):</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span>  <span class=c1># (4)!</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>idx</span><span class=p>(</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>pointidx</span><span class=p>(</span><span class=n>every</span><span class=o>=</span><span class=s2>&quot;monday&quot;</span><span class=p>),</span> 
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>colidx</span><span class=p>(</span><span class=s2>&quot;weekly&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;strategy&quot;</span><span class=p>)):</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=gp>... </span>        <span class=n>vbt</span><span class=o>.</span><span class=n>idx</span><span class=p>(</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>pointidx</span><span class=p>(</span><span class=n>every</span><span class=o>=</span><span class=s2>&quot;monthend&quot;</span><span class=p>),</span> 
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=gp>... </span>            <span class=n>vbt</span><span class=o>.</span><span class=n>colidx</span><span class=p>(</span><span class=s2>&quot;weekly&quot;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s2>&quot;strategy&quot;</span><span class=p>)):</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=gp>... </span>    <span class=p>}),</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=gp>... </span>    <span class=n>size_type</span><span class=o>=</span><span class=s2>&quot;value&quot;</span><span class=p>,</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=gp>... </span>    <span class=n>direction</span><span class=o>=</span><span class=s2>&quot;longonly&quot;</span><span class=p>,</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=gp>... </span>    <span class=n>init_cash</span><span class=o>=</span><span class=s2>&quot;auto&quot;</span><span class=p>,</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=gp>... </span>    <span class=n>broadcast_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>tile</span><span class=o>=</span><span class=n>tile</span><span class=p>)</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=go>strategy  symbol </span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=go>daily     BTC-USD    0.702259</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=go>          ETH-USD    0.782296</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=go>weekly    BTC-USD    0.838895</span>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=go>          ETH-USD    0.524215</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=go>Name: sharpe_ratio, dtype: float64</span>
</span></code></pre></div> <ol> <li>To represent two strategies, you need to tile the same data twice. Create a parameter with strategy names and pass it as <code>tile</code> to the broadcaster so it tiles the columns of each array (such as price) twice.</li> <li>The index dictionary includes index instructions as keys and data as values to set. Keys can be row indices, labels, or custom indexer classes such as <a href=https://vectorbt.pro/pvt_41531c19/api/base/indexing/#vectorbtpro.base.indexing.PointIdxr>PointIdxr</a>.</li> <li>Find the indices of the rows for the start of each day and the column index of "daily", then set each element at those indices to 100 (= accumulate).</li> <li>Find the indices of the rows that correspond to Sunday. If any value at those indices has already been set by a previous instruction, it will be overridden.</li> </ol> <h2 id=slicing>Slicing<a class=headerlink href=#slicing title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_3_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Similar to selecting columns, each VBT object can now slice rows using the same mechanism as in Pandas <img alt=🔪 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f52a.svg title=:knife:> This makes it easy to analyze and plot any subset of simulated data, without needing to re-simulate!</li> </ul> <div class="language-pycon highlight"><span class=filename>Analyze multiple date ranges of the same portfolio</span><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_holding</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s2>&quot;d&quot;</span><span class=p>)</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=go>1.116727709477293</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>loc</span><span class=p>[:</span><span class=s2>&quot;2020&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>sharpe_ratio</span>  <span class=c1># (1)!</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=go>1.2699801554196481</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s2>&quot;2021&quot;</span><span class=p>:</span> <span class=s2>&quot;2021&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>sharpe_ratio</span>  <span class=c1># (2)!</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=go>0.9825161170278687</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s2>&quot;2022&quot;</span><span class=p>:]</span><span class=o>.</span><span class=n>sharpe_ratio</span>  <span class=c1># (3)!</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=go>-1.0423271337174647</span>
</span></code></pre></div> <ol> <li>Get the Sharpe ratio during the year 2020 and before.</li> <li>Get the Sharpe ratio during the year 2021.</li> <li>Get the Sharpe ratio during the year 2022 and after.</li> </ol> <h2 id=column-stacking>Column stacking<a class=headerlink href=#column-stacking title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_3_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Complex VBT objects of the same type can be easily stacked along columns. For example, you can combine multiple unrelated trading strategies into one portfolio for analysis. Under the hood, the final object is still represented as a monolithic multi-dimensional structure that can be processed even faster than separate merged objects <img alt=🫁 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1fac1.svg title=:lungs:></li> </ul> <div class="language-pycon highlight"><span class=filename>Analyze two trading strategies separately and then jointly</span><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>strategy1</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=gp>... </span>    <span class=n>fast_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;fast_ma&quot;</span><span class=p>)</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=gp>... </span>    <span class=n>slow_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;slow_ma&quot;</span><span class=p>)</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=gp>... </span>    <span class=n>entries</span> <span class=o>=</span> <span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_above</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=gp>... </span>    <span class=n>exits</span> <span class=o>=</span> <span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_below</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_signals</span><span class=p>(</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=gp>... </span>        <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> 
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=gp>... </span>        <span class=n>entries</span><span class=p>,</span> 
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=gp>... </span>        <span class=n>exits</span><span class=p>,</span> 
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=gp>... </span>        <span class=n>size</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=gp>... </span>        <span class=n>size_type</span><span class=o>=</span><span class=s2>&quot;value&quot;</span><span class=p>,</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=gp>... </span>        <span class=n>init_cash</span><span class=o>=</span><span class=s2>&quot;auto&quot;</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>strategy2</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=gp>... </span>    <span class=n>bbands</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>BBANDS</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=gp>... </span>    <span class=n>entries</span> <span class=o>=</span> <span class=n>bbands</span><span class=o>.</span><span class=n>close_crossed_below</span><span class=p>(</span><span class=n>bbands</span><span class=o>.</span><span class=n>lower</span><span class=p>)</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=gp>... </span>    <span class=n>exits</span> <span class=o>=</span> <span class=n>bbands</span><span class=o>.</span><span class=n>close_crossed_above</span><span class=p>(</span><span class=n>bbands</span><span class=o>.</span><span class=n>upper</span><span class=p>)</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_signals</span><span class=p>(</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=gp>... </span>        <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> 
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=gp>... </span>        <span class=n>entries</span><span class=p>,</span> 
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=gp>... </span>        <span class=n>exits</span><span class=p>,</span> 
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=gp>... </span>        <span class=n>init_cash</span><span class=o>=</span><span class=mi>200</span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data1</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>BinanceData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTCUSDT&quot;</span><span class=p>)</span>
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf1</span> <span class=o>=</span> <span class=n>strategy1</span><span class=p>(</span><span class=n>data1</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf1</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a><span class=go>0.9100317671866922</span>
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a>
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>BinanceData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;ETHUSDT&quot;</span><span class=p>)</span>
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf2</span> <span class=o>=</span> <span class=n>strategy2</span><span class=p>(</span><span class=n>data2</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf2</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=go>-0.11596286232734827</span>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sep</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>column_stack</span><span class=p>((</span><span class=n>pf1</span><span class=p>,</span> <span class=n>pf2</span><span class=p>))</span>  <span class=c1># (3)!</span>
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sep</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=go>0    0.910032</span>
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a><span class=go>1   -0.115963</span>
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a><span class=go>Name: sharpe_ratio, dtype: float64</span>
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a>
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_join</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>column_stack</span><span class=p>((</span><span class=n>pf1</span><span class=p>,</span> <span class=n>pf2</span><span class=p>),</span> <span class=n>group_by</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># (4)!</span>
</span><span id=__span-19-43><a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_join</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-19-44><a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a><span class=go>0.42820898354646514</span>
</span></code></pre></div> <ol> <li>Analyze the first strategy in its own portfolio.</li> <li>Analyze the second strategy in its own portfolio.</li> <li>Analyze both strategies separately in the same portfolio.</li> <li>Analyze both strategies jointly in the same portfolio.</li> </ol> <h2 id=row-stacking>Row stacking<a class=headerlink href=#row-stacking title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_3_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Complex VBT objects of the same type can be easily stacked along rows. For example, you can append new data to an existing portfolio, or concatenate in-sample portfolios with their out-of-sample counterparts <img alt=🧬 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f9ec.svg title=:dna:></li> </ul> <div class="language-pycon highlight"><span class=filename>Analyze two date ranges separately and then jointly</span><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>strategy</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=gp>... </span>    <span class=n>fast_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;fast_ma&quot;</span><span class=p>)</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=gp>... </span>    <span class=n>slow_ma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>MA</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=n>short_name</span><span class=o>=</span><span class=s2>&quot;slow_ma&quot;</span><span class=p>)</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=gp>... </span>    <span class=n>entries</span> <span class=o>=</span> <span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_above</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=gp>... </span>    <span class=n>exits</span> <span class=o>=</span> <span class=n>fast_ma</span><span class=o>.</span><span class=n>ma_crossed_below</span><span class=p>(</span><span class=n>slow_ma</span><span class=p>)</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_signals</span><span class=p>(</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=gp>... </span>        <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>],</span> 
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=gp>... </span>        <span class=n>entries</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>],</span> 
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=gp>... </span>        <span class=n>exits</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>],</span> 
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=gp>... </span>        <span class=n>size</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=gp>... </span>        <span class=n>size_type</span><span class=o>=</span><span class=s2>&quot;value&quot;</span><span class=p>,</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=gp>... </span>        <span class=n>init_cash</span><span class=o>=</span><span class=s2>&quot;auto&quot;</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>BinanceData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTCUSDT&quot;</span><span class=p>)</span>
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_whole</span> <span class=o>=</span> <span class=n>strategy</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_whole</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=go>0.9100317671866922</span>
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a>
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sub1</span> <span class=o>=</span> <span class=n>strategy</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2019-12-31&quot;</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sub1</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=go>0.7810397448678937</span>
</span><span id=__span-20-24><a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a>
</span><span id=__span-20-25><a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sub2</span> <span class=o>=</span> <span class=n>strategy</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020-01-01&quot;</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-20-26><a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_sub2</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-20-27><a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=go>1.070339534746574</span>
</span><span id=__span-20-28><a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a>
</span><span id=__span-20-29><a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_join</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>row_stack</span><span class=p>((</span><span class=n>pf_sub1</span><span class=p>,</span> <span class=n>pf_sub2</span><span class=p>))</span>  <span class=c1># (4)!</span>
</span><span id=__span-20-30><a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf_join</span><span class=o>.</span><span class=n>sharpe_ratio</span>
</span><span id=__span-20-31><a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a><span class=go>0.9100317671866922</span>
</span></code></pre></div> <ol> <li>Analyze the entire range.</li> <li>Analyze the first date range.</li> <li>Analyze the second date range.</li> <li>Combine both date ranges and analyze them together.</li> </ol> <h2 id=index-alignment>Index alignment<a class=headerlink href=#index-alignment title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_3_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> There is no longer a limitation requiring each Pandas array to have the same index. Indexes of all arrays that should broadcast against each other are automatically aligned, as long as they have the same data type.</li> </ul> <div class="language-pycon highlight"><span class=filename>Predict ETH price with BTC price using linear regression</span><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>btc_data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=go>(2817, 7)</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>eth_data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;ETH-USD&quot;</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>eth_data</span><span class=o>.</span><span class=n>wrapper</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=go>(1668, 7)</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ols</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>OLS</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>  <span class=c1># (2)!</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=gp>... </span>    <span class=n>btc_data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=gp>... </span>    <span class=n>eth_data</span><span class=o>.</span><span class=n>close</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>ols</span><span class=o>.</span><span class=n>pred</span>
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=go>Date</span>
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a><span class=go>2014-09-17 00:00:00+00:00            NaN</span>
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a><span class=go>2014-09-18 00:00:00+00:00            NaN</span>
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=go>2014-09-19 00:00:00+00:00            NaN</span>
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a><span class=go>2014-09-20 00:00:00+00:00            NaN</span>
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a><span class=go>2014-09-21 00:00:00+00:00            NaN</span>
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a><span class=go>...                                  ...</span>
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a><span class=go>2022-05-30 00:00:00+00:00    2109.769242</span>
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a><span class=go>2022-05-31 00:00:00+00:00    2028.856767</span>
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a><span class=go>2022-06-01 00:00:00+00:00    1911.555689</span>
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a><span class=go>2022-06-02 00:00:00+00:00    1930.169725</span>
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a><span class=go>2022-06-03 00:00:00+00:00    1882.573170</span>
</span><span id=__span-21-26><a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a><span class=go>Freq: D, Name: Close, Length: 2817, dtype: float64</span>
</span></code></pre></div> <ol> <li>ETH-USD history is shorter than BTC-USD history.</li> <li>This now works! Make sure all arrays share the same timeframe and timezone.</li> </ol> <h2 id=numba-datetime>Numba datetime<a class=headerlink href=#numba-datetime title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_2_3.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Numba does not support datetime indexes (or any other Pandas objects). There are also no built-in Numba functions for working with datetime. So, how do you connect data to time? VBT addresses this gap by implementing a collection of functions to extract various information from each timestamp, such as the current time and day of the week, to determine whether the bar is during trading hours.</li> </ul> <div class="admonition example"> <p class=admonition-title>Tutorial</p> <p>Learn more in the <a href=https://vectorbt.pro/pvt_41531c19/tutorials/signal-development>Signal development</a> tutorial.</p> </div> <div class="language-pycon highlight"><span class=filename>Plot the percentage change from the start of the month to now</span><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nd>@njit</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=gp>... </span><span class=k>def</span><span class=w> </span><span class=nf>month_start_pct_change_nb</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>index</span><span class=p>):</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=gp>... </span>    <span class=n>out</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=n>arr</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>)</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=gp>... </span>    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>arr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=gp>... </span>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>arr</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]):</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=gp>... </span>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>vbt</span><span class=o>.</span><span class=n>dt_nb</span><span class=o>.</span><span class=n>month_nb</span><span class=p>(</span><span class=n>index</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>])</span> <span class=o>!=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>dt_nb</span><span class=o>.</span><span class=n>month_nb</span><span class=p>(</span><span class=n>index</span><span class=p>[</span><span class=n>i</span><span class=p>]):</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=gp>... </span>                <span class=n>month_start_value</span> <span class=o>=</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=gp>... </span>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=gp>... </span>                <span class=n>out</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span> <span class=o>-</span> <span class=n>month_start_value</span><span class=p>)</span> <span class=o>/</span> <span class=n>month_start_value</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>out</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2023&quot;</span><span class=p>)</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pct_change</span> <span class=o>=</span> <span class=n>month_start_pct_change_nb</span><span class=p>(</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>to_2d_array</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>),</span> 
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>to_ns</span><span class=p>()</span>  <span class=c1># (1)!</span>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pct_change</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>symbol_wrapper</span><span class=o>.</span><span class=n>wrap</span><span class=p>(</span><span class=n>pct_change</span><span class=p>)</span>
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pct_change</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Convert the datetime index to nanosecond format.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/numba_datetime.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/numba_datetime.dark.svg#only-dark></p> <h2 id=periods-ago>Periods ago<a class=headerlink href=#periods-ago title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_2_3.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Instead of writing Numba functions, comparing values at different bars can also be done in a vectorized way with Pandas. The problem is that there are no built-in functions to easily shift values based on timedeltas, nor are there rolling functions to check whether an event happened during a past period. This gap is filled by various new accessor methods.</li> </ul> <div class="admonition example"> <p class=admonition-title>Tutorial</p> <p>Learn more in the <a href=https://vectorbt.pro/pvt_41531c19/tutorials/signal-development>Signal development</a> tutorial.</p> </div> <div class="language-pycon highlight"><span class=filename>Check whether the price dropped for 5 consecutive bars</span><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2022-05&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2022-08&quot;</span><span class=p>)</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span> <span class=o>&lt;</span> <span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>ago</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>all_ago</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>plot_volume</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mask</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>signals</span><span class=o>.</span><span class=n>ranges</span><span class=o>.</span><span class=n>plot_shapes</span><span class=p>(</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=gp>... </span>    <span class=n>plot_close</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=gp>... </span>    <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span> 
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=gp>... </span>    <span class=n>shape_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>fillcolor</span><span class=o>=</span><span class=s2>&quot;orangered&quot;</span><span class=p>)</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/periods_ago.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/periods_ago.dark.svg#only-dark></p> <h2 id=safe-resampling>Safe resampling<a class=headerlink href=#safe-resampling title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_1_2.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <a href=https://www.investopedia.com/terms/l/lookaheadbias.asp>Look-ahead bias</a> is an ongoing risk when working with array data, especially on multiple time frames. Using Pandas alone is strongly discouraged because it does not recognize that financial data mainly involves bars where timestamps are the opening times, and events may occur at any time between bars. Pandas thus incorrectly assumes that timestamps indicate the exact time of an event. In VBT, there is a complete collection of functions and classes for safely resampling and analyzing data!</li> </ul> <div class="admonition example"> <p class=admonition-title>Tutorial</p> <p>Learn more in the <a href=https://vectorbt.pro/pvt_41531c19/tutorials/mtf-analysis>MTF analysis</a> tutorial.</p> </div> <div class="language-pycon highlight"><span class=filename>Calculate SMA on multiple time frames and display on the same chart</span><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>mtf_sma</span><span class=p>(</span><span class=n>close</span><span class=p>,</span> <span class=n>close_freq</span><span class=p>,</span> <span class=n>target_freq</span><span class=p>,</span> <span class=n>timeperiod</span><span class=o>=</span><span class=mi>5</span><span class=p>):</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=gp>... </span>    <span class=n>target_close</span> <span class=o>=</span> <span class=n>close</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>realign_closing</span><span class=p>(</span><span class=n>target_freq</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=gp>... </span>    <span class=n>target_sma</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>talib</span><span class=p>(</span><span class=s2>&quot;SMA&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>target_close</span><span class=p>,</span> <span class=n>timeperiod</span><span class=o>=</span><span class=n>timeperiod</span><span class=p>)</span><span class=o>.</span><span class=n>real</span>  <span class=c1># (2)!</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=gp>... </span>    <span class=n>target_sma</span> <span class=o>=</span> <span class=n>target_sma</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;SMA (</span><span class=si>{</span><span class=n>target_freq</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>)</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>target_sma</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>realign_closing</span><span class=p>(</span><span class=n>close</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=n>close_freq</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2023&quot;</span><span class=p>)</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span> <span class=o>=</span> <span class=n>mtf_sma</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=s2>&quot;D&quot;</span><span class=p>,</span> <span class=s2>&quot;daily&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mtf_sma</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=s2>&quot;D&quot;</span><span class=p>,</span> <span class=s2>&quot;weekly&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mtf_sma</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=s2>&quot;D&quot;</span><span class=p>,</span> <span class=s2>&quot;monthly&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Resample the source frequency to the target frequency. Since Close occurs at the end of the bar, resample it as a "closing event".</li> <li>Calculate the SMA on the target frequency.</li> <li>Resample the target frequency back to the source frequency to show multiple time frames on the same chart. Because <code>close</code> contains gaps, you cannot simply resample to <code>close_freq</code> as this might produce unaligned series. Instead, resample directly to the index of <code>close</code>.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/safe_resampling.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/safe_resampling.dark.svg#only-dark></p> <h2 id=resamplable-objects>Resamplable objects<a class=headerlink href=#resamplable-objects title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_1_2.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> You can resample not only time series, but also complex VBT objects! Under the hood, each object is made up of a collection of array-like attributes, so resampling means aggregating all the related information together. This is especially helpful if you want to simulate at a higher frequency for maximum accuracy and then analyze at a lower frequency for better speed.</li> </ul> <div class="admonition example"> <p class=admonition-title>Tutorial</p> <p>Learn more in the <a href=https://vectorbt.pro/pvt_41531c19/tutorials/mtf-analysis>MTF analysis</a> tutorial.</p> </div> <div class="language-pycon highlight"><span class=filename>Plot the monthly return heatmap of a random portfolio</span><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>calendar</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2018&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2023&quot;</span><span class=p>)</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>pf</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>direction</span><span class=o>=</span><span class=s2>&quot;both&quot;</span><span class=p>)</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mo_returns</span> <span class=o>=</span> <span class=n>pf</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s2>&quot;M&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>returns</span>  <span class=c1># (1)!</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mo_return_matrix</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=gp>... </span>    <span class=n>mo_returns</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> 
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=gp>... </span>    <span class=n>index</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_arrays</span><span class=p>([</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=gp>... </span>        <span class=n>mo_returns</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=gp>... </span>        <span class=n>mo_returns</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>month</span>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=gp>... </span>    <span class=p>],</span> <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;year&quot;</span><span class=p>,</span> <span class=s2>&quot;month&quot;</span><span class=p>])</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=s2>&quot;month&quot;</span><span class=p>)</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mo_return_matrix</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>mo_return_matrix</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>calendar</span><span class=o>.</span><span class=n>month_abbr</span><span class=p>[</span><span class=n>x</span><span class=p>])</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mo_return_matrix</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=gp>... </span>    <span class=n>is_x_category</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=gp>... </span>    <span class=n>trace_kwargs</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>zmid</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>colorscale</span><span class=o>=</span><span class=s2>&quot;Spectral&quot;</span><span class=p>)</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=gp>... </span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <ol> <li>Resample the entire portfolio to monthly frequency and calculate the returns.</li> </ol> <p><img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/monthly_return_heatmap.light.svg#only-light> <img alt class=iimg loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/images/features/monthly_return_heatmap.dark.svg#only-dark></p> <h2 id=formatting-engine>Formatting engine<a class=headerlink href=#formatting-engine title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_0_2.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> VBT is a comprehensive library that defines thousands of classes, functions, and objects. When working with these, you may want to "look inside" an object to better understand its attributes and contents. Fortunately, there is a formatting engine that can accurately format any in-house object as a human-readable string. Did you know the API documentation is partly powered by this engine? <img alt=😉 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f609.svg title=:wink:></li> </ul> <div class="language-pycon highlight"><span class=filename>Introspect a data instance</span><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2021&quot;</span><span class=p>)</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pprint</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=go>YFData(</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=go>    wrapper=ArrayWrapper(...),</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=go>    data=symbol_dict({</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=go>        &#39;BTC-USD&#39;: &lt;pandas.core.frame.DataFrame object at 0x7f7f1fbc6cd0 with shape (366, 7)&gt;</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=go>    }),</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=go>    single_key=True,</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=go>    classes=symbol_dict(),</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=go>    fetch_kwargs=symbol_dict({</span>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=go>        &#39;BTC-USD&#39;: dict(</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=go>            start=&#39;2020&#39;,</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=go>            end=&#39;2021&#39;</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=go>        )</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=go>    }),</span>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=go>    returned_kwargs=symbol_dict({</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=go>        &#39;BTC-USD&#39;: dict()</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a><span class=go>    }),</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=go>    last_index=symbol_dict({</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a><span class=go>        &#39;BTC-USD&#39;: Timestamp(&#39;2020-12-31 00:00:00+0000&#39;, tz=&#39;UTC&#39;)</span>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=go>    }),</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=go>    tz_localize=datetime.timezone.utc,</span>
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=go>    tz_convert=&#39;UTC&#39;,</span>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a><span class=go>    missing_index=&#39;nan&#39;,</span>
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a><span class=go>    missing_columns=&#39;raise&#39;</span>
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a><span class=go>)</span>
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a>
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pdir</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a><span class=go>                                            type                                             path</span>
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a><span class=go>attr                                                                                                     </span>
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a><span class=go>align_columns                        classmethod                       vectorbtpro.data.base.Data</span>
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a><span class=go>align_index                          classmethod                       vectorbtpro.data.base.Data</span>
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a><span class=go>build_feature_config_doc             classmethod                       vectorbtpro.data.base.Data</span>
</span><span id=__span-26-35><a id=__codelineno-26-35 name=__codelineno-26-35 href=#__codelineno-26-35></a><span class=go>...                                          ...                                              ...</span>
</span><span id=__span-26-36><a id=__codelineno-26-36 name=__codelineno-26-36 href=#__codelineno-26-36></a><span class=go>vwap                                    property                       vectorbtpro.data.base.Data</span>
</span><span id=__span-26-37><a id=__codelineno-26-37 name=__codelineno-26-37 href=#__codelineno-26-37></a><span class=go>wrapper                                 property               vectorbtpro.base.wrapping.Wrapping</span>
</span><span id=__span-26-38><a id=__codelineno-26-38 name=__codelineno-26-38 href=#__codelineno-26-38></a><span class=go>xs                                      function          vectorbtpro.base.indexing.PandasIndexer</span>
</span><span id=__span-26-39><a id=__codelineno-26-39 name=__codelineno-26-39 href=#__codelineno-26-39></a>
</span><span id=__span-26-40><a id=__codelineno-26-40 name=__codelineno-26-40 href=#__codelineno-26-40></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>phelp</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-26-41><a id=__codelineno-26-41 name=__codelineno-26-41 href=#__codelineno-26-41></a><span class=go>YFData.get(</span>
</span><span id=__span-26-42><a id=__codelineno-26-42 name=__codelineno-26-42 href=#__codelineno-26-42></a><span class=go>    columns=None,</span>
</span><span id=__span-26-43><a id=__codelineno-26-43 name=__codelineno-26-43 href=#__codelineno-26-43></a><span class=go>    symbols=None,</span>
</span><span id=__span-26-44><a id=__codelineno-26-44 name=__codelineno-26-44 href=#__codelineno-26-44></a><span class=go>    **kwargs</span>
</span><span id=__span-26-45><a id=__codelineno-26-45 name=__codelineno-26-45 href=#__codelineno-26-45></a><span class=go>):</span>
</span><span id=__span-26-46><a id=__codelineno-26-46 name=__codelineno-26-46 href=#__codelineno-26-46></a><span class=go>    Get one or more columns of one or more symbols of data.</span>
</span></code></pre></div> <ol> <li>Similar to Python's <code>print</code> command, pretty-prints the contents of any VBT object.</li> <li>Similar to Python's <code>dir</code> command, pretty-prints the attributes of a class, object, or module.</li> <li>Similar to Python's <code>help</code> command, pretty-prints the signature and docstring of a function.</li> </ol> <h2 id=meta-methods>Meta methods<a class=headerlink href=#meta-methods title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_0_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Many methods, such as rolling apply, now come in two versions: regular (instance methods) and meta (class methods). Regular methods are bound to a single array and do not need metadata, while meta methods are not tied to any array and act as micro-pipelines with their own broadcasting and templating logic. Here, VBT solves one of the main Pandas limitations: the inability to apply a function to multiple arrays at once.</li> </ul> <div class="language-pycon highlight"><span class=filename>Compute the rolling z-score on one array and the rolling correlation coefficient on two arrays</span><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=gp>&gt;&gt;&gt; </span><span class=nd>@njit</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=gp>... </span><span class=k>def</span><span class=w> </span><span class=nf>zscore_nb</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>  <span class=c1># (1)!</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=gp>... </span>    <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>x</span><span class=p>))</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2021&quot;</span><span class=p>)</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>14</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>zscore_nb</span><span class=p>,</span> <span class=n>raw</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># (2)!</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=go>Date</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=go>2020-01-01 00:00:00+00:00         NaN</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=go>                                  ...</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=go>2020-12-27 00:00:00+00:00    1.543527</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=go>2020-12-28 00:00:00+00:00    1.734715</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=go>2020-12-29 00:00:00+00:00    1.755125</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=go>2020-12-30 00:00:00+00:00    2.107147</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=go>2020-12-31 00:00:00+00:00    1.781800</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=go>Freq: D, Name: Close, Length: 366, dtype: float64</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>rolling_apply</span><span class=p>(</span><span class=mi>14</span><span class=p>,</span> <span class=n>zscore_nb</span><span class=p>)</span>  <span class=c1># (3)!</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=go>2020-01-01 00:00:00+00:00         NaN</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=go>                                  ...</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=go>2020-12-27 00:00:00+00:00    1.543527</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a><span class=go>2020-12-28 00:00:00+00:00    1.734715</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a><span class=go>2020-12-29 00:00:00+00:00    1.755125</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a><span class=go>2020-12-30 00:00:00+00:00    2.107147</span>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a><span class=go>2020-12-31 00:00:00+00:00    1.781800</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=go>Freq: D, Name: Close, Length: 366, dtype: float64</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a><span class=gp>&gt;&gt;&gt; </span><span class=nd>@njit</span>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a><span class=gp>... </span><span class=k>def</span><span class=w> </span><span class=nf>corr_meta_nb</span><span class=p>(</span><span class=n>from_i</span><span class=p>,</span> <span class=n>to_i</span><span class=p>,</span> <span class=n>col</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>  <span class=c1># (4)!</span>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a><span class=gp>... </span>    <span class=n>a_window</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>from_i</span><span class=p>:</span><span class=n>to_i</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span>
</span><span id=__span-27-30><a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a><span class=gp>... </span>    <span class=n>b_window</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=n>from_i</span><span class=p>:</span><span class=n>to_i</span><span class=p>,</span> <span class=n>col</span><span class=p>]</span>
</span><span id=__span-27-31><a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>corrcoef</span><span class=p>(</span><span class=n>a_window</span><span class=p>,</span> <span class=n>b_window</span><span class=p>)[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-27-32><a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a>
</span><span id=__span-27-33><a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data2</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;ETH-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;XRP-USD&quot;</span><span class=p>],</span> <span class=n>start</span><span class=o>=</span><span class=s2>&quot;2020&quot;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;2021&quot;</span><span class=p>)</span>
</span><span id=__span-27-34><a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a><span class=gp>&gt;&gt;&gt; </span><span class=n>vbt</span><span class=o>.</span><span class=n>pd_acc</span><span class=o>.</span><span class=n>rolling_apply</span><span class=p>(</span>  <span class=c1># (5)!</span>
</span><span id=__span-27-35><a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a><span class=gp>... </span>    <span class=mi>14</span><span class=p>,</span> 
</span><span id=__span-27-36><a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a><span class=gp>... </span>    <span class=n>corr_meta_nb</span><span class=p>,</span> 
</span><span id=__span-27-37><a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>Rep</span><span class=p>(</span><span class=s2>&quot;a&quot;</span><span class=p>),</span>
</span><span id=__span-27-38><a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>Rep</span><span class=p>(</span><span class=s2>&quot;b&quot;</span><span class=p>),</span>
</span><span id=__span-27-39><a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a><span class=gp>... </span>    <span class=n>broadcast_named_args</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>a</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=n>data2</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-27-40><a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-27-41><a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a><span class=go>symbol                      ETH-USD   XRP-USD</span>
</span><span id=__span-27-42><a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a><span class=go>Date                                         </span>
</span><span id=__span-27-43><a id=__codelineno-27-43 name=__codelineno-27-43 href=#__codelineno-27-43></a><span class=go>2020-01-01 00:00:00+00:00       NaN       NaN</span>
</span><span id=__span-27-44><a id=__codelineno-27-44 name=__codelineno-27-44 href=#__codelineno-27-44></a><span class=go>...                             ...       ...</span>
</span><span id=__span-27-45><a id=__codelineno-27-45 name=__codelineno-27-45 href=#__codelineno-27-45></a><span class=go>2020-12-27 00:00:00+00:00  0.636862 -0.511303</span>
</span><span id=__span-27-46><a id=__codelineno-27-46 name=__codelineno-27-46 href=#__codelineno-27-46></a><span class=go>2020-12-28 00:00:00+00:00  0.674514 -0.622894</span>
</span><span id=__span-27-47><a id=__codelineno-27-47 name=__codelineno-27-47 href=#__codelineno-27-47></a><span class=go>2020-12-29 00:00:00+00:00  0.712531 -0.773791</span>
</span><span id=__span-27-48><a id=__codelineno-27-48 name=__codelineno-27-48 href=#__codelineno-27-48></a><span class=go>2020-12-30 00:00:00+00:00  0.839355 -0.772295</span>
</span><span id=__span-27-49><a id=__codelineno-27-49 name=__codelineno-27-49 href=#__codelineno-27-49></a><span class=go>2020-12-31 00:00:00+00:00  0.878897 -0.764446</span>
</span><span id=__span-27-50><a id=__codelineno-27-50 name=__codelineno-27-50 href=#__codelineno-27-50></a>
</span><span id=__span-27-51><a id=__codelineno-27-51 name=__codelineno-27-51 href=#__codelineno-27-51></a><span class=go>[366 rows x 2 columns]</span>
</span></code></pre></div> <ol> <li>Provides access to the window only.</li> <li>Using Pandas.</li> <li>Using the regular method, which accepts the same function as Pandas.</li> <li>Provides access to one or more entire arrays.</li> <li>Using the meta method, which accepts metadata and variable arguments.</li> </ol> <h2 id=array-expressions>Array expressions<a class=headerlink href=#array-expressions title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_0_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> When combining multiple arrays, they often need to be aligned and broadcast before the operation itself. Pandas alone often falls short because it can be too strict. Fortunately, VBT includes an accessor class method that can take a regular Python expression, identify all variable names, extract the arrays from the current context, broadcast them, and then evaluate the expression (with support for <a href=https://github.com/pydata/numexpr>NumExpr</a>!) <img alt=⌨ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2328.svg title=:keyboard:></li> </ul> <div class="language-pycon highlight"><span class=filename>Evaluate a multiline array expression based on a Bollinger Bands indicator</span><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>])</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>low</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>low</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>high</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>high</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>bb</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>talib</span><span class=p>(</span><span class=s2>&quot;BBANDS&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>)</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=gp>&gt;&gt;&gt; </span><span class=n>upperband</span> <span class=o>=</span> <span class=n>bb</span><span class=o>.</span><span class=n>upperband</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>lowerband</span> <span class=o>=</span> <span class=n>bb</span><span class=o>.</span><span class=n>lowerband</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>bandwidth</span> <span class=o>=</span> <span class=p>(</span><span class=n>bb</span><span class=o>.</span><span class=n>upperband</span> <span class=o>-</span> <span class=n>bb</span><span class=o>.</span><span class=n>lowerband</span><span class=p>)</span> <span class=o>/</span> <span class=n>bb</span><span class=o>.</span><span class=n>middleband</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=gp>&gt;&gt;&gt; </span><span class=n>up_th</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>([</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>])</span> 
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>low_th</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>Param</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>])</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>expr</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=gp>... </span><span class=s2>narrow_bands = bandwidth &lt; low_th</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=gp>... </span><span class=s2>above_upperband = high &gt; upperband</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=gp>... </span><span class=s2>wide_bands = bandwidth &gt; up_th</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=gp>... </span><span class=s2>below_lowerband = low &lt; lowerband</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a><span class=gp>... </span><span class=s2>(narrow_bands &amp; above_upperband) | (wide_bands &amp; below_lowerband)</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a><span class=gp>... </span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mask</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>pd_acc</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mask</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=go>low_th  up_th  symbol </span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a><span class=go>0.1     0.3    BTC-USD    344</span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=go>               ETH-USD    171</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=go>        0.4    BTC-USD    334</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a><span class=go>               ETH-USD    158</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=go>0.2     0.3    BTC-USD    444</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=go>               ETH-USD    253</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a><span class=go>        0.4    BTC-USD    434</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a><span class=go>               ETH-USD    240</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a><span class=go>dtype: int64</span>
</span></code></pre></div> <h2 id=resource-management>Resource management<a class=headerlink href=#resource-management title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_0_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> New profiling tools help you measure the execution time and memory usage of any code block <img alt=🧰 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f9f0.svg title=:toolbox:></li> </ul> <div class="language-pycon highlight"><span class=filename>Profile getting the Sharpe ratio of a random portfolio</span><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>)</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=gp>&gt;&gt;&gt; </span><span class=k>with</span> <span class=p>(</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>Timer</span><span class=p>()</span> <span class=k>as</span> <span class=n>timer</span><span class=p>,</span> 
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>MemTracer</span><span class=p>()</span> <span class=k>as</span> <span class=n>mem_tracer</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=gp>... </span><span class=p>):</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=gp>... </span>    <span class=nb>print</span><span class=p>(</span><span class=n>vbt</span><span class=o>.</span><span class=n>PF</span><span class=o>.</span><span class=n>from_random_signals</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>close</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span><span class=o>.</span><span class=n>sharpe_ratio</span><span class=p>)</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=go>0.33111243921865163</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>timer</span><span class=o>.</span><span class=n>elapsed</span><span class=p>())</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=go>74.15 milliseconds</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>mem_tracer</span><span class=o>.</span><span class=n>peak_usage</span><span class=p>())</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=go>459.7 kB</span>
</span></code></pre></div> <h2 id=templates>Templates<a class=headerlink href=#templates title="Permanent link">&para;</a></h2> <p><img alt loading=lazy src=https://vectorbt.pro/pvt_41531c19/assets/badges/new-in/1_0_0.svg></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> It is easy to extend classes, but since VBT revolves around functions, how do we enhance them or change their workflow? The easiest way is to introduce a small function (i.e., callback) that the user can provide and that the main function calls at some point. However, this would require the main function to know what arguments to pass to the callback and how to handle its outputs. Here is a better idea: allow most arguments of the main function to become callbacks, then execute those to obtain their actual values. These arguments are called "templates" and this process is known as "substitution". Templates are especially useful when some arguments (such as arrays) should be built only once all required information is available, for example, when other arrays have already been broadcast. Each substitution opportunity has its own identifier so you can control when a template should be substituted. In VBT, templates are first-class citizens and are integrated into most functions for unmatched flexibility! <img alt=🧞 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f9de.svg title=:genie:></li> </ul> <div class="language-pycon highlight"><span class=filename>Design a template-enhanced resampling functionality</span><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=gp>&gt;&gt;&gt; </span><span class=k>def</span><span class=w> </span><span class=nf>resample_apply</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>by</span><span class=p>,</span> <span class=n>apply_func</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>template_context</span><span class=o>=</span><span class=p>{},</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=gp>... </span>    <span class=n>grouper</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>vbt</span><span class=o>.</span><span class=n>get_grouper</span><span class=p>(</span><span class=n>by</span><span class=p>)</span>  <span class=c1># (1)!</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=gp>... </span>    <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=gp>... </span>    <span class=k>with</span> <span class=n>vbt</span><span class=o>.</span><span class=n>ProgressBar</span><span class=p>()</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=gp>... </span>        <span class=k>for</span> <span class=n>group</span><span class=p>,</span> <span class=n>group_idxs</span> <span class=ow>in</span> <span class=n>grouper</span><span class=p>:</span>  <span class=c1># (2)!</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=gp>... </span>            <span class=n>group_index</span> <span class=o>=</span> <span class=n>index</span><span class=p>[</span><span class=n>group_idxs</span><span class=p>]</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=gp>... </span>            <span class=n>context</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;group&quot;</span><span class=p>:</span> <span class=n>group</span><span class=p>,</span> <span class=s2>&quot;group_index&quot;</span><span class=p>:</span> <span class=n>group_index</span><span class=p>,</span> <span class=o>**</span><span class=n>template_context</span><span class=p>}</span>  <span class=c1># (3)!</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=gp>... </span>            <span class=n>final_apply_func</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>substitute_templates</span><span class=p>(</span><span class=n>apply_func</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>eval_id</span><span class=o>=</span><span class=s2>&quot;apply_func&quot;</span><span class=p>)</span>  <span class=c1># (4)!</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=gp>... </span>            <span class=n>final_args</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>substitute_templates</span><span class=p>(</span><span class=n>args</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>eval_id</span><span class=o>=</span><span class=s2>&quot;args&quot;</span><span class=p>)</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=gp>... </span>            <span class=n>final_kwargs</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>substitute_templates</span><span class=p>(</span><span class=n>kwargs</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>eval_id</span><span class=o>=</span><span class=s2>&quot;kwargs&quot;</span><span class=p>)</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a><span class=gp>... </span>            <span class=n>results</span><span class=p>[</span><span class=n>group</span><span class=p>]</span> <span class=o>=</span> <span class=n>final_apply_func</span><span class=p>(</span><span class=o>*</span><span class=n>final_args</span><span class=p>,</span> <span class=o>**</span><span class=n>final_kwargs</span><span class=p>)</span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=gp>... </span>            <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>()</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a><span class=gp>... </span>    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=gp>&gt;&gt;&gt; </span><span class=n>data</span> <span class=o>=</span> <span class=n>vbt</span><span class=o>.</span><span class=n>YFData</span><span class=o>.</span><span class=n>pull</span><span class=p>([</span><span class=s2>&quot;BTC-USD&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>],</span> <span class=n>missing_index</span><span class=o>=</span><span class=s2>&quot;drop&quot;</span><span class=p>)</span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>resample_apply</span><span class=p>(</span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=gp>... </span>    <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=s2>&quot;Y&quot;</span><span class=p>,</span> 
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=gp>... </span>    <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=n>y</span><span class=p>),</span>  <span class=c1># (5)!</span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>RepEval</span><span class=p>(</span><span class=s2>&quot;btc_close[group_index]&quot;</span><span class=p>),</span>  <span class=c1># (6)!</span>
</span><span id=__span-30-20><a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a><span class=gp>... </span>    <span class=n>vbt</span><span class=o>.</span><span class=n>RepEval</span><span class=p>(</span><span class=s2>&quot;eth_close[group_index]&quot;</span><span class=p>),</span>
</span><span id=__span-30-21><a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a><span class=gp>... </span>    <span class=n>template_context</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span>
</span><span id=__span-30-22><a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=gp>... </span>        <span class=n>btc_close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>,</span> <span class=s2>&quot;BTC-USD&quot;</span><span class=p>),</span>  <span class=c1># (7)!</span>
</span><span id=__span-30-23><a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=gp>... </span>        <span class=n>eth_close</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;Close&quot;</span><span class=p>,</span> <span class=s2>&quot;ETH-USD&quot;</span><span class=p>)</span>
</span><span id=__span-30-24><a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a><span class=gp>... </span>    <span class=p>)</span>
</span><span id=__span-30-25><a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <ol> <li>Builds a grouper. Accepts both group-by and resample instructions.</li> <li>Iterates over groups in the grouper. Each group contains a label (such as <code>2017-01-01 00:00:00+00:00</code>) and the row indices corresponding to this label.</li> <li>Creates a new context with information about the current group and any external information provided by the user.</li> <li>Substitutes the function and arguments using the newly populated context.</li> <li>Simple function to compute the correlation coefficient between two arrays.</li> <li>Defines both arguments as expression templates where data is selected for each group. All variables in these expressions will be automatically recognized and replaced by the current context. After evaluation, the templates will be replaced by their outputs.</li> <li>Specifies any additional information your templates depend on.</li> </ol> <p> <div class="progress progress-100plus candystripe candystripe-animate"> <div class=progress-bar style=width:100.00%> <p class=progress-label>Group 7/7</p> </div> </div> </p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=go>2017    0.808930</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=go>2018    0.897112</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=go>2019    0.753659</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=go>2020    0.940741</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=go>2021    0.553255</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=go>2022    0.975911</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=go>2023    0.974914</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=go>Freq: A-DEC, dtype: float64</span>
</span></code></pre></div> <h2 id=and-many-more>And many more...<a class=headerlink href=#and-many-more title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Look forward to more killer features being added every week!</li> </ul> <p><a class=md-button href=https://vectorbt.pro/pvt_41531c19/assets/jupytext/features/productivity.py.txt target=blank_><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89s.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89s-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"/></svg></span> Python code</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/features/portfolio/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Portfolio"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Portfolio </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class="md-footer__link md-footer__link--next" aria-label="Next: Overview"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/features/productivity/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:46:28 GMT -->
</html>