<!doctype html><html lang=en class=no-js> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:48:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Module providing core Numba-compiled functions for portfolio simulation"><meta name=author content="Oleg Polakow"><link href=https://vectorbt.pro/api/portfolio/nb/core/ rel=canonical><link href=../analysis/index.html rel=prev><link href=../ctx_helpers/index.html rel=next><link rel=icon href=../../../../assets/logo/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.6.21+insiders-4.53.17"><title>core - VectorBT® PRO</title><link rel=stylesheet href=../../../../assets/stylesheets/main.010a373c.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=../../../../../../fonts.gstatic.com/index.html crossorigin><link rel=stylesheet href="../../../../../../fonts.googleapis.com/cssbe43.css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../../assets/stylesheets/custom-light.css><link rel=stylesheet href=../../../../assets/stylesheets/custom-dark.css><link rel=stylesheet href=../../../../assets/stylesheets/pygments-light.css><link rel=stylesheet href=../../../../assets/stylesheets/pygments-dark.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-0C5VNYCFHL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-0C5VNYCFHL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="../../../../../../www.googletagmanager.com/gtag/jsc6c8?id=G-0C5VNYCFHL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta name=robots content="noindex, nofollow"><meta property=og:title content=core><meta property=og:type content=website><meta content=https://vectorbt.pro/api/portfolio/nb/core/ property=og:url><meta property=og:image:url content=https://vectorbt.pro/pvt_41531c19/assets/logo/social-new.png><meta property=og:image:type content=image/png><meta property=og:description content="Module providing core Numba-compiled functions for portfolio simulation"><meta property=og:locale content=en-GB><link rel=apple-touch-icon sizes=180x180 href=https://vectorbt.pro/pvt_41531c19/assets/logo/apple-touch-icon.png><link rel=icon type=image/svg+xml href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon-16x16.png><link rel=manifest href=https://vectorbt.pro/pvt_41531c19/assets/logo/site.webmanifest><link rel=mask-icon href=https://vectorbt.pro/pvt_41531c19/assets/logo/safari-pinned-tab.svg color=#1e1f22><link rel="shortcut icon" href=https://vectorbt.pro/pvt_41531c19/assets/logo/favicon.ico><meta name=msapplication-TileColor content=#1e1f22><meta name=msapplication-config content=https://vectorbt.pro/pvt_41531c19/assets/logo/browserconfig.xml><meta name=theme-color content=#1e1f22><link href=https://unpkg.com/aos@2.3.4/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.4/dist/aos.js></script><link href=http://fonts.cdnfonts.com/css/uni-neue rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=preconnect href=https://fonts.googleapis.com/><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin></head> <body dir=ltr data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#vectorbtpro.portfolio.nb.core class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> <i>What's new</i>: New LLM providers, reasoning steps, function calling, YAML & TOML support, and <a href=https://vectorbt.pro/pvt_41531c19/getting-started/release-notes><strong>more</strong></a> <span class="twemoji announce-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m153.6 29.9 16-21.3c4-5.4 10.4-8.6 17.1-8.6C198.4 0 208 9.6 208 21.3v22.1c0 13.1 5.4 25.7 14.9 34.7l84.7 80.9c48.8 46.6 76.4 111.2 76.4 178.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6 12.5 0 22.6 10.1 22.6 22.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7 0-27.7 9-54.8 25.6-76.9"/></svg></span> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <!-- Determine class according to configuration --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=header.title> <!-- Link to home --> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-header__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VectorBT® PRO <span class=md-version> v2025.10.15 </span> <span class=unlock-icon><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 32c-35.3 0-64 28.7-64 64v64h192c35.3 0 64 28.7 64 64v224c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64V96c0-70.7 57.3-128 128-128 63.5 0 116.1 46.1 126.2 106.7 2.9 17.4-8.8 33.9-26.3 36.9S258 102.8 255 85.3C250 55.1 223.7 32 192 32m40 328c13.3 0 24-10.7 24-24s-10.7-24-24-24h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24z"/></svg></span> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> core </span> </div> </div> </div> <!-- Color palette --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=custom-dark data-md-color-primary=custom-dark data-md-color-accent=custom-dark aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=custom-light data-md-color-primary=custom-light data-md-color-accent=custom-light aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <!-- Site language selector --> <!-- Button to open search modal --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-tabs__link> Cookbook </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-tabs__link> Terms </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://vectorbt.pro/pvt_41531c19/ title="VectorBT® PRO" class="md-nav__button md-logo" aria-label="VectorBT® PRO" data-md-component=logo> <img src=https://vectorbt.pro/pvt_41531c19/assets/logo/logo.svg alt=logo class=logo> </a> VectorBT® PRO </label> <div class=md-nav__source> <a href=https://github.com/polakowo/vectorbt.pro title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vectorbt.pro </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/features/overview/ class=md-nav__link> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/tutorials/overview/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/documentation/overview/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/cookbook/overview/ class=md-nav__link> <span class=md-ellipsis> Cookbook </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> API </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/_dtypes/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h6v-2H6V4h7v5h5v3h2V8l-6-6m4 12a.26.26 0 0 0-.26.21l-.19 1.32c-.3.13-.59.29-.85.47l-1.24-.5c-.11 0-.24 0-.31.13l-1 1.73c-.06.11-.04.24.06.32l1.06.82a4.2 4.2 0 0 0 0 1l-1.06.82a.26.26 0 0 0-.06.32l1 1.73c.06.13.19.13.31.13l1.24-.5c.26.18.54.35.85.47l.19 1.32c.02.12.12.21.26.21h2c.11 0 .22-.09.24-.21l.19-1.32c.3-.13.57-.29.84-.47l1.23.5c.13 0 .26 0 .33-.13l1-1.73a.26.26 0 0 0-.06-.32l-1.07-.82c.02-.17.04-.33.04-.5s-.01-.33-.04-.5l1.06-.82a.26.26 0 0 0 .06-.32l-1-1.73c-.06-.13-.19-.13-.32-.13l-1.23.5c-.27-.18-.54-.35-.85-.47l-.19-1.32A.236.236 0 0 0 20 14m-1 3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5c-.84 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5"/></svg> <span class=md-ellipsis> _dtypes </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/_opt_deps/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h6v-2H6V4h7v5h5v3h2V8l-6-6m4 12a.26.26 0 0 0-.26.21l-.19 1.32c-.3.13-.59.29-.85.47l-1.24-.5c-.11 0-.24 0-.31.13l-1 1.73c-.06.11-.04.24.06.32l1.06.82a4.2 4.2 0 0 0 0 1l-1.06.82a.26.26 0 0 0-.06.32l1 1.73c.06.13.19.13.31.13l1.24-.5c.26.18.54.35.85.47l.19 1.32c.02.12.12.21.26.21h2c.11 0 .22-.09.24-.21l.19-1.32c.3-.13.57-.29.84-.47l1.23.5c.13 0 .26 0 .33-.13l1-1.73a.26.26 0 0 0-.06-.32l-1.07-.82c.02-.17.04-.33.04-.5s-.01-.33-.04-.5l1.06-.82a.26.26 0 0 0 .06-.32l-1-1.73c-.06-.13-.19-.13-.32-.13l-1.23.5c-.27-.18-.54-.35-.85-.47l-.19-1.32A.236.236 0 0 0 20 14m-1 3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5c-.84 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5"/></svg> <span class=md-ellipsis> _opt_deps </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/_settings/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h6v-2H6V4h7v5h5v3h2V8l-6-6m4 12a.26.26 0 0 0-.26.21l-.19 1.32c-.3.13-.59.29-.85.47l-1.24-.5c-.11 0-.24 0-.31.13l-1 1.73c-.06.11-.04.24.06.32l1.06.82a4.2 4.2 0 0 0 0 1l-1.06.82a.26.26 0 0 0-.06.32l1 1.73c.06.13.19.13.31.13l1.24-.5c.26.18.54.35.85.47l.19 1.32c.02.12.12.21.26.21h2c.11 0 .22-.09.24-.21l.19-1.32c.3-.13.57-.29.84-.47l1.23.5c.13 0 .26 0 .33-.13l1-1.73a.26.26 0 0 0-.06-.32l-1.07-.82c.02-.17.04-.33.04-.5s-.01-.33-.04-.5l1.06-.82a.26.26 0 0 0 .06-.32l-1-1.73c-.06-.13-.19-.13-.32-.13l-1.23.5c-.27-.18-.54-.35-.85-.47l-.19-1.32A.236.236 0 0 0 20 14m-1 3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5c-.84 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5"/></svg> <span class=md-ellipsis> _settings </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/accessors/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11 5H8l4-4 4 4h-3v4.43c-.75.46-1.42 1.03-2 1.69zm11 6-4-4v3a6.747 6.747 0 0 0-7 6.17A3.006 3.006 0 0 0 9.17 20 3.006 3.006 0 0 0 13 21.83 3.01 3.01 0 0 0 14.83 18c-.3-.86-.98-1.53-1.83-1.83.47-4 4.47-4.2 4.95-4.2v3zm-11.37.59A7.63 7.63 0 0 0 6 10V7l-4 4 4 4v-3c1.34.03 2.63.5 3.64 1.4.25-.64.58-1.25.99-1.81"/></svg> <span class=md-ellipsis> accessors </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/mcp_server/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> mcp_server </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/base/ class=md-nav__link> <span class=md-ellipsis> base </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/data/ class=md-nav__link> <span class=md-ellipsis> data </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/generic/ class=md-nav__link> <span class=md-ellipsis> generic </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/indicators/ class=md-nav__link> <span class=md-ellipsis> indicators </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/knowledge/ class=md-nav__link> <span class=md-ellipsis> knowledge </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/labels/ class=md-nav__link> <span class=md-ellipsis> labels </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/ohlcv/ class=md-nav__link> <span class=md-ellipsis> ohlcv </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_14 checked> <label class=md-nav__link for=__nav_6_14 id=__nav_6_14_label tabindex=0> <span class=md-ellipsis> portfolio </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_14_label aria-expanded=true> <label class=md-nav__title for=__nav_6_14> <span class="md-nav__icon md-icon"></span> portfolio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17.45 15.18 22 7.31V21H2V3h2v12.54L9.5 6 16 9.78l4.24-7.33 1.73 1-5.23 9.05-6.51-3.75L4.31 19h2.26l4.39-7.56z"/></svg> <span class=md-ellipsis> portfolio </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/base/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M2 3v6h2.95l2 6H6v6h6v-4.59L17.41 11H22V5h-6v4.57L10.59 15H9.06l-2-6H8V3M4 5h2v2H4m14 0h2v2h-2M8 17h2v2H8Z"/></svg> <span class=md-ellipsis> base </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/call_seq/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> call_seq </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/chunking/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16v-3h-3v9h-2V2h2v9h3V8l4 4zM2 12l4 4v-3h3v9h2V2H9v9H6V8z"/></svg> <span class=md-ellipsis> chunking </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/decorators/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M2 3v6h2.95l2 6H6v6h6v-4.59L17.41 11H22V5h-6v4.57L10.59 15H9.06l-2-6H8V3zm2 2h2v2H4zm14 2h2v2h-2zm0 8v3h-3v2h3v3h2v-3h3v-2h-3v-3zM8 17h2v2H8z"/></svg> <span class=md-ellipsis> decorators </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 3h2v2H5v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5h2v2H5c-1.07-.27-2-.9-2-2v-4a2 2 0 0 0-2-2H0v-2h1a2 2 0 0 0 2-2V5a2 2 0 0 1 2-2m14 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3zm-7 12a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m8 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1"/></svg> <span class=md-ellipsis> enums </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/logs/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 2h8a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 8v4h8v-4zm0 6v4h8v-4zM8 4v4h8V4z"/></svg> <span class=md-ellipsis> logs </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/orders/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 2h8a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 8v4h8v-4zm0 6v4h8v-4zM8 4v4h8V4z"/></svg> <span class=md-ellipsis> orders </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/preparing/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 4V3a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V6h1v4H9v11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-9h8V4z"/></svg> <span class=md-ellipsis> preparing </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/trades/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 2h8a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 8v4h8v-4zm0 6v4h8v-4zM8 4v4h8V4z"/></svg> <span class=md-ellipsis> trades </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_14_11 checked> <label class=md-nav__link for=__nav_6_14_11 id=__nav_6_14_11_label tabindex=0> <span class=md-ellipsis> nb </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_14_11_label aria-expanded=true> <label class=md-nav__title for=__nav_6_14_11> <span class="md-nav__icon md-icon"></span> nb </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m6 20 4.16-12.09L9.34 6H8V4h2c.42 0 .78.26.93.63L16.66 18H18v2h-2c-.43 0-.79-.27-.93-.64l-3.74-8.71L8.12 20z"/></svg> <span class=md-ellipsis> nb </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/analysis/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> analysis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> core </span> <span class="md-nav__icon md-icon"></span> </label> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> core </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.apply_size_granularity_nb class=md-nav__link> <span class=md-ellipsis> apply_size_granularity_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_buy_value_nb class=md-nav__link> <span class=md-ellipsis> approx_buy_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_long_buy_value_nb class=md-nav__link> <span class=md-ellipsis> approx_long_buy_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_long_sell_value_nb class=md-nav__link> <span class=md-ellipsis> approx_long_sell_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_order_value_nb class=md-nav__link> <span class=md-ellipsis> approx_order_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_sell_value_nb class=md-nav__link> <span class=md-ellipsis> approx_sell_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_short_buy_value_nb class=md-nav__link> <span class=md-ellipsis> approx_short_buy_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.approx_short_sell_value_nb class=md-nav__link> <span class=md-ellipsis> approx_short_sell_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.buy_nb class=md-nav__link> <span class=md-ellipsis> buy_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.cast_account_state_nb class=md-nav__link> <span class=md-ellipsis> cast_account_state_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_adj_price_nb class=md-nav__link> <span class=md-ellipsis> check_adj_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_dt_stop_hit_nb class=md-nav__link> <span class=md-ellipsis> check_dt_stop_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_group_lens_nb class=md-nav__link> <span class=md-ellipsis> check_group_lens_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_limit_expired_nb class=md-nav__link> <span class=md-ellipsis> check_limit_expired_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_limit_hit_nb class=md-nav__link> <span class=md-ellipsis> check_limit_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_price_hit_nb class=md-nav__link> <span class=md-ellipsis> check_price_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_stop_hit_nb class=md-nav__link> <span class=md-ellipsis> check_stop_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_td_stop_hit_nb class=md-nav__link> <span class=md-ellipsis> check_td_stop_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.check_tsl_th_hit_nb class=md-nav__link> <span class=md-ellipsis> check_tsl_th_hit_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.clear_limit_info_nb class=md-nav__link> <span class=md-ellipsis> clear_limit_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.clear_sl_info_nb class=md-nav__link> <span class=md-ellipsis> clear_sl_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.clear_time_info_nb class=md-nav__link> <span class=md-ellipsis> clear_time_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.clear_tp_info_nb class=md-nav__link> <span class=md-ellipsis> clear_tp_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.clear_tsl_info_nb class=md-nav__link> <span class=md-ellipsis> clear_tsl_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.close_position_nb class=md-nav__link> <span class=md-ellipsis> close_position_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.execute_order_nb class=md-nav__link> <span class=md-ellipsis> execute_order_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.fill_init_pos_info_nb class=md-nav__link> <span class=md-ellipsis> fill_init_pos_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.fill_log_record_nb class=md-nav__link> <span class=md-ellipsis> fill_log_record_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.fill_order_record_nb class=md-nav__link> <span class=md-ellipsis> fill_order_record_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_diraware_size_nb class=md-nav__link> <span class=md-ellipsis> get_diraware_size_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_limit_info_target_price_nb class=md-nav__link> <span class=md-ellipsis> get_limit_info_target_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_sl_info_target_price_nb class=md-nav__link> <span class=md-ellipsis> get_sl_info_target_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_stop_ladder_exit_size_nb class=md-nav__link> <span class=md-ellipsis> get_stop_ladder_exit_size_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_time_stop_ladder_exit_size_nb class=md-nav__link> <span class=md-ellipsis> get_time_stop_ladder_exit_size_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_tp_info_target_price_nb class=md-nav__link> <span class=md-ellipsis> get_tp_info_target_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_trade_stats_nb class=md-nav__link> <span class=md-ellipsis> get_trade_stats_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.get_tsl_info_target_price_nb class=md-nav__link> <span class=md-ellipsis> get_tsl_info_target_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_grouped_nb class=md-nav__link> <span class=md-ellipsis> is_grouped_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_limit_active_nb class=md-nav__link> <span class=md-ellipsis> is_limit_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_limit_info_active_nb class=md-nav__link> <span class=md-ellipsis> is_limit_info_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_stop_active_nb class=md-nav__link> <span class=md-ellipsis> is_stop_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_stop_info_active_nb class=md-nav__link> <span class=md-ellipsis> is_stop_info_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_stop_info_ladder_active_nb class=md-nav__link> <span class=md-ellipsis> is_stop_info_ladder_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_time_stop_active_nb class=md-nav__link> <span class=md-ellipsis> is_time_stop_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.is_time_stop_info_active_nb class=md-nav__link> <span class=md-ellipsis> is_time_stop_info_active_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.long_buy_nb class=md-nav__link> <span class=md-ellipsis> long_buy_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.long_sell_nb class=md-nav__link> <span class=md-ellipsis> long_sell_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.order_nb class=md-nav__link> <span class=md-ellipsis> order_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.order_not_filled_nb class=md-nav__link> <span class=md-ellipsis> order_not_filled_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.order_nothing_nb class=md-nav__link> <span class=md-ellipsis> order_nothing_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_last_cash_nb class=md-nav__link> <span class=md-ellipsis> prepare_last_cash_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_last_pos_info_nb class=md-nav__link> <span class=md-ellipsis> prepare_last_pos_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_last_position_nb class=md-nav__link> <span class=md-ellipsis> prepare_last_position_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_last_value_nb class=md-nav__link> <span class=md-ellipsis> prepare_last_value_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_records_nb class=md-nav__link> <span class=md-ellipsis> prepare_records_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.prepare_sim_out_nb class=md-nav__link> <span class=md-ellipsis> prepare_sim_out_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.process_order_nb class=md-nav__link> <span class=md-ellipsis> process_order_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.raise_rejected_order_nb class=md-nav__link> <span class=md-ellipsis> raise_rejected_order_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_dyn_limit_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_dyn_limit_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_dyn_stop_entry_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_dyn_stop_entry_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_hl_nb class=md-nav__link> <span class=md-ellipsis> resolve_hl_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_limit_order_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_limit_order_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_limit_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_limit_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_size_nb class=md-nav__link> <span class=md-ellipsis> resolve_size_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_stop_exit_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_stop_exit_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.resolve_stop_price_nb class=md-nav__link> <span class=md-ellipsis> resolve_stop_price_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.sell_nb class=md-nav__link> <span class=md-ellipsis> sell_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.set_limit_info_nb class=md-nav__link> <span class=md-ellipsis> set_limit_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.set_sl_info_nb class=md-nav__link> <span class=md-ellipsis> set_sl_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.set_time_info_nb class=md-nav__link> <span class=md-ellipsis> set_time_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.set_tp_info_nb class=md-nav__link> <span class=md-ellipsis> set_tp_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.set_tsl_info_nb class=md-nav__link> <span class=md-ellipsis> set_tsl_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.short_buy_nb class=md-nav__link> <span class=md-ellipsis> short_buy_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.short_sell_nb class=md-nav__link> <span class=md-ellipsis> short_sell_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.should_apply_size_granularity_nb class=md-nav__link> <span class=md-ellipsis> should_apply_size_granularity_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.should_update_stop_nb class=md-nav__link> <span class=md-ellipsis> should_update_stop_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.should_update_time_stop_nb class=md-nav__link> <span class=md-ellipsis> should_update_time_stop_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.update_open_pos_info_stats_nb class=md-nav__link> <span class=md-ellipsis> update_open_pos_info_stats_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.update_pos_info_nb class=md-nav__link> <span class=md-ellipsis> update_pos_info_nb </span> </a> </li> <li class=md-nav__item> <a href=#vectorbtpro.portfolio.nb.core.update_value_nb class=md-nav__link> <span class=md-ellipsis> update_value_nb </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/ctx_helpers/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> ctx_helpers </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/from_order_func/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> from_order_func </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/from_orders/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> from_orders </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/from_signals/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> from_signals </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/iter_/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> iter_ </span> </a> </li> <li class=md-nav__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/records/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg> <span class=md-ellipsis> records </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/pfopt/ class=md-nav__link> <span class=md-ellipsis> pfopt </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/px/ class=md-nav__link> <span class=md-ellipsis> px </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/records/ class=md-nav__link> <span class=md-ellipsis> records </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/registries/ class=md-nav__link> <span class=md-ellipsis> registries </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/returns/ class=md-nav__link> <span class=md-ellipsis> returns </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/signals/ class=md-nav__link> <span class=md-ellipsis> signals </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/api/utils/ class=md-nav__link> <span class=md-ellipsis> utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=https://vectorbt.pro/pvt_41531c19/terms/terms-of-use/ class=md-nav__link> <span class=md-ellipsis> Terms </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/api/ class=md-path__link> <span class=md-ellipsis> API </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/ class=md-path__link> <span class=md-ellipsis> portfolio </span> </a> </li> <li class=md-path__item> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/ class=md-path__link> <span class=md-ellipsis> nb </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <nav class=md-tags> <span class=md-tag>core</span> <span class=md-tag>numba</span> </nav> <h1 id=vectorbtpro.portfolio.nb.core><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35 2.09 2.09L10.35 19 7 15.65l3.35-3.35 1.28 1.26zm7.46 0L13.65 19l-1.27-1.26 2.09-2.09-2.09-2.09 1.27-1.26z"/></svg></span> core <span class=dobjtype>module</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core title="Permanent link">&para;</a></h1> <p>Module providing core Numba-compiled functions for portfolio simulation.</p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.apply_size_granularity_nb>apply_size_granularity_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L127-L138 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.apply_size_granularity_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>apply_size_granularity_nb</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=n>size_granularity</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=p>)</span>
</span></code></pre></div> <p>Apply size granularity to the given size by rounding it down to the nearest multiple.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Original size value.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Size rounded down to a multiple of size_granularity.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_buy_value_nb>approx_buy_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L832-L870 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_buy_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>approx_buy_value_nb</span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=n>position</span><span class=p>,</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=n>debt</span><span class=p>,</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>locked_cash</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>direction</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate value of a buy operation.</p> <p>Calculates an estimated order value based on the current position, debt, locked cash, valuation price, and desired order size. Depending on the position and trade direction, it uses a short or long buy approximation or a combination of both. A positive return value indicates spending, which is useful for sorting.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>position</code></strong> :&ensp;<code>float</code></dt> <dd>Current position amount.</dd> <dt><strong><code>debt</code></strong> :&ensp;<code>float</code></dt> <dd>Current debt amount.</dd> <dt><strong><code>locked_cash</code></strong> :&ensp;<code>float</code></dt> <dd>Cash currently locked as collateral.</dd> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Requested order size.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximate order value representing the spending amount.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_long_buy_value_nb>approx_long_buy_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L87-L105 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_long_buy_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>approx_long_buy_value_nb</span><span class=p>(</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>    <span class=n>size</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the value of a long-buy operation.</p> <p>Calculates the order value as the product of the absolute order size and the valuation price, and returns it as a negative value to represent spending.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Negative value representing spending, or 0.0 if the order size is zero.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_long_sell_value_nb>approx_long_sell_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L331-L354 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_long_sell_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>approx_long_sell_value_nb</span><span class=p>(</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>position</span><span class=p>,</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    <span class=n>debt</span><span class=p>,</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=n>size</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the value of a long-sell operation.</p> <p>The computed value represents the spending amount for sorting purposes, where a positive value indicates spending.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>position</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> <dt><strong><code>debt</code></strong> :&ensp;<code>float</code></dt> <dd>Current account debt.</dd> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Requested order size for the long-sell operation.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximate value of the long-sell operation.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_order_value_nb>approx_order_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1405-L1458 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_order_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>approx_order_value_nb</span><span class=p>(</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>    <span class=n>exec_state</span><span class=p>,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=n>size_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=n>direction</span><span class=o>=</span><span class=mi>2</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the value of an order.</p> <p>Assumes infinite cash.</p> <p>Positive value indicates spending (used for sorting purposes).</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>exec_state</code></strong> :&ensp;<code>ExecState</code></dt> <dd> <p>Current execution state.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.ExecState title=vectorbtpro.portfolio.enums.ExecState>ExecState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> <dt><strong><code>size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of order size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximate order value.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_sell_value_nb>approx_sell_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1043-L1077 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_sell_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>approx_sell_value_nb</span><span class=p>(</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>position</span><span class=p>,</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=n>debt</span><span class=p>,</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>direction</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the sell operation value based on asset position, debt, and valuation price.</p> <p>Calculates an estimated sell value given the current position, associated debt, valuation price, and order size. A positive result represents spending, which is useful for sorting operations.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>position</code></strong> :&ensp;<code>float</code></dt> <dd>Current asset position.</dd> <dt><strong><code>debt</code></strong> :&ensp;<code>float</code></dt> <dd>Debt associated with the asset.</dd> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Size of the sell order.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximate value of the sell operation.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_short_buy_value_nb>approx_short_buy_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L646-L671 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_short_buy_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>approx_short_buy_value_nb</span><span class=p>(</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    <span class=n>position</span><span class=p>,</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=n>debt</span><span class=p>,</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>locked_cash</span><span class=p>,</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=n>size</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the cash value adjustment for a short-buy operation.</p> <p>Computes the additional cash required or freed by comparing the released debt and locked cash against the order value. A positive return value indicates a spending requirement.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>position</code></strong> :&ensp;<code>float</code></dt> <dd>Current short position size.</dd> <dt><strong><code>debt</code></strong> :&ensp;<code>float</code></dt> <dd>Total debt associated with the short position.</dd> <dt><strong><code>locked_cash</code></strong> :&ensp;<code>float</code></dt> <dd>Cash currently locked as collateral.</dd> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Desired order size for the short-buy operation.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximate cash value adjustment, where a positive value signifies spending.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.approx_short_sell_value_nb>approx_short_sell_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L483-L501 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.approx_short_sell_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>approx_short_sell_value_nb</span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=n>size</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=p>)</span>
</span></code></pre></div> <p>Approximate the value of a short-sell operation.</p> <p>Calculates the transaction value based on the provided price and position size. A positive result indicates expenditure (for sorting purposes).</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Size of the short position.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Approximated value of the short-sell operation.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.buy_nb>buy_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L873-L1040 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.buy_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>buy_nb</span><span class=p>(</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>direction</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=n>leverage_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=p>)</span>
</span></code></pre></div> <p>Perform a buy operation on an account by determining the appropriate long or short strategy based on the current state and provided parameters.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Execution price for the order.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>leverage_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Leverage mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LeverageMode title=vectorbtpro.portfolio.enums.LeverageMode>LeverageMode</a>.</p> </dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the order execution result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.cast_account_state_nb>cast_account_state_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L141-L159 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.cast_account_state_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>cast_account_state_nb</span><span class=p>(</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>account_state</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=p>)</span>
</span></code></pre></div> <p>Convert all numeric fields of the given <code>AccountState</code> to floats.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>AccountState</code></dt> <dd>New account state instance with all numerical attributes cast to float.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_adj_price_nb>check_adj_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L43-L84 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_adj_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>check_adj_price_nb</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>adj_price</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>price_area</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>is_closing_price</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>price_area_vio_mode</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=p>)</span>
</span></code></pre></div> <p>Adjust the given price to ensure it falls within the specified price boundaries.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>adj_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial adjusted price.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd> <p>Flag indicating if the price is a close price.</p> <p>If the adjusted price differs from <code>PriceArea.close</code>, it may trigger an error or cap.</p> </dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Validated and, if necessary, adjusted price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_dt_stop_hit_nb>check_dt_stop_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3200-L3251 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_dt_stop_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>check_dt_stop_hit_nb</span><span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    <span class=n>stop</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=n>index</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=n>freq</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether a DT stop was hit by comparing the current row index against the stop threshold.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>int</code></dt> <dd>Stop threshold offset; -1 indicates no stop.</dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>index</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Index array in nanosecond format.</dd> <dt><strong><code>freq</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd>Frequency in nanosecond format.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>True if the stop was hit, otherwise False.</li> <li>True if the stop was hit on open, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_group_lens_nb>check_group_lens_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2118-L2130 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_group_lens_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=n>check_group_lens_nb</span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=n>group_lens</span><span class=p>,</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>n_cols</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=p>)</span>
</span></code></pre></div> <p>Ensure the group lengths sum to the total number of columns.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>group_lens</code></strong> :&ensp;<code>GroupLens</code></dt> <dd>Array defining the number of columns in each group.</dd> <dt><strong><code>n_cols</code></strong> :&ensp;<code>int</code></dt> <dd>Total expected number of columns.</dd> </dl> <p><strong>Returns</strong></p> <p>None</p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_limit_expired_nb>check_limit_expired_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2808-L2875 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_limit_expired_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>check_limit_expired_nb</span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=n>creation_idx</span><span class=p>,</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>    <span class=n>tif</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=n>expiry</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=n>index</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=n>freq</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether the limit order is expired based on the current and creation indices.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>creation_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Row index at which the limit order was created.</dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>tif</code></strong> :&ensp;<code>int</code></dt> <dd>Time-in-force duration; use -1 if undefined.</dd> <dt><strong><code>expiry</code></strong> :&ensp;<code>int</code></dt> <dd>Expiry index; use -1 if undefined.</dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>index</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Index array in nanosecond format.</dd> <dt><strong><code>freq</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd>Frequency in nanosecond format.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>True if the limit order is expired, otherwise False.</li> <li>True if the limit order is expired on open, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_limit_hit_nb>check_limit_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2937-L3003 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_limit_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>check_limit_hit_nb</span><span class=p>(</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>    <span class=nb>open</span><span class=p>,</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=n>high</span><span class=p>,</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=n>low</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>close</span><span class=p>,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>direction</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>    <span class=n>limit_reverse</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>    <span class=n>can_use_ohlc</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>    <span class=n>check_open</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>    <span class=n>hard_limit</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the limit price using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.resolve_limit_price_nb title=vectorbtpro.portfolio.nb.core.resolve_limit_price_nb>resolve_limit_price_nb</a> and determine if the limit was hit using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.check_price_hit_nb title=vectorbtpro.portfolio.nb.core.check_price_hit_nb>check_price_hit_nb</a>.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>open</code></strong> :&ensp;<code>float</code></dt> <dd>Open price.</dd> <dt><strong><code>high</code></strong> :&ensp;<code>float</code></dt> <dd>High price of the period.</dd> <dt><strong><code>low</code></strong> :&ensp;<code>float</code></dt> <dd>Low price of the period.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Reference price used for calculating the limit.</dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size (must be non-zero).</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>limit_reverse</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag to reverse the limit condition.</dd> <dt><strong><code>can_use_ohlc</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether OHLC data is safe to use for the evaluation.</dd> <dt><strong><code>check_open</code></strong> :&ensp;<code>bool</code></dt> <dd>Determines whether the open price should be considered.</dd> <dt><strong><code>hard_limit</code></strong> :&ensp;<code>bool</code></dt> <dd>Enforces a hard limit without fallback to the open price if True, or close price when <code>can_use_ohlc</code> is False.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>Effective limit price; NaN if the limit price was not hit.</li> <li>True if the limit price was hit before or on open, otherwise False.</li> <li>True if the limit price was hit on close, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_price_hit_nb>check_price_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2630-L2691 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_price_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>check_price_hit_nb</span><span class=p>(</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>    <span class=nb>open</span><span class=p>,</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>    <span class=n>high</span><span class=p>,</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=n>low</span><span class=p>,</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=n>close</span><span class=p>,</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>    <span class=n>hit_below</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>    <span class=n>can_use_ohlc</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    <span class=n>check_open</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>    <span class=n>hard_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=p>)</span>
</span></code></pre></div> <p>Determine whether the target price is hit and compute the effective price and hit flags.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>open</code></strong> :&ensp;<code>float</code></dt> <dd>Open price.</dd> <dt><strong><code>high</code></strong> :&ensp;<code>float</code></dt> <dd>High price.</dd> <dt><strong><code>low</code></strong> :&ensp;<code>float</code></dt> <dd>Low price.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Target price to evaluate.</dd> <dt><strong><code>hit_below</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, check whether the target price is hit from above.</dd> <dt><strong><code>can_use_ohlc</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether OHLC data is safe to use for the evaluation.</dd> <dt><strong><code>check_open</code></strong> :&ensp;<code>bool</code></dt> <dd>Determines whether the open price should be considered.</dd> <dt><strong><code>hard_price</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, enforces the target price when hit by the open price, or close price when <code>can_use_ohlc</code> is False.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>Effective price; NaN if the price was not hit.</li> <li>True if the price was hit before or on open, otherwise False.</li> <li>True if the price was hit on close, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_stop_hit_nb>check_stop_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3084-L3141 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_stop_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=n>check_stop_hit_nb</span><span class=p>(</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>    <span class=nb>open</span><span class=p>,</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>    <span class=n>high</span><span class=p>,</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=n>low</span><span class=p>,</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>    <span class=n>close</span><span class=p>,</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>is_position_long</span><span class=p>,</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=n>stop</span><span class=p>,</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>    <span class=n>hit_below</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>    <span class=n>can_use_ohlc</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>    <span class=n>check_open</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>    <span class=n>hard_stop</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the stop price using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.resolve_stop_price_nb title=vectorbtpro.portfolio.nb.core.resolve_stop_price_nb>resolve_stop_price_nb</a> and check if it was hit using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.check_price_hit_nb title=vectorbtpro.portfolio.nb.core.check_price_hit_nb>check_price_hit_nb</a>.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>open</code></strong> :&ensp;<code>float</code></dt> <dd>Open price.</dd> <dt><strong><code>high</code></strong> :&ensp;<code>float</code></dt> <dd>High price.</dd> <dt><strong><code>low</code></strong> :&ensp;<code>float</code></dt> <dd>Low price.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> <dt><strong><code>is_position_long</code></strong> :&ensp;<code>bool</code></dt> <dd>True if the position is long, False if short.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price used for stop price calculation.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>hit_below</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, check whether the target price is hit from above.</dd> <dt><strong><code>can_use_ohlc</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether OHLC data is safe to use for the evaluation.</dd> <dt><strong><code>check_open</code></strong> :&ensp;<code>bool</code></dt> <dd>Determines whether the open price should be considered.</dd> <dt><strong><code>hard_stop</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether the stop is considered a hard stop.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>Effective stop price; NaN if the stop price was not hit.</li> <li>True if the stop price was hit before or on open, otherwise False.</li> <li>True if the stop price was hit on close, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_td_stop_hit_nb>check_td_stop_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3144-L3197 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_td_stop_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>check_td_stop_hit_nb</span><span class=p>(</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=n>stop</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>index</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>freq</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether a TD stop was hit by comparing the initial row index with the current row index.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index.</dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>int</code></dt> <dd>Stop offset; -1 indicates no stop.</dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>index</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Index array in nanosecond format.</dd> <dt><strong><code>freq</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd>Frequency in nanosecond format.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[bool, bool]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li>True if the stop was hit, otherwise False.</li> <li>True if the stop was hit on open, otherwise False.</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.check_tsl_th_hit_nb>check_tsl_th_hit_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3254-L3285 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.check_tsl_th_hit_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>check_tsl_th_hit_nb</span><span class=p>(</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>    <span class=n>is_position_long</span><span class=p>,</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>peak_price</span><span class=p>,</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>threshold</span><span class=p>,</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the TSL threshold price using <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.resolve_stop_price_nb title=vectorbtpro.portfolio.nb.core.resolve_stop_price_nb>resolve_stop_price_nb</a> and check if it was hit.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>is_position_long</code></strong> :&ensp;<code>bool</code></dt> <dd>True if the position is long, False if short.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price used for threshold computation.</dd> <dt><strong><code>peak_price</code></strong> :&ensp;<code>float</code></dt> <dd>Peak price reached (maximum for long, minimum for short).</dd> <dt><strong><code>threshold</code></strong> :&ensp;<code>float</code></dt> <dd>TSL threshold value.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the TSL threshold was hit, False otherwise.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.clear_limit_info_nb>clear_limit_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3632-L3658 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.clear_limit_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>clear_limit_info_nb</span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>    <span class=n>limit_info</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=p>)</span>
</span></code></pre></div> <p>Clear limit order information in the provided record.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>limit_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing limit order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.limit_info_dt title=vectorbtpro.portfolio.enums.limit_info_dt>limit_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>limit_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.clear_sl_info_nb>clear_sl_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3734-L3759 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.clear_sl_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>clear_sl_info_nb</span><span class=p>(</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=n>sl_info</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=p>)</span>
</span></code></pre></div> <p>Clear SL (stop loss) order information in the provided record.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>sl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing SL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.sl_info_dt title=vectorbtpro.portfolio.enums.sl_info_dt>sl_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>sl_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.clear_time_info_nb>clear_time_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L4055-L4080 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.clear_time_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>clear_time_info_nb</span><span class=p>(</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>    <span class=n>time_info</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=p>)</span>
</span></code></pre></div> <p>Clear time order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>time_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing time-based order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.time_info_dt title=vectorbtpro.portfolio.enums.time_info_dt>time_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>time_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.clear_tp_info_nb>clear_tp_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3952-L3977 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.clear_tp_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=n>clear_tp_info_nb</span><span class=p>(</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=n>tp_info</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=p>)</span>
</span></code></pre></div> <p>Clear TP order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tp_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TP order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tp_info_dt title=vectorbtpro.portfolio.enums.tp_info_dt>tp_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>tp_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.clear_tsl_info_nb>clear_tsl_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3848-L3876 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.clear_tsl_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>clear_tsl_info_nb</span><span class=p>(</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>    <span class=n>tsl_info</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=p>)</span>
</span></code></pre></div> <p>Clear TSL/TTP order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tsl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TSL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tsl_info_dt title=vectorbtpro.portfolio.enums.tsl_info_dt>tsl_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>tsl_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.close_position_nb>close_position_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2045-L2105 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.close_position_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>close_position_nb</span><span class=p>(</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>    <span class=n>price</span><span class=o>=</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>    <span class=n>leverage_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=n>reject_prob</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>    <span class=n>raise_reject</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>    <span class=n>log</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=p>)</span>
</span></code></pre></div> <p>Close the current position.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price.</dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>leverage_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Leverage mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LeverageMode title=vectorbtpro.portfolio.enums.LeverageMode>LeverageMode</a>.</p> </dd> <dt><strong><code>reject_prob</code></strong> :&ensp;<code>float</code></dt> <dd>Rejection probability threshold.</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>raise_reject</code></strong> :&ensp;<code>bool</code></dt> <dd>Raise an exception if the order is rejected.</dd> <dt><strong><code>log</code></strong> :&ensp;<code>bool</code></dt> <dd>Log the order execution.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Order</code></dt> <dd>Order object representing the closed position.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.execute_order_nb>execute_order_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1461-L1723 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.execute_order_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=n>execute_order_nb</span><span class=p>(</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>    <span class=n>exec_state</span><span class=p>,</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>    <span class=n>order</span><span class=p>,</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>    <span class=n>update_value</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=p>)</span>
</span></code></pre></div> <p>Execute an order given the current state.</p> <p>Error is raised if any input value is invalid.</p> <p>The order is ignored if its execution does not affect the current balance. The order is rejected if any input violates a limit or restriction.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>exec_state</code></strong> :&ensp;<code>ExecState</code></dt> <dd> <p>Current execution state.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.ExecState title=vectorbtpro.portfolio.enums.ExecState>ExecState</a>.</p> </dd> <dt><strong><code>order</code></strong> :&ensp;<code>Order</code></dt> <dd> <p>Order to execute.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Order title=vectorbtpro.portfolio.enums.Order>Order</a>.</p> </dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>update_value</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag to update portfolio value with each order.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, ExecState]</code></dt> <dd>Tuple containing the order execution result and the updated execution state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.fill_init_pos_info_nb>fill_init_pos_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2445-L2479 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.fill_init_pos_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=n>fill_init_pos_info_nb</span><span class=p>(</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>    <span class=n>record</span><span class=p>,</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>    <span class=n>price</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=p>)</span>
</span></code></pre></div> <p>Fill a position record for an initial position.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>record</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Position record to populate.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.trade_dt title=vectorbtpro.portfolio.enums.trade_dt>trade_dt</a> dtype.</p> </dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>This function modifies <code>record</code> in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.fill_log_record_nb>fill_log_record_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1726-L1816 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.fill_log_record_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=n>fill_log_record_nb</span><span class=p>(</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>    <span class=n>records</span><span class=p>,</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>    <span class=n>r</span><span class=p>,</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>    <span class=n>group</span><span class=p>,</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>    <span class=n>price_area</span><span class=p>,</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>    <span class=n>exec_state</span><span class=p>,</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>    <span class=n>order</span><span class=p>,</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>    <span class=n>order_result</span><span class=p>,</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>    <span class=n>new_exec_state</span><span class=p>,</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>    <span class=n>order_id</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=p>)</span>
</span></code></pre></div> <p>Fill a log record with order and execution state details.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>records</code></strong> :&ensp;<code>RecordArray2d</code></dt> <dd> <p>Array where log records are stored.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.log_dt title=vectorbtpro.portfolio.enums.log_dt>log_dt</a> dtype.</p> </dd> <dt><strong><code>r</code></strong> :&ensp;<code>int</code></dt> <dd>Index of the log record in the column.</dd> <dt><strong><code>group</code></strong> :&ensp;<code>int</code></dt> <dd>Current group index.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>exec_state</code></strong> :&ensp;<code>ExecState</code></dt> <dd> <p>Execution state before executing the order.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.ExecState title=vectorbtpro.portfolio.enums.ExecState>ExecState</a>.</p> </dd> <dt><strong><code>order</code></strong> :&ensp;<code>Order</code></dt> <dd> <p>Order to execute.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Order title=vectorbtpro.portfolio.enums.Order>Order</a>.</p> </dd> <dt><strong><code>order_result</code></strong> :&ensp;<code>OrderResult</code></dt> <dd> <p>Result of the order execution.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderResult title=vectorbtpro.portfolio.enums.OrderResult>OrderResult</a>.</p> </dd> <dt><strong><code>new_exec_state</code></strong> :&ensp;<code>ExecState</code></dt> <dd> <p>Execution state after executing the order.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.ExecState title=vectorbtpro.portfolio.enums.ExecState>ExecState</a>.</p> </dd> <dt><strong><code>order_id</code></strong> :&ensp;<code>int</code></dt> <dd>Unique identifier of the order.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>This function modifies <code>records</code> in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.fill_order_record_nb>fill_order_record_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1819-L1844 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.fill_order_record_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=n>fill_order_record_nb</span><span class=p>(</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>    <span class=n>records</span><span class=p>,</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>    <span class=n>r</span><span class=p>,</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>    <span class=n>order_result</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=p>)</span>
</span></code></pre></div> <p>Fill an order record with executed order details.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>records</code></strong> :&ensp;<code>RecordArray2d</code></dt> <dd> <p>Array where order records are stored.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.order_dt title=vectorbtpro.portfolio.enums.order_dt>order_dt</a> dtype.</p> </dd> <dt><strong><code>r</code></strong> :&ensp;<code>int</code></dt> <dd>Index of the order record in the column.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>order_result</code></strong> :&ensp;<code>OrderResult</code></dt> <dd> <p>Result of the order execution.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderResult title=vectorbtpro.portfolio.enums.OrderResult>OrderResult</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>This function modifies <code>records</code> in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_diraware_size_nb>get_diraware_size_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1285-L1301 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_diraware_size_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=n>get_diraware_size_nb</span><span class=p>(</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>    <span class=n>direction</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=p>)</span>
</span></code></pre></div> <p>Adjust size based on trade direction.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Base size value.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>If equal to <code>Direction.ShortOnly</code>, the size is negated. See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Adjusted size reflecting trade direction.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_limit_info_target_price_nb>get_limit_info_target_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L4083-L4106 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_limit_info_target_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=n>get_limit_info_target_price_nb</span><span class=p>(</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>    <span class=n>limit_info</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=p>)</span>
</span></code></pre></div> <p>Get target price from limit order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>limit_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing limit order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.limit_info_dt title=vectorbtpro.portfolio.enums.limit_info_dt>limit_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Target price if the limit order information is active; otherwise, NaN.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_sl_info_target_price_nb>get_sl_info_target_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L4109-L4130 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_sl_info_target_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=n>get_sl_info_target_price_nb</span><span class=p>(</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>    <span class=n>sl_info</span><span class=p>,</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>    <span class=n>position_now</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=p>)</span>
</span></code></pre></div> <p>Get target price from SL order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>sl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing SL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.sl_info_dt title=vectorbtpro.portfolio.enums.sl_info_dt>sl_info_dt</a> dtype.</p> </dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Target stop loss price if the SL order is active; otherwise, NaN.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_stop_ladder_exit_size_nb>get_stop_ladder_exit_size_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3340-L3426 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_stop_ladder_exit_size_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=n>get_stop_ladder_exit_size_nb</span><span class=p>(</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>    <span class=n>stop_</span><span class=p>,</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>    <span class=n>step</span><span class=p>,</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>    <span class=n>init_position</span><span class=p>,</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=n>hit_below</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=p>)</span>
</span></code></pre></div> <p>Calculate the exit size for the current ladder step in a stop ladder strategy.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>stop_</code></strong> :&ensp;<code>FlexArray2d</code></dt> <dd>2D array of stop values.</dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price used to resolve stop levels.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>hit_below</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, check whether the target price is hit from above.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Exit size corresponding to the current ladder step, or NaN if no valid stop is found.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_time_stop_ladder_exit_size_nb>get_time_stop_ladder_exit_size_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3429-L3502 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_time_stop_ladder_exit_size_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=n>get_time_stop_ladder_exit_size_nb</span><span class=p>(</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>    <span class=n>stop_</span><span class=p>,</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>    <span class=n>step</span><span class=p>,</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>    <span class=n>init_position</span><span class=p>,</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>    <span class=n>index</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=p>)</span>
</span></code></pre></div> <p>Get the exit size corresponding to the current step in the ladder.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>stop_</code></strong> :&ensp;<code>FlexArray2d</code></dt> <dd>2D array of stop values.</dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index in the ladder.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>index</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Index array in nanosecond format.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Calculated exit size.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_tp_info_target_price_nb>get_tp_info_target_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L4159-L4182 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_tp_info_target_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=n>get_tp_info_target_price_nb</span><span class=p>(</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>    <span class=n>tp_info</span><span class=p>,</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>    <span class=n>position_now</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=p>)</span>
</span></code></pre></div> <p>Get target price from take profit (TP) order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tp_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TP order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tp_info_dt title=vectorbtpro.portfolio.enums.tp_info_dt>tp_info_dt</a> dtype.</p> </dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd> <p>Computed target price based on TP information.</p> <p>Returns NaN if the stop information is inactive.</p> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_trade_stats_nb>get_trade_stats_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2374-L2408 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_trade_stats_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=n>get_trade_stats_nb</span><span class=p>(</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>    <span class=n>entry_price</span><span class=p>,</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    <span class=n>entry_fees</span><span class=p>,</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>    <span class=n>exit_price</span><span class=p>,</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>    <span class=n>exit_fees</span><span class=p>,</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>    <span class=n>direction</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=p>)</span>
</span></code></pre></div> <p>Get trade statistics.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Trade size.</dd> <dt><strong><code>entry_price</code></strong> :&ensp;<code>float</code></dt> <dd>Entry price of the trade.</dd> <dt><strong><code>entry_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fees incurred at entry.</dd> <dt><strong><code>exit_price</code></strong> :&ensp;<code>float</code></dt> <dd>Exit price of the trade.</dd> <dt><strong><code>exit_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fees incurred at exit.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Trade direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TradeDirection title=vectorbtpro.portfolio.enums.TradeDirection>TradeDirection</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, float]</code></dt> <dd>Tuple containing the profit and loss (pnl) and the return ratio.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.get_tsl_info_target_price_nb>get_tsl_info_target_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L4133-L4156 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.get_tsl_info_target_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=n>get_tsl_info_target_price_nb</span><span class=p>(</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>    <span class=n>tsl_info</span><span class=p>,</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>    <span class=n>position_now</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=p>)</span>
</span></code></pre></div> <p>Get target price from trailing stop loss (TSL) order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tsl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TSL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tsl_info_dt title=vectorbtpro.portfolio.enums.tsl_info_dt>tsl_info_dt</a> dtype.</p> </dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd> <p>Computed target price based on TSL information.</p> <p>Returns NaN if the stop information is inactive.</p> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_grouped_nb>is_grouped_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2133-L2143 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_grouped_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=n>is_grouped_nb</span><span class=p>(</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>    <span class=n>group_lens</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=p>)</span>
</span></code></pre></div> <p>Determine if columns are grouped.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>group_lens</code></strong> :&ensp;<code>GroupLens</code></dt> <dd>Array defining the number of columns in each group.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if at least one group contains more than one column, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_limit_active_nb>is_limit_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2722-L2733 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_limit_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=n>is_limit_active_nb</span><span class=p>(</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>    <span class=n>init_price</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether a limit order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index for the limit order; -1 indicates inactivity.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price for the limit order; NaN implies inactivity.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the limit order is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_limit_info_active_nb>is_limit_info_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3505-L3517 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_limit_info_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=n>is_limit_info_active_nb</span><span class=p>(</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>    <span class=n>limit_info</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether the information record for a limit order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>limit_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing limit order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.limit_info_dt title=vectorbtpro.portfolio.enums.limit_info_dt>limit_info_dt</a> dtype.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the limit order record is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_stop_active_nb>is_stop_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2736-L2747 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_stop_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=n>is_stop_active_nb</span><span class=p>(</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>    <span class=n>stop</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether a stop order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index for the stop order; -1 indicates inactivity.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value; NaN indicates that the stop is inactive.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the stop order is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_stop_info_active_nb>is_stop_info_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3520-L3530 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_stop_info_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=n>is_stop_info_active_nb</span><span class=p>(</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>    <span class=n>stop_info</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether the information record for a stop order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>stop_info</code></strong> :&ensp;<code>Record</code></dt> <dd>Record containing stop order information.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the stop order record is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_stop_info_ladder_active_nb>is_stop_info_ladder_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3546-L3556 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_stop_info_ladder_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=n>is_stop_info_ladder_active_nb</span><span class=p>(</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>    <span class=n>info</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether the information record for a stop ladder is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>info</code></strong> :&ensp;<code>Record</code></dt> <dd>Record containing stop ladder information.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the stop ladder record is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_time_stop_active_nb>is_time_stop_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2750-L2761 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_time_stop_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=n>is_time_stop_active_nb</span><span class=p>(</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>    <span class=n>stop</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether a time stop order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index for the time stop order; -1 indicates inactivity.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>int</code></dt> <dd>Time stop value; -1 signifies that the stop is inactive.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the time stop order is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.is_time_stop_info_active_nb>is_time_stop_info_active_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3533-L3543 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.is_time_stop_info_active_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=n>is_time_stop_info_active_nb</span><span class=p>(</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a>    <span class=n>time_stop_info</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=p>)</span>
</span></code></pre></div> <p>Check whether the information record for a time stop order is active.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>time_stop_info</code></strong> :&ensp;<code>Record</code></dt> <dd>Record containing time stop order information.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the time stop order record is active, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.long_buy_nb>long_buy_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L162-L328 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.long_buy_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=n>long_buy_nb</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-45-7><a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-45-8><a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-45-9><a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-45-10><a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-45-11><a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-45-12><a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a>    <span class=n>leverage_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-45-13><a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-45-14><a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-45-15><a id=__codelineno-45-15 name=__codelineno-45-15 href=#__codelineno-45-15></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-45-16><a id=__codelineno-45-16 name=__codelineno-45-16 href=#__codelineno-45-16></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-45-17><a id=__codelineno-45-17 name=__codelineno-45-17 href=#__codelineno-45-17></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-45-18><a id=__codelineno-45-18 name=__codelineno-45-18 href=#__codelineno-45-18></a><span class=p>)</span>
</span></code></pre></div> <p>Open or increase a long position.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Requested order size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price.</dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>leverage_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Leverage mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LeverageMode title=vectorbtpro.portfolio.enums.LeverageMode>LeverageMode</a>.</p> </dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the order result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.long_sell_nb>long_sell_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L357-L480 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.long_sell_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=n>long_sell_nb</span><span class=p>(</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-46-9><a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-46-10><a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-46-11><a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-46-12><a id=__codelineno-46-12 name=__codelineno-46-12 href=#__codelineno-46-12></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-46-13><a id=__codelineno-46-13 name=__codelineno-46-13 href=#__codelineno-46-13></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-46-14><a id=__codelineno-46-14 name=__codelineno-46-14 href=#__codelineno-46-14></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-46-15><a id=__codelineno-46-15 name=__codelineno-46-15 href=#__codelineno-46-15></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-46-16><a id=__codelineno-46-16 name=__codelineno-46-16 href=#__codelineno-46-16></a><span class=p>)</span>
</span></code></pre></div> <p>Decrease or close a long position.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Desired size to sell.</p> <p>The size is capped by the current open long position.</p> </dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Price at which to execute the sell order.</dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the created order result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.order_nb>order_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1972-L2042 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.order_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=n>order_nb</span><span class=p>(</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>    <span class=n>size</span><span class=o>=</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>    <span class=n>price</span><span class=o>=</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a>    <span class=n>size_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>    <span class=n>direction</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a>    <span class=n>leverage_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a>    <span class=n>reject_prob</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-47-15><a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-47-16><a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-47-17><a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a>    <span class=n>raise_reject</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-47-18><a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a>    <span class=n>log</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-47-19><a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a><span class=p>)</span>
</span></code></pre></div> <p>Create an order.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price.</dd> <dt><strong><code>size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of order size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>leverage_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Leverage mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LeverageMode title=vectorbtpro.portfolio.enums.LeverageMode>LeverageMode</a>.</p> </dd> <dt><strong><code>reject_prob</code></strong> :&ensp;<code>float</code></dt> <dd>Rejection probability threshold.</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>raise_reject</code></strong> :&ensp;<code>bool</code></dt> <dd>Raise an exception if the order is rejected.</dd> <dt><strong><code>log</code></strong> :&ensp;<code>bool</code></dt> <dd>Log the order execution.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Order</code></dt> <dd>Created order object.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.order_not_filled_nb>order_not_filled_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L24-L40 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.order_not_filled_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=n>order_not_filled_nb</span><span class=p>(</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>    <span class=n>status</span><span class=p>,</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>    <span class=n>status_info</span>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=p>)</span>
</span></code></pre></div> <p>Return an <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderResult title=vectorbtpro.portfolio.enums.OrderResult>OrderResult</a> for an order that has not been filled.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>status</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order status code.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderStatus title=vectorbtpro.portfolio.enums.OrderStatus>OrderStatus</a>.</p> </dd> <dt><strong><code>status_info</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Additional status information code.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderStatusInfo title=vectorbtpro.portfolio.enums.OrderStatusInfo>OrderStatusInfo</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>OrderResult</code></dt> <dd>Order result with NaN size, price, and fees, a side of -1, and the provided status and status_info.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.order_nothing_nb>order_nothing_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2108-L2115 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.order_nothing_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=n>order_nothing_nb</span><span class=p>()</span>
</span></code></pre></div> <p>Create an order representing no operation.</p> <p><strong>Returns</strong></p> <dl> <dt><code>Order</code></dt> <dd>Order that effectively does nothing.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_last_cash_nb>prepare_last_cash_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2182-L2208 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_last_cash_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=n>prepare_last_cash_nb</span><span class=p>(</span>
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>    <span class=n>target_shape</span><span class=p>,</span>
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>    <span class=n>group_lens</span><span class=p>,</span>
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a>    <span class=n>cash_sharing</span><span class=p>,</span>
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a>    <span class=n>init_cash</span>
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare the last cash array based on cash sharing.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>target_shape</code></strong> :&ensp;<code>Shape</code></dt> <dd>Base dimensions (rows, columns).</dd> <dt><strong><code>group_lens</code></strong> :&ensp;<code>GroupLens</code></dt> <dd>Array defining the number of columns in each group.</dd> <dt><strong><code>cash_sharing</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating whether cash is shared among assets of the same group.</dd> <dt><strong><code>init_cash</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial cash values.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Array1d</code></dt> <dd>Array containing the last cash values per group or column.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_last_pos_info_nb>prepare_last_pos_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2276-L2322 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_last_pos_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=n>prepare_last_pos_info_nb</span><span class=p>(</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>    <span class=n>target_shape</span><span class=p>,</span>
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>    <span class=n>init_position</span><span class=p>,</span>
</span><span id=__span-51-4><a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-51-5><a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a>    <span class=n>fill_pos_info</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-51-6><a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare last position information array.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>target_shape</code></strong> :&ensp;<code>Shape</code></dt> <dd>Base dimensions (rows, columns).</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial positions.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial position prices.</dd> <dt><strong><code>fill_pos_info</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to fill the position information record.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>RecordArray</code></dt> <dd> <p>Array of last position information records.</p> <p>Has the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.trade_dt title=vectorbtpro.portfolio.enums.trade_dt>trade_dt</a> dtype.</p> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_last_position_nb>prepare_last_position_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2211-L2225 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_last_position_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=n>prepare_last_position_nb</span><span class=p>(</span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>    <span class=n>target_shape</span><span class=p>,</span>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>    <span class=n>init_position</span>
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare the last position array.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>target_shape</code></strong> :&ensp;<code>Shape</code></dt> <dd>Base dimensions (rows, columns).</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial positions.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Array1d</code></dt> <dd>Array containing the last positions for each column.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_last_value_nb>prepare_last_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2228-L2273 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_last_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=n>prepare_last_value_nb</span><span class=p>(</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a>    <span class=n>target_shape</span><span class=p>,</span>
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a>    <span class=n>group_lens</span><span class=p>,</span>
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>    <span class=n>cash_sharing</span><span class=p>,</span>
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a>    <span class=n>init_cash</span><span class=p>,</span>
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a>    <span class=n>init_position</span><span class=p>,</span>
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a>    <span class=n>init_price</span>
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare the last value array by combining cash and position values.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>target_shape</code></strong> :&ensp;<code>Shape</code></dt> <dd>Base dimensions (rows, columns).</dd> <dt><strong><code>group_lens</code></strong> :&ensp;<code>GroupLens</code></dt> <dd>Array defining the number of columns in each group.</dd> <dt><strong><code>cash_sharing</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating whether cash is shared among assets of the same group.</dd> <dt><strong><code>init_cash</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial cash values.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial positions.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>FlexArray1d</code></dt> <dd>Array of initial position prices.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Array1d</code></dt> <dd>Array with computed last values calculated as cash plus position times price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_records_nb>prepare_records_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2146-L2179 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_records_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=n>prepare_records_nb</span><span class=p>(</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>    <span class=n>target_shape</span><span class=p>,</span>
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a>    <span class=n>max_order_records</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-54-4><a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a>    <span class=n>max_log_records</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-54-5><a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare order and log records arrays.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>target_shape</code></strong> :&ensp;<code>Shape</code></dt> <dd>Base dimensions (rows, columns).</dd> <dt><strong><code>max_order_records</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd> <p>Maximum number of order records expected per column.</p> <p>Defaults to the number of rows in the broadcasted shape. Set to 0 to disable, lower to reduce memory usage, or higher if multiple orders per timestamp are expected.</p> </dd> <dt><strong><code>max_log_records</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd> <p>Maximum number of log records expected per column.</p> <p>Set to the number of rows in the broadcasted shape if logging is enabled. Set lower to reduce memory usage, or higher if multiple logs per timestamp are expected.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[RecordArray2d, RecordArray2d]</code></dt> <dd> <p>Tuple containing:</p> <ul> <li><code>order_records</code>: Array for order records (dtype <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.order_dt title=vectorbtpro.portfolio.enums.order_dt>order_dt</a>).</li> <li><code>log_records</code>: Array for log records (dtype <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.log_dt title=vectorbtpro.portfolio.enums.log_dt>log_dt</a>).</li> </ul> </dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.prepare_sim_out_nb>prepare_sim_out_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2325-L2371 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.prepare_sim_out_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=n>prepare_sim_out_nb</span><span class=p>(</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>    <span class=n>order_records</span><span class=p>,</span>
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a>    <span class=n>order_counts</span><span class=p>,</span>
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a>    <span class=n>log_records</span><span class=p>,</span>
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a>    <span class=n>log_counts</span><span class=p>,</span>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a>    <span class=n>cash_deposits</span><span class=p>,</span>
</span><span id=__span-55-7><a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a>    <span class=n>cash_earnings</span><span class=p>,</span>
</span><span id=__span-55-8><a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a>    <span class=n>call_seq</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-55-9><a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a>    <span class=n>in_outputs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-55-10><a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a>    <span class=n>sim_start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-55-11><a id=__codelineno-55-11 name=__codelineno-55-11 href=#__codelineno-55-11></a>    <span class=n>sim_end</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-55-12><a id=__codelineno-55-12 name=__codelineno-55-12 href=#__codelineno-55-12></a><span class=p>)</span>
</span></code></pre></div> <p>Prepare simulation output.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>order_records</code></strong> :&ensp;<code>RecordArray2d</code></dt> <dd> <p>Array of order records.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.order_dt title=vectorbtpro.portfolio.enums.order_dt>order_dt</a> dtype.</p> </dd> <dt><strong><code>order_counts</code></strong> :&ensp;<code>Array1d</code></dt> <dd>Array containing order counts.</dd> <dt><strong><code>log_records</code></strong> :&ensp;<code>RecordArray2d</code></dt> <dd> <p>Array of log records.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.log_dt title=vectorbtpro.portfolio.enums.log_dt>log_dt</a> dtype.</p> </dd> <dt><strong><code>log_counts</code></strong> :&ensp;<code>Array1d</code></dt> <dd>Array containing log counts.</dd> <dt><strong><code>cash_deposits</code></strong> :&ensp;<code>Array2d</code></dt> <dd>Array of cash deposit entries.</dd> <dt><strong><code>cash_earnings</code></strong> :&ensp;<code>Array2d</code></dt> <dd>Array of cash earning entries.</dd> <dt><strong><code>call_seq</code></strong> :&ensp;<code>Optional[Array2d]</code></dt> <dd>Optional call sequence array.</dd> <dt><strong><code>in_outputs</code></strong> :&ensp;<code>Optional[NamedTuple]</code></dt> <dd>Optional additional outputs.</dd> <dt><strong><code>sim_start</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Optional simulation start positions (inclusive).</dd> <dt><strong><code>sim_end</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Optional simulation end positions (exclusive).</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>SimulationOutput</code></dt> <dd>Simulation output record with repartitioned order and log records and cash entries.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.process_order_nb>process_order_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1889-L1969 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.process_order_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=n>process_order_nb</span><span class=p>(</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>    <span class=n>group</span><span class=p>,</span>
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a>    <span class=n>exec_state</span><span class=p>,</span>
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>    <span class=n>order</span><span class=p>,</span>
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-56-8><a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a>    <span class=n>update_value</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-56-9><a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a>    <span class=n>order_records</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-56-10><a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a>    <span class=n>order_counts</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-56-11><a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a>    <span class=n>log_records</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-56-12><a id=__codelineno-56-12 name=__codelineno-56-12 href=#__codelineno-56-12></a>    <span class=n>log_counts</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-56-13><a id=__codelineno-56-13 name=__codelineno-56-13 href=#__codelineno-56-13></a><span class=p>)</span>
</span></code></pre></div> <p>Process an order by executing it, logging details, and returning the result with updated state.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>group</code></strong> :&ensp;<code>int</code></dt> <dd>Current group index.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>exec_state</code></strong> :&ensp;<code>ExecState</code></dt> <dd> <p>Current execution state.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.ExecState title=vectorbtpro.portfolio.enums.ExecState>ExecState</a>.</p> </dd> <dt><strong><code>order</code></strong> :&ensp;<code>Order</code></dt> <dd> <p>Order to execute.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Order title=vectorbtpro.portfolio.enums.Order>Order</a>.</p> </dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>update_value</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag to update portfolio value with each order.</dd> <dt><strong><code>order_records</code></strong> :&ensp;<code>Optional[RecordArray2d]</code></dt> <dd> <p>Array to store order record details.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.order_dt title=vectorbtpro.portfolio.enums.order_dt>order_dt</a> dtype.</p> </dd> <dt><strong><code>order_counts</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Counters for order records per column.</dd> <dt><strong><code>log_records</code></strong> :&ensp;<code>Optional[RecordArray2d]</code></dt> <dd> <p>Array to store detailed log records.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.log_dt title=vectorbtpro.portfolio.enums.log_dt>log_dt</a> dtype.</p> </dd> <dt><strong><code>log_counts</code></strong> :&ensp;<code>Optional[Array1d]</code></dt> <dd>Counters for log records per column.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, ExecState]</code></dt> <dd>Tuple containing the result of the order execution and the updated execution state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.raise_rejected_order_nb>raise_rejected_order_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1847-L1886 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.raise_rejected_order_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=n>raise_rejected_order_nb</span><span class=p>(</span>
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a>    <span class=n>order_result</span>
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=p>)</span>
</span></code></pre></div> <p>Raise a <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.RejectedOrderError title=vectorbtpro.portfolio.enums.RejectedOrderError>RejectedOrderError</a> based on the order result's status.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>order_result</code></strong> :&ensp;<code>OrderResult</code></dt> <dd> <p>Result of the order execution.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderResult title=vectorbtpro.portfolio.enums.OrderResult>OrderResult</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <p>None</p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_dyn_limit_price_nb>resolve_dyn_limit_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3288-L3307 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_dyn_limit_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=n>resolve_dyn_limit_price_nb</span><span class=p>(</span>
</span><span id=__span-58-2><a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-58-3><a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-58-4><a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a>    <span class=n>limit_price</span>
</span><span id=__span-58-5><a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the dynamic limit price.</p> <p>Determines a bounded limit price using the valuation price as the lower bound and the order price as the upper bound.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Asset valuation price used as the lower bound.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price used as the upper bound.</dd> <dt><strong><code>limit_price</code></strong> :&ensp;<code>float</code></dt> <dd>Proposed limit price value; if infinite, selects a bound based on its sign.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Resolved limit price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_dyn_stop_entry_price_nb>resolve_dyn_stop_entry_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3310-L3337 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_dyn_stop_entry_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=n>resolve_dyn_stop_entry_price_nb</span><span class=p>(</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a>    <span class=n>stop_entry_price</span>
</span><span id=__span-59-5><a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the dynamic stop entry price.</p> <p>Determines the stop entry price using the valuation/open price as the lower bound and the order price as the upper bound.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Asset valuation price used as the lower bound.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price used as the upper bound.</dd> <dt><strong><code>stop_entry_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Proposed stop entry price value.</p> <p>A negative value selects between valuation and order price.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Resolved stop entry price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_hl_nb>resolve_hl_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2600-L2627 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_hl_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=n>resolve_hl_nb</span><span class=p>(</span>
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a>    <span class=nb>open</span><span class=p>,</span>
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a>    <span class=n>high</span><span class=p>,</span>
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a>    <span class=n>low</span><span class=p>,</span>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a>    <span class=n>close</span>
</span><span id=__span-60-6><a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the current high and low prices based on OHLC data.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>open</code></strong> :&ensp;<code>float</code></dt> <dd>Open price.</dd> <dt><strong><code>high</code></strong> :&ensp;<code>float</code></dt> <dd>High price.</dd> <dt><strong><code>low</code></strong> :&ensp;<code>float</code></dt> <dd>Low price.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, float]</code></dt> <dd>Resolved high and low prices.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_limit_order_price_nb>resolve_limit_order_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3006-L3037 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_limit_order_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=n>resolve_limit_order_price_nb</span><span class=p>(</span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a>    <span class=n>limit_price</span><span class=p>,</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a>    <span class=n>close</span><span class=p>,</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a>    <span class=n>limit_order_price</span>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=p>)</span>
</span></code></pre></div> <p>Determine the appropriate limit order price based on the specified option.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>limit_price</code></strong> :&ensp;<code>float</code></dt> <dd>Computed limit price.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> <dt><strong><code>limit_order_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Limit order price or option.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LimitOrderPrice title=vectorbtpro.portfolio.enums.LimitOrderPrice>LimitOrderPrice</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Resolved limit order price.</dd> </dl> <p><strong>Raises</strong></p> <dl> <dt><code>ValueError</code></dt> <dd>If <code>limit_order_price</code> is less than 0.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_limit_price_nb>resolve_limit_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2878-L2934 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_limit_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=n>resolve_limit_price_nb</span><span class=p>(</span>
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-62-3><a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-62-4><a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-62-5><a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a>    <span class=n>hit_below</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-62-6><a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the limit price based on the initial price and adjustment delta.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial reference price.</dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>hit_below</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, check whether the target price is hit from above.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Computed limit price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_size_nb>resolve_size_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1304-L1402 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_size_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=n>resolve_size_nb</span><span class=p>(</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a>    <span class=n>size_type</span><span class=p>,</span>
</span><span id=__span-63-4><a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a>    <span class=n>position</span><span class=p>,</span>
</span><span id=__span-63-5><a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a>    <span class=n>val_price</span><span class=p>,</span>
</span><span id=__span-63-6><a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a>    <span class=n>value</span><span class=p>,</span>
</span><span id=__span-63-7><a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a>    <span class=n>target_size_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-63-8><a id=__codelineno-63-8 name=__codelineno-63-8 href=#__codelineno-63-8></a>    <span class=n>as_requirement</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-63-9><a id=__codelineno-63-9 name=__codelineno-63-9 href=#__codelineno-63-9></a><span class=p>)</span>
</span></code></pre></div> <p>Convert size specification into an absolute asset amount and its corresponding percentage.</p> <p>The percentage is set only when the <code>SizeType.Percent(100)</code> option is used.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> <dt><strong><code>size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of order size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>position</code></strong> :&ensp;<code>float</code></dt> <dd>Current asset position.</dd> <dt><strong><code>val_price</code></strong> :&ensp;<code>float</code></dt> <dd>Valuation price of the asset.</dd> <dt><strong><code>value</code></strong> :&ensp;<code>float</code></dt> <dd>Total portfolio value.</dd> <dt><strong><code>target_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Requested type of order size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>as_requirement</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to treat the size as a requirement adjustment.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[float, float]</code></dt> <dd>Tuple containing the absolute asset amount and the percentage representation.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_stop_exit_price_nb>resolve_stop_exit_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2694-L2719 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_stop_exit_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=n>resolve_stop_exit_price_nb</span><span class=p>(</span>
</span><span id=__span-64-2><a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>    <span class=n>stop_price</span><span class=p>,</span>
</span><span id=__span-64-3><a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a>    <span class=n>close</span><span class=p>,</span>
</span><span id=__span-64-4><a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a>    <span class=n>stop_exit_price</span>
</span><span id=__span-64-5><a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the exit price for a stop order based on the specified stop exit option.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>stop_price</code></strong> :&ensp;<code>float</code></dt> <dd>Computed stop price.</dd> <dt><strong><code>close</code></strong> :&ensp;<code>float</code></dt> <dd>Close price.</dd> <dt><strong><code>stop_exit_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Option indicating how to determine the exit price.</p> <p>If equal to <code>StopExitPrice.Stop</code> or <code>StopExitPrice.HardStop</code>, the stop price is used; if equal to <code>StopExitPrice.Close</code>, the close price is used; otherwise, the provided value is used.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Resolved exit price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.resolve_stop_price_nb>resolve_stop_price_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3040-L3081 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.resolve_stop_price_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=n>resolve_stop_price_nb</span><span class=p>(</span>
</span><span id=__span-65-2><a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a>    <span class=n>init_price</span><span class=p>,</span>
</span><span id=__span-65-3><a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a>    <span class=n>stop</span><span class=p>,</span>
</span><span id=__span-65-4><a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-65-5><a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a>    <span class=n>hit_below</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-65-6><a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=p>)</span>
</span></code></pre></div> <p>Resolve the stop price based on the initial price and adjustment value.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial reference price.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>hit_below</code></strong> :&ensp;<code>bool</code></dt> <dd>If True, check whether the target price is hit from above.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Computed stop price.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.sell_nb>sell_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1080-L1244 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.sell_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=n>sell_nb</span><span class=p>(</span>
</span><span id=__span-66-2><a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-66-3><a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-66-4><a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-66-5><a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a>    <span class=n>direction</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-66-6><a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-66-7><a id=__codelineno-66-7 name=__codelineno-66-7 href=#__codelineno-66-7></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-66-8><a id=__codelineno-66-8 name=__codelineno-66-8 href=#__codelineno-66-8></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-66-9><a id=__codelineno-66-9 name=__codelineno-66-9 href=#__codelineno-66-9></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-66-10><a id=__codelineno-66-10 name=__codelineno-66-10 href=#__codelineno-66-10></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-66-11><a id=__codelineno-66-11 name=__codelineno-66-11 href=#__codelineno-66-11></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-66-12><a id=__codelineno-66-12 name=__codelineno-66-12 href=#__codelineno-66-12></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-66-13><a id=__codelineno-66-13 name=__codelineno-66-13 href=#__codelineno-66-13></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-66-14><a id=__codelineno-66-14 name=__codelineno-66-14 href=#__codelineno-66-14></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-66-15><a id=__codelineno-66-15 name=__codelineno-66-15 href=#__codelineno-66-15></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-66-16><a id=__codelineno-66-16 name=__codelineno-66-16 href=#__codelineno-66-16></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-66-17><a id=__codelineno-66-17 name=__codelineno-66-17 href=#__codelineno-66-17></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-66-18><a id=__codelineno-66-18 name=__codelineno-66-18 href=#__codelineno-66-18></a><span class=p>)</span>
</span></code></pre></div> <p>Execute a sell order based on the current account state and specified parameters.</p> <p>Depending on the account state and trade direction, this function delegates the sell order to either <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.long_sell_nb title=vectorbtpro.portfolio.nb.core.long_sell_nb>long_sell_nb</a> or <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/#vectorbtpro.portfolio.nb.core.short_sell_nb title=vectorbtpro.portfolio.nb.core.short_sell_nb>short_sell_nb</a>. For positions spanning both long and short, it processes the long portion first and, if fully filled, proceeds with a short sell for the remaining size.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Order size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Order price.</dd> <dt><strong><code>direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the order result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.set_limit_info_nb>set_limit_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3559-L3629 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.set_limit_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=n>set_limit_info_nb</span><span class=p>(</span>
</span><span id=__span-67-2><a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a>    <span class=n>limit_info</span><span class=p>,</span>
</span><span id=__span-67-3><a id=__codelineno-67-3 name=__codelineno-67-3 href=#__codelineno-67-3></a>    <span class=n>signal_idx</span><span class=p>,</span>
</span><span id=__span-67-4><a id=__codelineno-67-4 name=__codelineno-67-4 href=#__codelineno-67-4></a>    <span class=n>creation_idx</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-67-5><a id=__codelineno-67-5 name=__codelineno-67-5 href=#__codelineno-67-5></a>    <span class=n>init_idx</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-67-6><a id=__codelineno-67-6 name=__codelineno-67-6 href=#__codelineno-67-6></a>    <span class=n>init_price</span><span class=o>=-</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-67-7><a id=__codelineno-67-7 name=__codelineno-67-7 href=#__codelineno-67-7></a>    <span class=n>init_size</span><span class=o>=</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-67-8><a id=__codelineno-67-8 name=__codelineno-67-8 href=#__codelineno-67-8></a>    <span class=n>init_size_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-67-9><a id=__codelineno-67-9 name=__codelineno-67-9 href=#__codelineno-67-9></a>    <span class=n>init_direction</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-67-10><a id=__codelineno-67-10 name=__codelineno-67-10 href=#__codelineno-67-10></a>    <span class=n>init_stop_type</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-67-11><a id=__codelineno-67-11 name=__codelineno-67-11 href=#__codelineno-67-11></a>    <span class=n>delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-67-12><a id=__codelineno-67-12 name=__codelineno-67-12 href=#__codelineno-67-12></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-67-13><a id=__codelineno-67-13 name=__codelineno-67-13 href=#__codelineno-67-13></a>    <span class=n>tif</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-67-14><a id=__codelineno-67-14 name=__codelineno-67-14 href=#__codelineno-67-14></a>    <span class=n>expiry</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-67-15><a id=__codelineno-67-15 name=__codelineno-67-15 href=#__codelineno-67-15></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-67-16><a id=__codelineno-67-16 name=__codelineno-67-16 href=#__codelineno-67-16></a>    <span class=n>reverse</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-67-17><a id=__codelineno-67-17 name=__codelineno-67-17 href=#__codelineno-67-17></a>    <span class=n>order_price</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-67-18><a id=__codelineno-67-18 name=__codelineno-67-18 href=#__codelineno-67-18></a><span class=p>)</span>
</span></code></pre></div> <p>Set limit order information in the provided record.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>limit_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing limit order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.limit_info_dt title=vectorbtpro.portfolio.enums.limit_info_dt>limit_info_dt</a> dtype.</p> </dd> <dt><strong><code>signal_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Row index of the signal triggering the limit order.</dd> <dt><strong><code>creation_idx</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd>Creation row index.</dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd>Initial row index for the order.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price.</dd> <dt><strong><code>init_size</code></strong> :&ensp;<code>float</code></dt> <dd>Initial order size.</dd> <dt><strong><code>init_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of initial order size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>init_direction</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order direction.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.Direction title=vectorbtpro.portfolio.enums.Direction>Direction</a>.</p> </dd> <dt><strong><code>init_stop_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Initial stop type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/signals/enums/#vectorbtpro.signals.enums.StopType title=vectorbtpro.signals.enums.StopType>StopType</a>.</p> </dd> <dt><strong><code>delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value associated with the order.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>tif</code></strong> :&ensp;<code>int</code></dt> <dd>Time-in-force duration; use -1 if undefined.</dd> <dt><strong><code>expiry</code></strong> :&ensp;<code>int</code></dt> <dd>Expiry index; use -1 if undefined.</dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>reverse</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the order is reversed.</dd> <dt><strong><code>order_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Limit order price or option.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.LimitOrderPrice title=vectorbtpro.portfolio.enums.LimitOrderPrice>LimitOrderPrice</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>limit_info</code> record in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.set_sl_info_nb>set_sl_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3661-L3731 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.set_sl_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=n>set_sl_info_nb</span><span class=p>(</span>
</span><span id=__span-68-2><a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a>    <span class=n>sl_info</span><span class=p>,</span>
</span><span id=__span-68-3><a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-68-4><a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a>    <span class=n>init_price</span><span class=o>=-</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-68-5><a id=__codelineno-68-5 name=__codelineno-68-5 href=#__codelineno-68-5></a>    <span class=n>init_position</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-68-6><a id=__codelineno-68-6 name=__codelineno-68-6 href=#__codelineno-68-6></a>    <span class=n>stop</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-68-7><a id=__codelineno-68-7 name=__codelineno-68-7 href=#__codelineno-68-7></a>    <span class=n>exit_price</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-68-8><a id=__codelineno-68-8 name=__codelineno-68-8 href=#__codelineno-68-8></a>    <span class=n>exit_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-68-9><a id=__codelineno-68-9 name=__codelineno-68-9 href=#__codelineno-68-9></a>    <span class=n>exit_size_type</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-68-10><a id=__codelineno-68-10 name=__codelineno-68-10 href=#__codelineno-68-10></a>    <span class=n>exit_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-68-11><a id=__codelineno-68-11 name=__codelineno-68-11 href=#__codelineno-68-11></a>    <span class=n>order_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-68-12><a id=__codelineno-68-12 name=__codelineno-68-12 href=#__codelineno-68-12></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-68-13><a id=__codelineno-68-13 name=__codelineno-68-13 href=#__codelineno-68-13></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-68-14><a id=__codelineno-68-14 name=__codelineno-68-14 href=#__codelineno-68-14></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-68-15><a id=__codelineno-68-15 name=__codelineno-68-15 href=#__codelineno-68-15></a>    <span class=n>step</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-68-16><a id=__codelineno-68-16 name=__codelineno-68-16 href=#__codelineno-68-16></a>    <span class=n>step_idx</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-68-17><a id=__codelineno-68-17 name=__codelineno-68-17 href=#__codelineno-68-17></a><span class=p>)</span>
</span></code></pre></div> <p>Set SL (stop loss) order information in the provided record.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>sl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing SL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.sl_info_dt title=vectorbtpro.portfolio.enums.sl_info_dt>sl_info_dt</a> dtype.</p> </dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index for the SL order.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price for the SL order.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value.</dd> <dt><strong><code>exit_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Exit price.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitPrice title=vectorbtpro.portfolio.enums.StopExitPrice>StopExitPrice</a>.</p> </dd> <dt><strong><code>exit_size</code></strong> :&ensp;<code>float</code></dt> <dd>Exit size.</dd> <dt><strong><code>exit_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of exit size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>exit_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Exit type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitType title=vectorbtpro.portfolio.enums.StopExitType>StopExitType</a>.</p> </dd> <dt><strong><code>order_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order execution type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderType title=vectorbtpro.portfolio.enums.OrderType>OrderType</a>.</p> </dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>step_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Ladder step index.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>sl_info</code> record in place.</dd> </dl> <p><strong>See</strong></p> <p><a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.sl_info_dt title=vectorbtpro.portfolio.enums.sl_info_dt>sl_info_dt</a></p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.set_time_info_nb>set_time_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3980-L4052 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.set_time_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=n>set_time_info_nb</span><span class=p>(</span>
</span><span id=__span-69-2><a id=__codelineno-69-2 name=__codelineno-69-2 href=#__codelineno-69-2></a>    <span class=n>time_info</span><span class=p>,</span>
</span><span id=__span-69-3><a id=__codelineno-69-3 name=__codelineno-69-3 href=#__codelineno-69-3></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-69-4><a id=__codelineno-69-4 name=__codelineno-69-4 href=#__codelineno-69-4></a>    <span class=n>init_position</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-69-5><a id=__codelineno-69-5 name=__codelineno-69-5 href=#__codelineno-69-5></a>    <span class=n>stop</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-6><a id=__codelineno-69-6 name=__codelineno-69-6 href=#__codelineno-69-6></a>    <span class=n>exit_price</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-7><a id=__codelineno-69-7 name=__codelineno-69-7 href=#__codelineno-69-7></a>    <span class=n>exit_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-69-8><a id=__codelineno-69-8 name=__codelineno-69-8 href=#__codelineno-69-8></a>    <span class=n>exit_size_type</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-9><a id=__codelineno-69-9 name=__codelineno-69-9 href=#__codelineno-69-9></a>    <span class=n>exit_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-69-10><a id=__codelineno-69-10 name=__codelineno-69-10 href=#__codelineno-69-10></a>    <span class=n>order_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-69-11><a id=__codelineno-69-11 name=__codelineno-69-11 href=#__codelineno-69-11></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-69-12><a id=__codelineno-69-12 name=__codelineno-69-12 href=#__codelineno-69-12></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-13><a id=__codelineno-69-13 name=__codelineno-69-13 href=#__codelineno-69-13></a>    <span class=n>time_delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-14><a id=__codelineno-69-14 name=__codelineno-69-14 href=#__codelineno-69-14></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-69-15><a id=__codelineno-69-15 name=__codelineno-69-15 href=#__codelineno-69-15></a>    <span class=n>step</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-69-16><a id=__codelineno-69-16 name=__codelineno-69-16 href=#__codelineno-69-16></a>    <span class=n>step_idx</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-69-17><a id=__codelineno-69-17 name=__codelineno-69-17 href=#__codelineno-69-17></a><span class=p>)</span>
</span></code></pre></div> <p>Set time order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>time_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing time-based order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.time_info_dt title=vectorbtpro.portfolio.enums.time_info_dt>time_info_dt</a> dtype.</p> </dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>int</code></dt> <dd>Stop indicator or time.</dd> <dt><strong><code>exit_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Exit price.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitPrice title=vectorbtpro.portfolio.enums.StopExitPrice>StopExitPrice</a>.</p> </dd> <dt><strong><code>exit_size</code></strong> :&ensp;<code>float</code></dt> <dd>Exit size.</dd> <dt><strong><code>exit_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of exit size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>exit_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Exit type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitType title=vectorbtpro.portfolio.enums.StopExitType>StopExitType</a>.</p> </dd> <dt><strong><code>order_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order execution type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderType title=vectorbtpro.portfolio.enums.OrderType>OrderType</a>.</p> </dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>time_delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for time delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.TimeDeltaFormat title=vectorbtpro.portfolio.enums.TimeDeltaFormat>TimeDeltaFormat</a>.</p> </dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>step_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Ladder step index.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>time_info</code> record in place.</dd> </dl> <p><strong>See</strong></p> <p><a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.time_info_dt title=vectorbtpro.portfolio.enums.time_info_dt>time_info_dt</a></p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.set_tp_info_nb>set_tp_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3879-L3949 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.set_tp_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=n>set_tp_info_nb</span><span class=p>(</span>
</span><span id=__span-70-2><a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a>    <span class=n>tp_info</span><span class=p>,</span>
</span><span id=__span-70-3><a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-70-4><a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a>    <span class=n>init_price</span><span class=o>=-</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-70-5><a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a>    <span class=n>init_position</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-70-6><a id=__codelineno-70-6 name=__codelineno-70-6 href=#__codelineno-70-6></a>    <span class=n>stop</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-70-7><a id=__codelineno-70-7 name=__codelineno-70-7 href=#__codelineno-70-7></a>    <span class=n>exit_price</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-70-8><a id=__codelineno-70-8 name=__codelineno-70-8 href=#__codelineno-70-8></a>    <span class=n>exit_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-70-9><a id=__codelineno-70-9 name=__codelineno-70-9 href=#__codelineno-70-9></a>    <span class=n>exit_size_type</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-70-10><a id=__codelineno-70-10 name=__codelineno-70-10 href=#__codelineno-70-10></a>    <span class=n>exit_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-70-11><a id=__codelineno-70-11 name=__codelineno-70-11 href=#__codelineno-70-11></a>    <span class=n>order_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-70-12><a id=__codelineno-70-12 name=__codelineno-70-12 href=#__codelineno-70-12></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-70-13><a id=__codelineno-70-13 name=__codelineno-70-13 href=#__codelineno-70-13></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-70-14><a id=__codelineno-70-14 name=__codelineno-70-14 href=#__codelineno-70-14></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-70-15><a id=__codelineno-70-15 name=__codelineno-70-15 href=#__codelineno-70-15></a>    <span class=n>step</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-70-16><a id=__codelineno-70-16 name=__codelineno-70-16 href=#__codelineno-70-16></a>    <span class=n>step_idx</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-70-17><a id=__codelineno-70-17 name=__codelineno-70-17 href=#__codelineno-70-17></a><span class=p>)</span>
</span></code></pre></div> <p>Set TP order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tp_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TP order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tp_info_dt title=vectorbtpro.portfolio.enums.tp_info_dt>tp_info_dt</a> dtype.</p> </dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value.</dd> <dt><strong><code>exit_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Exit price.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitPrice title=vectorbtpro.portfolio.enums.StopExitPrice>StopExitPrice</a>.</p> </dd> <dt><strong><code>exit_size</code></strong> :&ensp;<code>float</code></dt> <dd>Exit size.</dd> <dt><strong><code>exit_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of exit size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>exit_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Exit type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitType title=vectorbtpro.portfolio.enums.StopExitType>StopExitType</a>.</p> </dd> <dt><strong><code>order_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order execution type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderType title=vectorbtpro.portfolio.enums.OrderType>OrderType</a>.</p> </dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>step_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Ladder step index.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>tp_info</code> record in place.</dd> </dl> <p><strong>See</strong></p> <p><a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tp_info_dt title=vectorbtpro.portfolio.enums.tp_info_dt>tp_info_dt</a></p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.set_tsl_info_nb>set_tsl_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L3762-L3845 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.set_tsl_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=n>set_tsl_info_nb</span><span class=p>(</span>
</span><span id=__span-71-2><a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a>    <span class=n>tsl_info</span><span class=p>,</span>
</span><span id=__span-71-3><a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a>    <span class=n>init_idx</span><span class=p>,</span>
</span><span id=__span-71-4><a id=__codelineno-71-4 name=__codelineno-71-4 href=#__codelineno-71-4></a>    <span class=n>init_price</span><span class=o>=-</span><span class=n>inf</span><span class=p>,</span>
</span><span id=__span-71-5><a id=__codelineno-71-5 name=__codelineno-71-5 href=#__codelineno-71-5></a>    <span class=n>init_position</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-71-6><a id=__codelineno-71-6 name=__codelineno-71-6 href=#__codelineno-71-6></a>    <span class=n>peak_idx</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-71-7><a id=__codelineno-71-7 name=__codelineno-71-7 href=#__codelineno-71-7></a>    <span class=n>peak_price</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-71-8><a id=__codelineno-71-8 name=__codelineno-71-8 href=#__codelineno-71-8></a>    <span class=n>stop</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-71-9><a id=__codelineno-71-9 name=__codelineno-71-9 href=#__codelineno-71-9></a>    <span class=n>th</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-71-10><a id=__codelineno-71-10 name=__codelineno-71-10 href=#__codelineno-71-10></a>    <span class=n>exit_price</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-71-11><a id=__codelineno-71-11 name=__codelineno-71-11 href=#__codelineno-71-11></a>    <span class=n>exit_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-71-12><a id=__codelineno-71-12 name=__codelineno-71-12 href=#__codelineno-71-12></a>    <span class=n>exit_size_type</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-71-13><a id=__codelineno-71-13 name=__codelineno-71-13 href=#__codelineno-71-13></a>    <span class=n>exit_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-71-14><a id=__codelineno-71-14 name=__codelineno-71-14 href=#__codelineno-71-14></a>    <span class=n>order_type</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-71-15><a id=__codelineno-71-15 name=__codelineno-71-15 href=#__codelineno-71-15></a>    <span class=n>limit_delta</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-71-16><a id=__codelineno-71-16 name=__codelineno-71-16 href=#__codelineno-71-16></a>    <span class=n>delta_format</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-71-17><a id=__codelineno-71-17 name=__codelineno-71-17 href=#__codelineno-71-17></a>    <span class=n>ladder</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-71-18><a id=__codelineno-71-18 name=__codelineno-71-18 href=#__codelineno-71-18></a>    <span class=n>step</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-71-19><a id=__codelineno-71-19 name=__codelineno-71-19 href=#__codelineno-71-19></a>    <span class=n>step_idx</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-71-20><a id=__codelineno-71-20 name=__codelineno-71-20 href=#__codelineno-71-20></a><span class=p>)</span>
</span></code></pre></div> <p>Set TSL/TTP order information.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>tsl_info</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Record containing TSL order information.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tsl_info_dt title=vectorbtpro.portfolio.enums.tsl_info_dt>tsl_info_dt</a> dtype.</p> </dd> <dt><strong><code>init_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Initial row index.</dd> <dt><strong><code>init_price</code></strong> :&ensp;<code>float</code></dt> <dd>Initial price.</dd> <dt><strong><code>init_position</code></strong> :&ensp;<code>float</code></dt> <dd>Initial position size.</dd> <dt><strong><code>peak_idx</code></strong> :&ensp;<code>Optional[int]</code></dt> <dd> <p>Peak row index.</p> <p>Defaults to <code>init_idx</code> if not provided.</p> </dd> <dt><strong><code>peak_price</code></strong> :&ensp;<code>Optional[float]</code></dt> <dd> <p>Peak price.</p> <p>Defaults to <code>init_price</code> if not provided.</p> </dd> <dt><strong><code>stop</code></strong> :&ensp;<code>float</code></dt> <dd>Stop value.</dd> <dt><strong><code>th</code></strong> :&ensp;<code>float</code></dt> <dd>Trailing threshold value.</dd> <dt><strong><code>exit_price</code></strong> :&ensp;<code>float</code></dt> <dd> <p>Exit price.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitPrice title=vectorbtpro.portfolio.enums.StopExitPrice>StopExitPrice</a>.</p> </dd> <dt><strong><code>exit_size</code></strong> :&ensp;<code>float</code></dt> <dd>Exit size.</dd> <dt><strong><code>exit_size_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Type of exit size.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.SizeType title=vectorbtpro.portfolio.enums.SizeType>SizeType</a>.</p> </dd> <dt><strong><code>exit_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Exit type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopExitType title=vectorbtpro.portfolio.enums.StopExitType>StopExitType</a>.</p> </dd> <dt><strong><code>order_type</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Order execution type.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderType title=vectorbtpro.portfolio.enums.OrderType>OrderType</a>.</p> </dd> <dt><strong><code>limit_delta</code></strong> :&ensp;<code>float</code></dt> <dd>Delta value used to adjust the limit price.</dd> <dt><strong><code>delta_format</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Format for delta comparisons.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.DeltaFormat title=vectorbtpro.portfolio.enums.DeltaFormat>DeltaFormat</a>.</p> </dd> <dt><strong><code>ladder</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Stop ladder mode.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopLadderMode title=vectorbtpro.portfolio.enums.StopLadderMode>StopLadderMode</a>.</p> </dd> <dt><strong><code>step</code></strong> :&ensp;<code>int</code></dt> <dd>Current step index in the ladder.</dd> <dt><strong><code>step_idx</code></strong> :&ensp;<code>int</code></dt> <dd>Ladder step index.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>Function modifies the <code>tsl_info</code> record in place.</dd> </dl> <p><strong>See</strong></p> <p><a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.tsl_info_dt title=vectorbtpro.portfolio.enums.tsl_info_dt>tsl_info_dt</a></p> <hr> <h2 id=vectorbtpro.portfolio.nb.core.short_buy_nb>short_buy_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L674-L829 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.short_buy_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-72-1><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=n>short_buy_nb</span><span class=p>(</span>
</span><span id=__span-72-2><a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-72-3><a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-72-4><a id=__codelineno-72-4 name=__codelineno-72-4 href=#__codelineno-72-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-72-5><a id=__codelineno-72-5 name=__codelineno-72-5 href=#__codelineno-72-5></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-72-6><a id=__codelineno-72-6 name=__codelineno-72-6 href=#__codelineno-72-6></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-72-7><a id=__codelineno-72-7 name=__codelineno-72-7 href=#__codelineno-72-7></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-72-8><a id=__codelineno-72-8 name=__codelineno-72-8 href=#__codelineno-72-8></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-72-9><a id=__codelineno-72-9 name=__codelineno-72-9 href=#__codelineno-72-9></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-72-10><a id=__codelineno-72-10 name=__codelineno-72-10 href=#__codelineno-72-10></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-72-11><a id=__codelineno-72-11 name=__codelineno-72-11 href=#__codelineno-72-11></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-72-12><a id=__codelineno-72-12 name=__codelineno-72-12 href=#__codelineno-72-12></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-72-13><a id=__codelineno-72-13 name=__codelineno-72-13 href=#__codelineno-72-13></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-72-14><a id=__codelineno-72-14 name=__codelineno-72-14 href=#__codelineno-72-14></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-72-15><a id=__codelineno-72-15 name=__codelineno-72-15 href=#__codelineno-72-15></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-72-16><a id=__codelineno-72-16 name=__codelineno-72-16 href=#__codelineno-72-16></a><span class=p>)</span>
</span></code></pre></div> <p>Decrease or close a short position.</p> <p>This function processes an order to reduce or cover a short position. It verifies that an open position exists, checks for sufficient cash, and adjusts the order size based on constraints such as maximum size, granularity, and percentage limits. The function calculates the required fees and cash, and returns the order result along with an updated account state.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Requested order size for covering the short position.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Execution price for the order.</dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the executed order result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.short_sell_nb>short_sell_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L504-L643 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.short_sell_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-73-1><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=n>short_sell_nb</span><span class=p>(</span>
</span><span id=__span-73-2><a id=__codelineno-73-2 name=__codelineno-73-2 href=#__codelineno-73-2></a>    <span class=n>account_state</span><span class=p>,</span>
</span><span id=__span-73-3><a id=__codelineno-73-3 name=__codelineno-73-3 href=#__codelineno-73-3></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-73-4><a id=__codelineno-73-4 name=__codelineno-73-4 href=#__codelineno-73-4></a>    <span class=n>price</span><span class=p>,</span>
</span><span id=__span-73-5><a id=__codelineno-73-5 name=__codelineno-73-5 href=#__codelineno-73-5></a>    <span class=n>fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-73-6><a id=__codelineno-73-6 name=__codelineno-73-6 href=#__codelineno-73-6></a>    <span class=n>fixed_fees</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-73-7><a id=__codelineno-73-7 name=__codelineno-73-7 href=#__codelineno-73-7></a>    <span class=n>slippage</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-73-8><a id=__codelineno-73-8 name=__codelineno-73-8 href=#__codelineno-73-8></a>    <span class=n>min_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-73-9><a id=__codelineno-73-9 name=__codelineno-73-9 href=#__codelineno-73-9></a>    <span class=n>max_size</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-73-10><a id=__codelineno-73-10 name=__codelineno-73-10 href=#__codelineno-73-10></a>    <span class=n>size_granularity</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-73-11><a id=__codelineno-73-11 name=__codelineno-73-11 href=#__codelineno-73-11></a>    <span class=n>leverage</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
</span><span id=__span-73-12><a id=__codelineno-73-12 name=__codelineno-73-12 href=#__codelineno-73-12></a>    <span class=n>price_area_vio_mode</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-73-13><a id=__codelineno-73-13 name=__codelineno-73-13 href=#__codelineno-73-13></a>    <span class=n>allow_partial</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-73-14><a id=__codelineno-73-14 name=__codelineno-73-14 href=#__codelineno-73-14></a>    <span class=n>percent</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span>
</span><span id=__span-73-15><a id=__codelineno-73-15 name=__codelineno-73-15 href=#__codelineno-73-15></a>    <span class=n>price_area</span><span class=o>=</span><span class=n>PriceArea</span><span class=p>(</span><span class=nb>open</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>high</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>low</span><span class=o>=</span><span class=n>nan</span><span class=p>,</span> <span class=n>close</span><span class=o>=</span><span class=n>nan</span><span class=p>),</span>
</span><span id=__span-73-16><a id=__codelineno-73-16 name=__codelineno-73-16 href=#__codelineno-73-16></a>    <span class=n>is_closing_price</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-73-17><a id=__codelineno-73-17 name=__codelineno-73-17 href=#__codelineno-73-17></a><span class=p>)</span>
</span></code></pre></div> <p>Open or increase a short position by placing a sell order.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>account_state</code></strong> :&ensp;<code>AccountState</code></dt> <dd> <p>Current state of the trading account.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.AccountState title=vectorbtpro.portfolio.enums.AccountState>AccountState</a>.</p> </dd> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Intended order size to initiate or increase a short position.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Market price used to compute the adjusted order price.</dd> <dt><strong><code>fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fraction of the order value charged as fee.</dd> <dt><strong><code>fixed_fees</code></strong> :&ensp;<code>float</code></dt> <dd>Fixed fee amount charged per order.</dd> <dt><strong><code>slippage</code></strong> :&ensp;<code>float</code></dt> <dd>Slippage percentage to adjust the execution price.</dd> <dt><strong><code>min_size</code></strong> :&ensp;<code>float</code></dt> <dd>Minimum allowed order size.</dd> <dt><strong><code>max_size</code></strong> :&ensp;<code>float</code></dt> <dd>Maximum allowed order size.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> <dt><strong><code>leverage</code></strong> :&ensp;<code>float</code></dt> <dd>Leverage factor.</dd> <dt><strong><code>price_area_vio_mode</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for handling price area violations.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceAreaVioMode title=vectorbtpro.portfolio.enums.PriceAreaVioMode>PriceAreaVioMode</a>.</p> </dd> <dt><strong><code>allow_partial</code></strong> :&ensp;<code>bool</code></dt> <dd>Whether to allow partial order fulfillment.</dd> <dt><strong><code>percent</code></strong> :&ensp;<code>float</code></dt> <dd>Scaling factor to restrict the allowed order size.</dd> <dt><strong><code>price_area</code></strong> :&ensp;<code>PriceArea</code></dt> <dd> <p>Price area constraint.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.PriceArea title=vectorbtpro.portfolio.enums.PriceArea>PriceArea</a>.</p> </dd> <dt><strong><code>is_closing_price</code></strong> :&ensp;<code>bool</code></dt> <dd>Flag indicating if the price is a close price.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>Tuple[OrderResult, AccountState]</code></dt> <dd>Tuple containing the filled order result and the updated account state.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.should_apply_size_granularity_nb>should_apply_size_granularity_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L108-L124 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.should_apply_size_granularity_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-74-1><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=n>should_apply_size_granularity_nb</span><span class=p>(</span>
</span><span id=__span-74-2><a id=__codelineno-74-2 name=__codelineno-74-2 href=#__codelineno-74-2></a>    <span class=n>size</span><span class=p>,</span>
</span><span id=__span-74-3><a id=__codelineno-74-3 name=__codelineno-74-3 href=#__codelineno-74-3></a>    <span class=n>size_granularity</span>
</span><span id=__span-74-4><a id=__codelineno-74-4 name=__codelineno-74-4 href=#__codelineno-74-4></a><span class=p>)</span>
</span></code></pre></div> <p>Determine whether size granularity should be applied to the given size.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>size</code></strong> :&ensp;<code>float</code></dt> <dd>Original size value.</dd> <dt><strong><code>size_granularity</code></strong> :&ensp;<code>float</code></dt> <dd>Granularity factor for order size (e.g., 1 for whole shares)</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if size granularity should be applied; otherwise, False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.should_update_stop_nb>should_update_stop_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2764-L2783 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.should_update_stop_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-75-1><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a><span class=n>should_update_stop_nb</span><span class=p>(</span>
</span><span id=__span-75-2><a id=__codelineno-75-2 name=__codelineno-75-2 href=#__codelineno-75-2></a>    <span class=n>new_stop</span><span class=p>,</span>
</span><span id=__span-75-3><a id=__codelineno-75-3 name=__codelineno-75-3 href=#__codelineno-75-3></a>    <span class=n>upon_stop_update</span>
</span><span id=__span-75-4><a id=__codelineno-75-4 name=__codelineno-75-4 href=#__codelineno-75-4></a><span class=p>)</span>
</span></code></pre></div> <p>Determine whether the stop value should be updated based on the update mode.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>new_stop</code></strong> :&ensp;<code>float</code></dt> <dd>New candidate for the stop value.</dd> <dt><strong><code>upon_stop_update</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for updating the stop value.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopUpdateMode title=vectorbtpro.portfolio.enums.StopUpdateMode>StopUpdateMode</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the stop value should be updated, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.should_update_time_stop_nb>should_update_time_stop_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2786-L2805 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.should_update_time_stop_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-76-1><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class=n>should_update_time_stop_nb</span><span class=p>(</span>
</span><span id=__span-76-2><a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a>    <span class=n>new_stop</span><span class=p>,</span>
</span><span id=__span-76-3><a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a>    <span class=n>upon_stop_update</span>
</span><span id=__span-76-4><a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a><span class=p>)</span>
</span></code></pre></div> <p>Determine whether the time stop value should be updated based on the update mode.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>new_stop</code></strong> :&ensp;<code>int</code></dt> <dd>New candidate for the time stop value.</dd> <dt><strong><code>upon_stop_update</code></strong> :&ensp;<code>int</code></dt> <dd> <p>Mode for updating the time stop value.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.StopUpdateMode title=vectorbtpro.portfolio.enums.StopUpdateMode>StopUpdateMode</a>.</p> </dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>bool</code></dt> <dd>True if the time stop value should be updated, otherwise False.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.update_open_pos_info_stats_nb>update_open_pos_info_stats_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2411-L2442 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.update_open_pos_info_stats_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-77-1><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a><span class=n>update_open_pos_info_stats_nb</span><span class=p>(</span>
</span><span id=__span-77-2><a id=__codelineno-77-2 name=__codelineno-77-2 href=#__codelineno-77-2></a>    <span class=n>record</span><span class=p>,</span>
</span><span id=__span-77-3><a id=__codelineno-77-3 name=__codelineno-77-3 href=#__codelineno-77-3></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-77-4><a id=__codelineno-77-4 name=__codelineno-77-4 href=#__codelineno-77-4></a>    <span class=n>price</span>
</span><span id=__span-77-5><a id=__codelineno-77-5 name=__codelineno-77-5 href=#__codelineno-77-5></a><span class=p>)</span>
</span></code></pre></div> <p>Update statistics of an open position record using a custom price.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>record</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Position record to populate.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.trade_dt title=vectorbtpro.portfolio.enums.trade_dt>trade_dt</a> dtype.</p> </dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Current position size.</dd> <dt><strong><code>price</code></strong> :&ensp;<code>float</code></dt> <dd>Price used for updating the statistics.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>This function modifies <code>record</code> in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.update_pos_info_nb>update_pos_info_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L2482-L2597 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.update_pos_info_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-78-1><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a><span class=n>update_pos_info_nb</span><span class=p>(</span>
</span><span id=__span-78-2><a id=__codelineno-78-2 name=__codelineno-78-2 href=#__codelineno-78-2></a>    <span class=n>record</span><span class=p>,</span>
</span><span id=__span-78-3><a id=__codelineno-78-3 name=__codelineno-78-3 href=#__codelineno-78-3></a>    <span class=n>i</span><span class=p>,</span>
</span><span id=__span-78-4><a id=__codelineno-78-4 name=__codelineno-78-4 href=#__codelineno-78-4></a>    <span class=n>col</span><span class=p>,</span>
</span><span id=__span-78-5><a id=__codelineno-78-5 name=__codelineno-78-5 href=#__codelineno-78-5></a>    <span class=n>position_before</span><span class=p>,</span>
</span><span id=__span-78-6><a id=__codelineno-78-6 name=__codelineno-78-6 href=#__codelineno-78-6></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-78-7><a id=__codelineno-78-7 name=__codelineno-78-7 href=#__codelineno-78-7></a>    <span class=n>order_result</span><span class=p>,</span>
</span><span id=__span-78-8><a id=__codelineno-78-8 name=__codelineno-78-8 href=#__codelineno-78-8></a>    <span class=n>order_id</span>
</span><span id=__span-78-9><a id=__codelineno-78-9 name=__codelineno-78-9 href=#__codelineno-78-9></a><span class=p>)</span>
</span></code></pre></div> <p>Update the position record after an order is filled.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>record</code></strong> :&ensp;<code>Record</code></dt> <dd> <p>Position record to populate.</p> <p>Must adhere to the <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.trade_dt title=vectorbtpro.portfolio.enums.trade_dt>trade_dt</a> dtype.</p> </dd> <dt><strong><code>i</code></strong> :&ensp;<code>int</code></dt> <dd>Current row index.</dd> <dt><strong><code>col</code></strong> :&ensp;<code>int</code></dt> <dd>Current column index.</dd> <dt><strong><code>position_before</code></strong> :&ensp;<code>float</code></dt> <dd>Position size before the order execution.</dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Position size after the order execution.</dd> <dt><strong><code>order_result</code></strong> :&ensp;<code>OrderResult</code></dt> <dd> <p>Result of the order execution.</p> <p>See <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/enums/#vectorbtpro.portfolio.enums.OrderResult title=vectorbtpro.portfolio.enums.OrderResult>OrderResult</a>.</p> </dd> <dt><strong><code>order_id</code></strong> :&ensp;<code>int</code></dt> <dd>Identifier of the executed order.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>None</code></dt> <dd>This function modifies <code>record</code> in place.</dd> </dl> <hr> <h2 id=vectorbtpro.portfolio.nb.core.update_value_nb>update_value_nb <span class=dobjtype>function</span><a class=githublink href=https://github.com/polakowo/vectorbt.pro/blob/d0bfef94b75be3087e04d1b58c9c7216f2f25ce8/vectorbtpro/portfolio/nb/core.py#L1247-L1282 target=_blank title="Jump to source"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span></a><a class=headerlink href=#vectorbtpro.portfolio.nb.core.update_value_nb title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-79-1><a id=__codelineno-79-1 name=__codelineno-79-1 href=#__codelineno-79-1></a><span class=n>update_value_nb</span><span class=p>(</span>
</span><span id=__span-79-2><a id=__codelineno-79-2 name=__codelineno-79-2 href=#__codelineno-79-2></a>    <span class=n>cash_before</span><span class=p>,</span>
</span><span id=__span-79-3><a id=__codelineno-79-3 name=__codelineno-79-3 href=#__codelineno-79-3></a>    <span class=n>cash_now</span><span class=p>,</span>
</span><span id=__span-79-4><a id=__codelineno-79-4 name=__codelineno-79-4 href=#__codelineno-79-4></a>    <span class=n>position_before</span><span class=p>,</span>
</span><span id=__span-79-5><a id=__codelineno-79-5 name=__codelineno-79-5 href=#__codelineno-79-5></a>    <span class=n>position_now</span><span class=p>,</span>
</span><span id=__span-79-6><a id=__codelineno-79-6 name=__codelineno-79-6 href=#__codelineno-79-6></a>    <span class=n>val_price_before</span><span class=p>,</span>
</span><span id=__span-79-7><a id=__codelineno-79-7 name=__codelineno-79-7 href=#__codelineno-79-7></a>    <span class=n>val_price_now</span><span class=p>,</span>
</span><span id=__span-79-8><a id=__codelineno-79-8 name=__codelineno-79-8 href=#__codelineno-79-8></a>    <span class=n>value_before</span>
</span><span id=__span-79-9><a id=__codelineno-79-9 name=__codelineno-79-9 href=#__codelineno-79-9></a><span class=p>)</span>
</span></code></pre></div> <p>Calculate updated portfolio value based on changes in cash and asset positions.</p> <p><strong>Args</strong></p> <dl> <dt><strong><code>cash_before</code></strong> :&ensp;<code>float</code></dt> <dd>Cash amount before the update.</dd> <dt><strong><code>cash_now</code></strong> :&ensp;<code>float</code></dt> <dd>Cash amount after the update.</dd> <dt><strong><code>position_before</code></strong> :&ensp;<code>float</code></dt> <dd>Asset position before the update.</dd> <dt><strong><code>position_now</code></strong> :&ensp;<code>float</code></dt> <dd>Asset position after the update.</dd> <dt><strong><code>val_price_before</code></strong> :&ensp;<code>float</code></dt> <dd>Asset valuation price before the update.</dd> <dt><strong><code>val_price_now</code></strong> :&ensp;<code>float</code></dt> <dd>Asset valuation price after the update.</dd> <dt><strong><code>value_before</code></strong> :&ensp;<code>float</code></dt> <dd>Portfolio value before the update.</dd> </dl> <p><strong>Returns</strong></p> <dl> <dt><code>float</code></dt> <dd>Updated portfolio value.</dd> </dl> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/analysis/ class="md-footer__link md-footer__link--prev" aria-label="Previous: analysis"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> analysis </div> </div> </a> <a href=https://vectorbt.pro/pvt_41531c19/api/portfolio/nb/ctx_helpers/ class="md-footer__link md-footer__link--next" aria-label="Next: ctx_helpers"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> ctx_helpers </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021-2025 Oleg Polakow. All rights reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/polakowo target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/polakowo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.prune", "navigation.path", "navigation.footer", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "content.tabs.link", "toc.follow", "toc.integrate", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=https://vectorbt.pro/pvt_41531c19/assets/javascripts/bundle.9d1edc04.min.js></script> <script src=https://vectorbt.pro/pvt_41531c19/assets/scripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js></script> </body> 
<!-- Mirrored from vectorbt.pro/pvt_41531c19/api/portfolio/nb/core/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 22 Nov 2025 03:48:13 GMT -->
</html>